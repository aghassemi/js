{"version":3,"file":"bundle.js","sources":["/usr/local/google/home/aghassemi/git/veyron/veyron.js/node_modules/browserify/node_modules/browser-pack/_prelude.js","/usr/local/google/home/aghassemi/git/veyron/veyron.js/src/veyron.js","/usr/local/google/home/aghassemi/git/veyron/veyron.js/node_modules/browserify/node_modules/process/browser.js","/usr/local/google/home/aghassemi/git/veyron/veyron.js/src/lib/vlog.js","/usr/local/google/home/aghassemi/git/veyron/veyron.js/src/lib/deferred.js","/usr/local/google/home/aghassemi/git/veyron/veyron.js/src/runtime/runtime.js","/usr/local/google/home/aghassemi/git/veyron/veyron.js/src/lib/verror.js","/usr/local/google/home/aghassemi/git/veyron/veyron.js/src/namespace/util.js","/usr/local/google/home/aghassemi/git/veyron/veyron.js/src/ipc/leaf_dispatcher.js","/usr/local/google/home/aghassemi/git/veyron/veyron.js/src/security/caveat.js","/usr/local/google/home/aghassemi/git/veyron/veyron.js/src/security/acl_authorizer.js","/usr/local/google/home/aghassemi/git/veyron/veyron.js/src/lib/promise.js","/usr/local/google/home/aghassemi/git/veyron/veyron.js/src/ipc/server.js","/usr/local/google/home/aghassemi/git/veyron/veyron.js/src/ipc/server_router.js","/usr/local/google/home/aghassemi/git/veyron/veyron.js/src/proxy/websocket.js","/usr/local/google/home/aghassemi/git/veyron/veyron.js/src/proxy/message_type.js","/usr/local/google/home/aghassemi/git/veyron/veyron.js/src/ipc/client.js","/usr/local/google/home/aghassemi/git/veyron/veyron.js/src/namespace/namespace.js","/usr/local/google/home/aghassemi/git/veyron/veyron.js/src/security/private.js","/usr/local/google/home/aghassemi/git/veyron/veyron.js/src/security/public.js","/usr/local/google/home/aghassemi/git/veyron/veyron.js/src/proxy/simple_handler.js","/usr/local/google/home/aghassemi/git/veyron/veyron.js/src/idl/idl.js","/usr/local/google/home/aghassemi/git/veyron/veyron.js/src/security/blessing_matching.js","/usr/local/google/home/aghassemi/git/veyron/veyron.js/node_modules/browserify/node_modules/util/util.js","/usr/local/google/home/aghassemi/git/veyron/veyron.js/node_modules/postie/index.js","/usr/local/google/home/aghassemi/git/veyron/veyron.js/node_modules/is-browser/client.js","/usr/local/google/home/aghassemi/git/veyron/veyron.js/node_modules/xtend/immutable.js","/usr/local/google/home/aghassemi/git/veyron/veyron.js/src/proxy/stream.js","/usr/local/google/home/aghassemi/git/veyron/veyron.js/src/proxy/incoming_payload_type.js","/usr/local/google/home/aghassemi/git/veyron/veyron.js/src/proxy/error_conversion.js","/usr/local/google/home/aghassemi/git/veyron/veyron.js/src/proxy/stream_handler.js","/usr/local/google/home/aghassemi/git/veyron/veyron.js/src/security/context.js","/usr/local/google/home/aghassemi/git/veyron/veyron.js/src/ipc/server_context.js","/usr/local/google/home/aghassemi/git/veyron/veyron.js/src/proxy/proxy.js","/usr/local/google/home/aghassemi/git/veyron/veyron.js/src/ipc/constants.js","/usr/local/google/home/aghassemi/git/veyron/veyron.js/src/runtime/context.js","/usr/local/google/home/aghassemi/git/veyron/veyron.js/node_modules/browserify/node_modules/util/support/isBufferBrowser.js","/usr/local/google/home/aghassemi/git/veyron/veyron.js/node_modules/browserify/node_modules/events/events.js","/usr/local/google/home/aghassemi/git/veyron/veyron.js/node_modules/bluebird/js/main/bluebird.js","/usr/local/google/home/aghassemi/git/veyron/veyron.js/node_modules/browserify/node_modules/stream-browserify/index.js","/usr/local/google/home/aghassemi/git/veyron/veyron.js/node_modules/browserify/node_modules/inherits/inherits_browser.js","/usr/local/google/home/aghassemi/git/veyron/veyron.js/node_modules/bluebird/js/main/promise.js","/usr/local/google/home/aghassemi/git/veyron/veyron.js/node_modules/ws/lib/browser.js","/usr/local/google/home/aghassemi/git/veyron/veyron.js/node_modules/bluebird/js/main/util.js","/usr/local/google/home/aghassemi/git/veyron/veyron.js/node_modules/bluebird/js/main/async.js","/usr/local/google/home/aghassemi/git/veyron/veyron.js/node_modules/bluebird/js/main/errors.js","/usr/local/google/home/aghassemi/git/veyron/veyron.js/node_modules/bluebird/js/main/thenables.js","/usr/local/google/home/aghassemi/git/veyron/veyron.js/node_modules/bluebird/js/main/promise_array.js","/usr/local/google/home/aghassemi/git/veyron/veyron.js/node_modules/bluebird/js/main/captured_trace.js","/usr/local/google/home/aghassemi/git/veyron/veyron.js/node_modules/bluebird/js/main/catch_filter.js","/usr/local/google/home/aghassemi/git/veyron/veyron.js/node_modules/bluebird/js/main/promise_resolver.js","/usr/local/google/home/aghassemi/git/veyron/veyron.js/node_modules/bluebird/js/main/finally.js","/usr/local/google/home/aghassemi/git/veyron/veyron.js/node_modules/bluebird/js/main/direct_resolve.js","/usr/local/google/home/aghassemi/git/veyron/veyron.js/node_modules/bluebird/js/main/synchronous_inspection.js","/usr/local/google/home/aghassemi/git/veyron/veyron.js/node_modules/bluebird/js/main/join.js","/usr/local/google/home/aghassemi/git/veyron/veyron.js/node_modules/bluebird/js/main/timers.js","/usr/local/google/home/aghassemi/git/veyron/veyron.js/node_modules/bluebird/js/main/race.js","/usr/local/google/home/aghassemi/git/veyron/veyron.js/node_modules/bluebird/js/main/call_get.js","/usr/local/google/home/aghassemi/git/veyron/veyron.js/node_modules/bluebird/js/main/generators.js","/usr/local/google/home/aghassemi/git/veyron/veyron.js/node_modules/bluebird/js/main/map.js","/usr/local/google/home/aghassemi/git/veyron/veyron.js/node_modules/bluebird/js/main/nodeify.js","/usr/local/google/home/aghassemi/git/veyron/veyron.js/node_modules/bluebird/js/main/promisify.js","/usr/local/google/home/aghassemi/git/veyron/veyron.js/node_modules/bluebird/js/main/props.js","/usr/local/google/home/aghassemi/git/veyron/veyron.js/node_modules/bluebird/js/main/reduce.js","/usr/local/google/home/aghassemi/git/veyron/veyron.js/node_modules/bluebird/js/main/settle.js","/usr/local/google/home/aghassemi/git/veyron/veyron.js/node_modules/bluebird/js/main/some.js","/usr/local/google/home/aghassemi/git/veyron/veyron.js/node_modules/bluebird/js/main/progress.js","/usr/local/google/home/aghassemi/git/veyron/veyron.js/node_modules/bluebird/js/main/cancel.js","/usr/local/google/home/aghassemi/git/veyron/veyron.js/node_modules/bluebird/js/main/filter.js","/usr/local/google/home/aghassemi/git/veyron/veyron.js/node_modules/bluebird/js/main/any.js","/usr/local/google/home/aghassemi/git/veyron/veyron.js/node_modules/bluebird/js/main/each.js","/usr/local/google/home/aghassemi/git/veyron/veyron.js/node_modules/bluebird/js/main/using.js","/usr/local/google/home/aghassemi/git/veyron/veyron.js/node_modules/browserify/node_modules/readable-stream/readable.js","/usr/local/google/home/aghassemi/git/veyron/veyron.js/node_modules/browserify/node_modules/readable-stream/duplex.js","/usr/local/google/home/aghassemi/git/veyron/veyron.js/node_modules/browserify/node_modules/readable-stream/writable.js","/usr/local/google/home/aghassemi/git/veyron/veyron.js/node_modules/browserify/node_modules/readable-stream/transform.js","/usr/local/google/home/aghassemi/git/veyron/veyron.js/node_modules/browserify/node_modules/readable-stream/passthrough.js","/usr/local/google/home/aghassemi/git/veyron/veyron.js/node_modules/bluebird/js/main/errors_api_rejection.js","/usr/local/google/home/aghassemi/git/veyron/veyron.js/node_modules/browserify/node_modules/readable-stream/lib/_stream_readable.js","/usr/local/google/home/aghassemi/git/veyron/veyron.js/node_modules/browserify/node_modules/readable-stream/lib/_stream_writable.js","/usr/local/google/home/aghassemi/git/veyron/veyron.js/node_modules/browserify/node_modules/readable-stream/lib/_stream_duplex.js","/usr/local/google/home/aghassemi/git/veyron/veyron.js/node_modules/browserify/node_modules/readable-stream/lib/_stream_transform.js","/usr/local/google/home/aghassemi/git/veyron/veyron.js/node_modules/browserify/node_modules/readable-stream/lib/_stream_passthrough.js","/usr/local/google/home/aghassemi/git/veyron/veyron.js/node_modules/bluebird/js/main/schedule.js","/usr/local/google/home/aghassemi/git/veyron/veyron.js/node_modules/bluebird/js/main/es5.js","/usr/local/google/home/aghassemi/git/veyron/veyron.js/node_modules/bluebird/js/main/queue.js","/usr/local/google/home/aghassemi/git/veyron/veyron.js/node_modules/browserify/node_modules/buffer/index.js","/usr/local/google/home/aghassemi/git/veyron/veyron.js/node_modules/browserify/node_modules/readable-stream/node_modules/string_decoder/index.js","/usr/local/google/home/aghassemi/git/veyron/veyron.js/node_modules/browserify/node_modules/readable-stream/node_modules/isarray/index.js","/usr/local/google/home/aghassemi/git/veyron/veyron.js/node_modules/browserify/node_modules/buffer/node_modules/is-array/index.js","/usr/local/google/home/aghassemi/git/veyron/veyron.js/node_modules/browserify/node_modules/readable-stream/node_modules/core-util-is/lib/util.js","/usr/local/google/home/aghassemi/git/veyron/veyron.js/node_modules/browserify/node_modules/buffer/node_modules/ieee754/index.js","/usr/local/google/home/aghassemi/git/veyron/veyron.js/node_modules/browserify/node_modules/buffer/node_modules/base64-js/lib/b64.js"],"names":["init","config","cb","extend","defaults","def","Deferred","runtimeOpts","wspr","process","env","appName","authenticate","getIdentity","authTimeout","err","name","reject","promise","identityName","resolve","Runtime","authTimeoutMs","handleAuthSuccess","data","removeListeners","handleAuthError","objectToError","error","handleAuthReceived","window","clearInterval","authRequestInterval","handleTimeout","Error","clearTimeout","timeout","contentScript","removeListener","isBrowser","Postie","require","on","setInterval","post","setTimeout","obj","message","stack","vlog","logLevel","level","module","exports","errors","logLevels","levels","namespaceUtil","Promise","createLeafDispatcher","caveats","aclAuthorizer","noop","nextTick","canSetImmediate","setImmediate","canPost","postMessage","addEventListener","f","queue","ev","source","stopPropagation","length","fn","shift","push","title","browser","argv","addListener","once","off","removeAllListeners","emit","binding","cwd","chdir","NOLOG","ERROR","WARN","DEBUG","INFO","console","Vlog","options","this","prototype","_log","arguments","warn","debug","info","args","_write","method","log","apply","deferred","addCallback","done","value","_wspr","identity","PrivateId","_getProxyConnection","_name","Server","ServerRouter","Client","ProxyConnection","MessageType","Namespace","PublicId","SimpleHandler","bindTo","optServiceSignature","runtime","client","_getClient","undefined","bind","close","serve","serviceObject","serviceMetadata","server","_getServer","addIDL","updates","_proxyConnection","_getRouter","_router","_client","_server","newNamespace","roots","proxy","newIdentity","newIdentityDef","messageDef","id","nextId","handler","sendRequest","JSON","stringify","NEW_ID","then","names","handle","publicKey","inherits","vError","Actions","NoRetry","RetryConnection","RetryRefetch","RetryBackoff","IdActions","Aborted","action","BadArg","BadProtocol","Exists","Internal","NoAccess","NoExist","NoExistOrNoAccess","Unknown","VeyronError","idAction","call","captureStackTrace","AbortedError","BadArgError","BadProtocolError","ExistsError","InternalError","NoAccessError","NoExistError","NoExistOrNoAccessError","UnknownError","_numInitialSlashes","s","i","charAt","_numTailSlashes","_removeInitialSlashes","replace","_removeTailSlashes","_joinNamePartsOnArray","parts","addedPart","numNameSlashes","numAddedPartSlashes","join","Array","isArray","slice","isRooted","isTerminal","numInitialSlashes","nextSlashIndex","substr","indexOf","nextDoubleSlashIndex","convertToTerminalName","substring","stripBasename","lastIndexOf","basename","metadata","authorizer","wrapper","ServiceWrapper","_validate","validate","service","IdlHelper","MethodCaveat","methods","_methods","toJSON","_type","acl","ctx","localId","remoteId","remoteNames","matchesACL","label","errACL","pattern","patLabels","isAllowed","in","hasOwnProperty","blessingMatches","notIn","router","_handle","nextServerID","dispatcher","serviceObjectHandles","vLog","lookup","stop","stopServer","getServiceForHandle","result","handleAuthorization","request","e","_handleLookupResult","object","_handleLookup","suffix","v","self","handleResult","Stream","IncomingPayloadType","ErrorConversion","StreamHandler","SecurityContext","ServerContext","Router","_servers","_proxy","_streamMap","_contextMap","_appName","addIncomingHandler","INVOKE_REQUEST","LOOKUP_REQUEST","AUTHORIZATION_REQUEST","CANCEL","inject","injectionPositions","injections","keys","Object","invertedMap","forEach","key","values","map","k","filter","sort","keysInserted","pos","splice","invokeMethod","receiver","handleRequest","messageId","type","handleRPCRequest","handleLookupRequest","handleAuthorizationRequest","handleCancel","serverID","AUTHORIZATION_RESPONSE","securityContext","context","catch","toStandardErrorStruct","LOOKUP_RESPONSE","hasAuthorizer","labelForMethod","signature","generateIdlWireDescription","cancel","serverId","sendResult","serviceWrapper","serviceMethod","sendInvocationError","stackTrace","numOutArgs","finished","release","$stream","senderPromise","$cb","$context","$suffix","$name","$remoteId","variables","stream","rpc","addIncomingStreamHandler","resultPromise","results","errorStruct","waitUntilDone","serverClose","dequeue","responseData","responseDataJSON","RESPONSE","messageJSON","SERVE","toString","STOP","url","currentWebSocketPromise","Proxy","getWebSocket","WebSocket","create","constructor","websocket","onopen","onerror","isEvent","Event","isErrorEvent","onmessage","frame","parse","onclose","REQUEST","STREAM_VALUE","STREAM_CLOSE","SIGNATURE","BLESS","UNLINK_ID","NAMESPACE_REQUEST","proxyConnection","constants","OutstandingRPC","_ctx","_id","_methodName","methodName","_args","_numOutParams","numOutParams","_isStreaming","isStreaming","_cb","_def","start","streamingDeferred","constructMessage","cancelFromContext","ws","handleResponse","FINAL_RESPONSE","handleCompletion","STREAM_RESPONSE","handleStreamData","ERROR_RESPONSE","handleError","handleStreamClose","_queueRead","toJSerror","queueRead","deadline","NO_TIMEOUT","Date","now","jsonMessage","inArgs","optionalContext","serviceSignaturePromise","getServiceSignature","serviceSignature","boundObject","bindMethod","methodInfo","callback","first","last","Context","expected","actual","_roots","NamespaceMethods","GLOB","MOUNT","UNMOUNT","RESOLVE","glob","_sendStreamingRequest","mount","ttl","replaceMount","_sendRequest","unmount","setRoots","_createMessage","messageObject","bless","blessee","duration","durationMs","_count","_key","match","retain","Handler","idlHelper","idlWire","methodMetadata","params","param","InArgs","NumOutArgs","IsStreaming","getParamNames","func","fnStr","extraMetadata","camelCaseName","toLowerCase","extra","definition","inputArgs","numInArgs","hasStreaming","expectingStreaming","inputStreaming","outputStreaming","blessing","paths","split","expectedPaths","inspect","opts","seen","stylize","stylizeNoColor","depth","colors","isBoolean","showHidden","_extend","isUndefined","customInspect","stylizeWithColor","formatValue","str","styleType","style","styles","arrayToHash","array","hash","val","recurseTimes","isFunction","ret","isString","primitive","formatPrimitive","visibleKeys","getOwnPropertyNames","isError","formatError","isRegExp","RegExp","isDate","base","braces","n","toUTCString","output","formatArray","formatProperty","pop","reduceToSingleString","simple","isNumber","isNull","l","String","desc","getOwnPropertyDescriptor","get","set","line","numLinesEst","reduce","prev","cur","ar","arg","isNullOrUndefined","isSymbol","re","isObject","objectToString","d","isPrimitive","o","pad","timestamp","time","getHours","getMinutes","getSeconds","getDate","months","getMonth","prop","formatRegExp","format","objects","len","x","Number","_","deprecate","msg","deprecated","warned","throwDeprecation","traceDeprecation","trace","global","noDeprecation","debugs","debugEnviron","debuglog","NODE_DEBUG","toUpperCase","test","pid","bold","italic","underline","inverse","white","grey","black","blue","cyan","green","magenta","red","yellow","special","number","boolean","null","string","date","regexp","isBuffer","origin","add","EventEmitter","__bind","me","__hasProp","__extends","child","parent","ctor","__super__","__slice","_super","target","handleMessage","listen","channel","packed","pkg","pack","attachEvent","event","unpackaged","unpack","concat","_postie","package","_error","Duplex","flowId","webSocketPromise","isClient","objectMode","wsBuffer","shouldQueue","clientClose","write","_read","chunk","encoding","send","end","operation","paramList","_standard","verr","iDAction","iD","Ctor","_stream","localID","remoteID","localEndpoint","remoteEndpoint","withTimeout","withCancel","sender","outstandingRequests","bindCache","incomingRequestHandlers","BIND_CACHE_TTL","payload","isServerOriginatedMessage","cache","fetched","h","body","lastidx","DeadlineExceededError","CancelledError","ContextKey","_nextKey","_runtime","ChildContext","_parent","ValueContext","_value","cancellableAncestor","CancelContext","_nextID","_done","_deferred","_children","ca","DeadlineContext","_deadline","_timerID","_expire","withValue","withDeadline","_cancel","copy","fill","readUInt8","_events","_maxListeners","defaultMaxListeners","setMaxListeners","isNaN","TypeError","er","listeners","listener","m","newListener","g","fired","list","position","listenerCount","emitter","EE","Readable","Writable","Transform","PassThrough","pipe","dest","ondata","writable","pause","ondrain","readable","resume","onend","didOnEnd","destroy","cleanup","_isStdio","superCtor","super_","enumerable","configurable","TempCtor","noConflict","bluebird","old","resolver","_bitField","_fulfillmentHandler0","_rejectionHandler0","_promise0","_receiver0","_settledValue","_boundTo","INTERNAL","_resolveFromResolver","returnFirstElement","elements","reflect","PromiseInspection","util","async","APPLY","NEXT_FILTER","cast","PromiseArray","CapturedTrace","CatchFilter","PromiseResolver","errorObj","tryCatch1","tryCatch2","tryCatchApply","RangeError","CancellationError","TimeoutError","OperationalError","originatesFromRejection","markAsOriginatingFromRejection","canAttach","thrower","apiRejection","makeSelfResolutionError","thisArg","maybePromise","binder","_setBoundTo","p","all","_follow","_propagateFrom","caught","catchInstances","j","item","catchFilterTypeError","_attachExtraTrace","_resetTrace","catchFilter","_then","doFilter","didFulfill","didReject","didProgress","_setIsFinal","spread","isCancellable","isResolved","_cancellable","isFulfilled","isRejected","fulfillmentValue","rejectionReason","is","promises","_resolveFromSyncValue","_cleanValues","_setRejected","_ensurePossibleRejectionHandled","_setFulfilled","$_len","$_i","_setTrace","attempt","defer","pending","fulfilled","rejected","reason","_setCarriedStackTrace","onPossiblyUnhandledRejection","possiblyUnhandledRejection","unhandledRejectionHandled","onUnhandledRejectionHandled","debugging","execPath","longStackTraces","haveItemsQueued","isSupported","hasLongStackTraces","internalData","haveInternalData","haveSameContext","_peekContext","_traceParent","callbackIndex","_addCallbacks","invoke","_queueSettleAt","_length","_isFollowingOrFulfilledOrRejected","_isFollowing","_setLength","_setFollowing","_isFinal","_setCancellable","_unsetCancellable","_setRejectionIsUnhandled","_unsetRejectionIsUnhandled","_isUnhandledRejectionNotified","_unsetUnhandledRejectionIsNotified","_notifyUnhandledRejectionIsHandled","_isRejectionUnhandled","_setUnhandledRejectionIsNotified","capturedTrace","_unsetCarriedStackTrace","_isCarryingStackTrace","_getCarriedStackTrace","_receiverAt","index","_isBound","_promiseAt","_fulfillmentHandlerAt","_rejectionHandlerAt","fulfill","progress","_progressHandler0","_setProxyHandlers","promiseSlotValue","_proxyPromiseArray","promiseArray","_proxyPromise","_setProxied","Promise$_resolver","_tryFollow","_fulfill","Promise$_rejecter","_reject","_pushContext","r","_popContext","_spreadSlowCase","targetFn","boundTo","promiseForAll","promise2","_callSpread","_callHandler","_settlePromiseFromHandler","_rejectUnchecked","castValue","_fulfillUnchecked","isPending","_trace","isTopLevel","protectErrorMessageNewlines","headerLineCount","combinedTraces","combine","stackTraceLimit","max","_cancellationParent","flags","carriedStackTrace","_settlePromiseAt","_isProxied","_unsetProxied","_promiseFulfilled","_promiseRejected","_queueGC","_isGcQueued","_setGcQueued","_unsetGcQueued","invokeLater","_gc","_clearFirstHandlerData","_settlePromises","_rejectUncheckedCheckError","_rejectPromises","_notifyUnhandledRejection","contextStack","lastIndex","setScheduler","_schedule","_makeSelfResolutionError","RejectionError","AggregateError","toFastProperties","uri","protocols","instance","MozWebSocket","arg2","tryCatch3","arg3","tryCatch4","arg4","asString","maybeWrapAsError","maybeError","withAppended","appendee","getDataPropertyOrDefault","defaultValue","es5","isES5","notEnumerableProp","descriptor","defineProperty","isClass","isIdentifier","rident","filledRange","count","prefix","haveGetters","canEvaluate","navigator","Child","Parent","T","constructor$","propertyName","hasProp","wrapsPrimitiveReceiver","inheritedDataKeys","visitedKeys","getKeys","includeHidden","getPrototypeOf","Async","_isTickUsed","schedule","_lateBuffer","Queue","_functionBuffer","consumeFunctionBuffer","_consumeFunctionBuffer","_process","domain","_queueTick","functionBuffer","_reset","_consumeLateBuffer","buffer","res","ignore","subError","nameProperty","defaultMessage","SubError","cause","Objectfreeze","freeze","_TypeError","_RangeError","indent","lines","errorTypes","getThen","Promise$_Cast","originalPromise","isAnyBluebirdPromise","_progressUnchecked","Promise$_doThenable","Promise$_resolveFromThenable","y","called","Promise$_rejectFromThenable","Promise$_progressFromThenable","_progress","toResolutionValue","_promise","_values","_totalResolved","_init","PromiseArray$_init","resolveValueIfEmpty","__hardReject__","_resolveEmptyArray","_resolve","getActualLength","newLen","newValues","shouldCopyValues","isDirectScanNeeded","_scanDirectValues","_isResolved","_promiseProgressed","progressValue","totalResolved","formatNonError","ruselessToString","newStr","snip","maxChars","ignoreUntil","rignore","rtraceline","formatStack","current","curLast","errorMessageLines","unshift","stackDetection","startsWith","rline","instances","_instances","_callback","CatchFilter$_safePredicate","predicate","safeObject","retfilter","safeKeys","itemIsErrorType","shouldHandle","isUntypedError","wrapAsOperationalError","nodebackForPromise","PromiseResolver$_callback","wrapped","asCallback","_nodebackForPromise","returnThis","throwThis","return$","throw$","promisedFinally","reasonOrValue","finallyHandler","tapHandler","_passThroughHandler","isFinally","promiseAndHandler","lastly","tap","returner","thenReturn","thenThrow","thenCallback","Function","caller","thenCallbacks","callers","Holder","total","p1","p2","p3","p4","p5","checkFulfillment","holder","callbacks","_setTimeout","ms","arg0","arg1","afterTimeout","afterDelay","delay","cancellable","Promise$_Race","raceLater","hasOwn","race","cr","callerCache","getterCache","makeMethodCaller","makeGetter","getCompiled","compiler","getMethodCaller","getGetter","namedGetter","indexedGetter","maybeCaller","getter","isIndex","maybeGetter","promiseFromYieldHandler","yieldHandlers","_errorObj","_Promise","PromiseSpawn","generatorFunction","yieldHandler","_generatorFunction","_receiver","_generator","_yieldHandlers","_run","_next","_continue","_throw","next","coroutine","PromiseSpawn$","generator","spawn","addYieldHandler","MappingPromiseArray","limit","_filter","_preservedValues","_limit","_inFlight","_queue","EMPTY_ARRAY","_init$","concurrency","isFinite","PENDING","preservedValues","_drainQueue","booleans","Promise$_spreadAdapter","Promise$_successAdapter","nodeback","Promise$_errorAdapter","nodeify","adapter","escapeIdentRegex","isPromisified","__isPromisified__","hasPromisified","defaultPromisified","checkValid","suffixRegexp","keyWithoutAsyncSuffix","promisifiableMethods","switchCaseArgumentOrder","likelyArgumentCount","min","Math","argumentSequence","argumentCount","parameterDeclaration","parameterCount","generatePropertyAccess","makeNodePromisifiedEval","originalName","generateCallForArgumentCount","comma","THIS","generateArgumentSwitchCase","argumentOrder","codeForCall","newParameterCount","callbackName","makeNodePromisifiedClosure","promisified","promisifyAll","promisifier","promisifiedKey","makeNodePromisified","promisify","defaultSuffix","defaultFilter","PropertiesPromiseArray","Promise$_Props","props","keyOffset","ReductionPromiseArray","accum","_each","_zerothIsAccum","_gotAccum","_reducingIndex","_valuesPhase","isPromise","_accum","initialValue","valuesPhaseIndex","isEach","gotAccum","valuesPhase","SettledPromiseArray","_promiseResolved","inspection","settle","SomePromiseArray","_howMany","_unwrap","_initialized","Promise$_Some","howMany","setHowMany","isArrayResolved","_canPossiblyFulfill","_getRangeError","setUnwrap","_addFulfilled","_fulfilled","_addRejected","_rejected","some","_SomePromiseArray","progressed","_clearFirstHandlerData$Base","_progressHandlerAt","_doProgressWith","progression","promiseToReject","uncancellable","fork","PromiseMap","Promise$_Any","any","PromiseReduce","each","inspectionMapper","inspections","castPreservingDisposable","thenable","_isDisposable","_getDisposer","_setDisposable","dispose","resources","iterator","tryDispose","disposerSuccess","disposerFail","Disposer","_data","FunctionDisposer","resource","doDispose","_unsetDisposable","isDisposer","using","disposer","_disposer","ReadableState","hwm","highWaterMark","pipes","pipesCount","flowing","ended","endEmitted","reading","calledRead","sync","needReadable","emittedReadable","readableListening","defaultEncoding","ranOut","awaitDrain","readingMore","decoder","StringDecoder","_readableState","readableAddChunk","state","addToFront","chunkInvalid","onEofChunk","emitReadable","maybeReadMore","needMoreData","roundUpToNextPowerOf2","MAX_HWM","howMuchToRead","Buffer","endReadable","emitReadable_","maybeReadMore_","read","pipeOnDrain","src","flow","written","emitDataEvents","pipeOnReadable","startPaused","paused","c","fromList","stringMode","buf","cpy","xs","setEncoding","enc","nOrig","doRead","pipeOpts","onunpipe","onfinish","_writableState","needDrain","unpipe","doEnd","stdout","stderr","endFn","dests","wrap","events","_fromList","WriteReq","WritableState","ending","noDecode","decodeStrings","writing","bufferProcessing","onwrite","writecb","writelen","errorEmitted","writeAfterEnd","validChunk","valid","decodeChunk","writeOrBuffer","doWrite","onwriteError","onwriteStateUpdate","needFinish","clearBuffer","afterWrite","onwriteDrain","finishMaybe","entry","need","endWritable","allowHalfOpen","objectKeys","TransformState","afterTransform","needTransform","transforming","writechunk","ts","_transformState","rs","_flush","_transform","writeencoding","_MutationObserver","version","MutationObserver","WebKitMutationObserver","div","document","createElement","queuedFn","observer","observe","attributes","classList","toggle","has","proto","ObjectKeys","ObjectDefineProperty","ObjectFreeze","ObjectGetPrototypeOf","ArrayIsArray","arrayCopy","srcIndex","dst","dstIndex","capacity","_capacity","_front","_makeCapacity","_willBeOverCapacity","size","_pushOne","_checkCapacity","wrapMask","front","_resizeTo","oldFront","oldCapacity","oldQueue","lengthBeforeWrapping","subject","noZero","base64clean","byteLength","floor","kMaxLength","TYPED_ARRAY_SUPPORT","_augment","Uint8Array","_isBuffer","_set","isArrayish","hexWrite","offset","remaining","strLen","byte","parseInt","utf8Write","charsWritten","blitBuffer","utf8ToBytes","asciiWrite","asciiToBytes","binaryWrite","base64Write","base64ToBytes","utf16leWrite","utf16leToBytes","base64Slice","base64","fromByteArray","utf8Slice","tmp","decodeUtf8Char","fromCharCode","asciiSlice","binarySlice","hexSlice","out","toHex","utf16leSlice","bytes","checkOffset","ext","checkInt","objectWriteUInt16","littleEndian","objectWriteUInt32","checkIEEE754","writeFloat","noAssert","ieee754","writeDouble","stringtrim","INVALID_BASE64_RE","trim","byteArray","b","charCodeAt","encodeURIComponent","hi","lo","toByteArray","decodeURIComponent","SlowBuffer","INSPECT_MAX_BYTES","poolSize","ArrayBuffer","arr","foo","subarray","compare","a","isEncoding","totalLength","loweredCase","Infinity","equals","writeUInt8","swap","_arr","sliceLen","newBuf","readUInt16LE","readUInt16BE","readUInt32LE","readUInt32BE","readInt8","readInt16LE","readInt16BE","readInt32LE","readInt32BE","readFloatLE","readFloatBE","readDoubleLE","readDoubleBE","writeUInt16LE","writeUInt16BE","writeUInt32LE","writeUInt32BE","writeInt8","writeInt16LE","writeInt16BE","writeInt32LE","writeInt32BE","writeFloatLE","writeFloatBE","writeDoubleLE","writeDoubleBE","target_start","toArrayBuffer","BP","_get","toLocaleString","assertEncoding","isBufferEncoding","passThroughWrite","utf16DetectIncompleteChar","charReceived","charLength","base64DetectIncompleteChar","surrogateSize","detectIncompleteChar","charBuffer","charStr","available","charCode","isLE","mLen","nBytes","eLen","eMax","eBias","nBits","NaN","pow","rt","abs","LN2","decode","elt","code","PLUS","SLASH","NUMBER","UPPER","LOWER","b64ToByteArray","b64","L","placeHolders","Arr","uint8ToBase64","uint8","encode","num","tripletToBase64","temp","extraBytes","base64js"],"mappings":"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","sourcesContent":["(function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require==\"function\"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);throw new Error(\"Cannot find module '\"+o+\"'\")}var f=n[o]={exports:{}};t[o][0].call(f.exports,function(e){var n=t[o][1][e];return s(n?n:e)},f,f.exports,e,t,n,r)}return n[o].exports}var i=typeof require==\"function\"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s})","/**\n *  @fileoverview Public Veyron API.\n */\n\nvar extend = require('xtend');\nvar isBrowser = require('is-browser');\n\nvar Deferred = require('./lib/deferred');\nvar Runtime = require('./runtime/runtime');\nvar vlog = require('./lib/vlog');\n\nvar defaults = {\n  logLevel: vlog.level,\n  authenticate: false,\n  authTimeout: 5000, // ms\n};\n\n/**\n * Exports\n */\nmodule.exports = {\n  errors: require('./lib/verror'),\n  init: init,\n  logLevels: require('./lib/vlog').levels,\n  namespaceUtil: require('./namespace/util'),\n  Promise: require('./lib/promise'),\n  createLeafDispatcher: require('./ipc/leaf_dispatcher'),\n  caveats: require('./security/caveat'),\n  aclAuthorizer: require('./security/acl_authorizer'),\n};\n\n/**\n * Creates a Veyron runtime.\n * @param {Object} config Configuration options\n */\nfunction init(config, cb) {\n  if (typeof config === 'function') {\n    cb = config;\n    config = {};\n  }\n\n  config = extend(defaults, config);\n\n  var def = new Deferred(cb);\n\n  var runtimeOpts = {\n    wspr: config.wspr || process.env['WSPR'] || 'http://localhost:8124',\n    appName: config.appName || 'webapp',\n  };\n\n  // If the user has set config.authenticate to true, get an authenticated\n  // (blessed-by-identity-server) identity for the user.  This requires the\n  // Veyron Chrome Extension to be installed and enabled, and WSPR to be\n  // configured to talk to Veyron identity server, e.g. the one currently hosted\n  // at /proxy.envyor.com:8101/identity/veyron-test/google.  The resulting\n  // runtime will have runtime.identityName set to the name of the authenticated\n  // identity.\n  //\n  // Otherwise, create a runtime with identityName 'unknown'.\n  if (config.authenticate) {\n    getIdentity(config.authTimeout, function(err, name) {\n      if (err) {\n        def.reject(err);\n        return def.promise;\n      }\n      runtimeOpts.identityName = name;\n      def.resolve(new Runtime(runtimeOpts));\n    });\n  } else {\n    runtimeOpts.identityName = 'unknown';\n    def.resolve(new Runtime(runtimeOpts));\n  }\n\n  return def.promise;\n}\n\n// getIdentity tells the Veyron Extension to start an OAuth flow, gets an access\n// token for the user, and exchanges that access token for a blessed identity in\n// WSPR, which is then associated with the origin of the web app.\n//\n// The flow starts by repeatedly sending an 'auth' message to the Veyron\n// Extension content script.  It must perform this repeatedly because the first\n// messages might get sent before the content script has had time to start.\n//\n// When the content script eventually receives the 'auth' message, it responds\n// with an 'auth:received' message to let us know we can stop requesting auth.\n//\n// If no 'auth:received' message is received within config.authTimeout\n// milliseconds, we timeout with an error.\n//\n// Once the extension has received the 'auth' message, it will perform the OAuth\n// <-> WSPR identity flow, and respond with either an 'auth:success' message or\n// an 'auth:error' message.\nfunction getIdentity(authTimeoutMs, cb) {\n  if (!isBrowser) {\n    return cb(new Error('authenticate=true requires browser environment'));\n  }\n\n  var Postie = require('postie');\n  var contentScript = new Postie(window);\n\n  // Initialized below.\n  var timeout, authRequestInterval;\n\n  // Runs when the auth request succeeds.\n  function handleAuthSuccess(data) {\n    removeListeners();\n    cb(null, data.name);\n  }\n\n  function handleAuthError(data) {\n    removeListeners();\n    cb(objectToError(data.error));\n  }\n\n  // Runs when the extension receives the auth request.\n  function handleAuthReceived() {\n    window.clearInterval(authRequestInterval);\n  }\n\n  // Runs when timeout occurs before getting 'auth:received' message.\n  function handleTimeout() {\n    handleAuthError({error: new Error(\n        'Auth timeout. Please ensure that the Veyron Chrome Extension is ' +\n        'installed and enabled. Download it here: ' +\n        'https://github.com/veyron/veyron.js/raw/master/extension/veyron.crx'\n    )});\n  }\n\n  function removeListeners() {\n    window.clearInterval(authRequestInterval);\n    window.clearTimeout(timeout);\n    contentScript.removeListener('auth:success', handleAuthSuccess);\n    contentScript.removeListener('auth:error', handleAuthError);\n  }\n\n  contentScript.on('auth:success', handleAuthSuccess);\n  contentScript.on('auth:error', handleAuthError);\n  contentScript.on('auth:received', handleAuthReceived);\n\n  // Repeatedly ask the extension to auth.  The first time this runs, the\n  // extension might not be running yet, so we need to ask in a setInterval.\n  authRequestInterval = window.setInterval(function() {\n    contentScript.post('auth');\n  }, 200);\n\n  // Timeout if we don't get an 'auth:received' message before authTimeoutMs\n  // milliseconds.\n  timeout = window.setTimeout(handleTimeout, authTimeoutMs);\n}\n\n// An error that gets sent via postMessage will be received as a plain Object.\n// This function turns it back into an Error object.\nfunction objectToError(obj) {\n  var err = new Error(obj.message);\n  err.name = obj.name;\n  err.stack = obj.stack;\n  return err;\n}\n","// shim for using process in browser\n\nvar process = module.exports = {};\n\nprocess.nextTick = (function () {\n    var canSetImmediate = typeof window !== 'undefined'\n    && window.setImmediate;\n    var canPost = typeof window !== 'undefined'\n    && window.postMessage && window.addEventListener\n    ;\n\n    if (canSetImmediate) {\n        return function (f) { return window.setImmediate(f) };\n    }\n\n    if (canPost) {\n        var queue = [];\n        window.addEventListener('message', function (ev) {\n            var source = ev.source;\n            if ((source === window || source === null) && ev.data === 'process-tick') {\n                ev.stopPropagation();\n                if (queue.length > 0) {\n                    var fn = queue.shift();\n                    fn();\n                }\n            }\n        }, true);\n\n        return function nextTick(fn) {\n            queue.push(fn);\n            window.postMessage('process-tick', '*');\n        };\n    }\n\n    return function nextTick(fn) {\n        setTimeout(fn, 0);\n    };\n})();\n\nprocess.title = 'browser';\nprocess.browser = true;\nprocess.env = {};\nprocess.argv = [];\n\nfunction noop() {}\n\nprocess.on = noop;\nprocess.addListener = noop;\nprocess.once = noop;\nprocess.off = noop;\nprocess.removeListener = noop;\nprocess.removeAllListeners = noop;\nprocess.emit = noop;\n\nprocess.binding = function (name) {\n    throw new Error('process.binding is not supported');\n}\n\n// TODO(shtylman)\nprocess.cwd = function () { return '/' };\nprocess.chdir = function (dir) {\n    throw new Error('process.chdir is not supported');\n};\n","/**\n * @fileoverview A lightweight logging framework for JavaScript to be used\n * in place of console so that we can persist the logs if needed and turn\n * logging off at different levels.\n */\n\nvar extend = require('xtend');\nvar levels = {\n  NOLOG: 0, // No logs are written\n  ERROR : 1, // Only errors are written\n  WARN: 2, // Only errors and warnings are written\n  DEBUG : 3, // Errors, warnings and debug messages are written\n  INFO : 4 // All logs are written,\n};\nvar defaults = {\n  level: levels.NOLOG,\n  console: console\n};\n\nvar Vlog = function(options) {\n  if (!(this instanceof Vlog)) { return new Vlog(options); }\n\n  var vlog = this;\n\n  options = extend(defaults, options);\n\n  vlog.level = options.level;\n  vlog.console = options.console;\n};\n\n/**\n * Logs arguments as errors to the console if log level is error or higher\n */\nVlog.prototype.error = function() {\n  this._log(levels.ERROR, arguments);\n};\n\n/**\n * Logs arguments as warnings to the console if log level is warning or higher\n */\nVlog.prototype.warn = function() {\n  this._log(levels.WARN, arguments);\n};\n\n/**\n * Logs arguments as logs to the console if log level is debug or higher\n */\nVlog.prototype.debug = function() {\n  this._log(levels.DEBUG, arguments);\n};\n\n/**\n * Logs arguments as info to the console if log level is info or higher\n */\nVlog.prototype.info = function() {\n  this._log(levels.INFO, arguments);\n};\n\nVlog.prototype._log = function(level, args) {\n  if (this.level >= level) {\n    this._write(level, args);\n  }\n};\n\nVlog.prototype._write = function(level, args) {\n  var vlog = this;\n  var method;\n\n  if (! vlog.console) {\n    return;\n  }\n\n  switch (level) {\n    case levels.ERROR:\n      method = vlog.console.error;\n      break;\n    case levels.WARN:\n      method = vlog.console.warn;\n      break;\n    case levels.DEBUG:\n      method = vlog.console.log;\n      break;\n    case levels.INFO:\n      method = vlog.console.info;\n      break;\n    default:\n      method = vlog.console.log;\n      break;\n  }\n\n  method.apply(vlog.console, args);\n};\n\nmodule.exports = new Vlog();\nmodule.exports.Vlog = Vlog;\nmodule.exports.levels = levels;\n","/**\n * @fileoverview A lightweight deferred implementation built on promises.\n *\n * A deferred encapsulates a promise and its resolve/reject methods in a single\n * object.  This makes deferreds easier to pass to around and resolve or reject\n * from other pieces of code.\n */\n\nvar Promise = require('./promise');\n\nmodule.exports = Deferred;\n\nfunction Deferred(cb) {\n  var deferred = this;\n\n  deferred.promise = new Promise(function(resolve, reject) {\n    deferred.resolve = resolve;\n    deferred.reject = reject;\n  });\n  addCallback(deferred.promise, cb);\n}\n\nfunction addCallback(promise, cb) {\n  if (cb) {\n    // Note, this must be a .done() and not a .then().  Errors thrown inside of\n    // a .then() callback are wrapped in a try/catch, whereas errors thrown\n    // inside of a .done() callback will be thrown as an error.\n    promise.done(\n      function success(value) { cb(null, value); },\n      function error(err) { cb(err); }\n    );\n  }\n}\n\n// This adds a callback to the deferred (for people using the callback api).\nDeferred.prototype.addCallback = function(cb) {\n  addCallback(this.promise, cb);\n};\n","/**\n * @fileoverview Veyron Runtime\n */\n\nvar Server = require('../ipc/server');\nvar ServerRouter = require('../ipc/server_router');\nvar Client = require('../ipc/client');\nvar ProxyConnection = require('../proxy/websocket');\nvar MessageType = require('../proxy/message_type');\nvar Namespace = require('../namespace/namespace');\nvar PrivateId = require('../security/private');\nvar PublicId = require('../security/public');\nvar Deferred = require('../lib/deferred');\nvar SimpleHandler = require('../proxy/simple_handler');\n\nmodule.exports = Runtime;\n\nfunction Runtime(options) {\n  if (!(this instanceof Runtime)) {\n    return new Runtime(options);\n  }\n\n  this.identityName = options.identityName;\n  this._wspr = options.wspr;\n  this.identity = new PrivateId(this._getProxyConnection());\n  this._name = options.appName;\n}\n\n/**\n * Performs client side binding of a remote service to a native javascript\n * stub object.\n *\n * Usage:\n * var service = runtime.bindTo('EndpointAddress', 'ServiceName')\n * var resultPromise = service.MethodName(arg);\n *\n * @param {string} name the veyron name of the service to bind to.\n * @param {object} optServiceSignature if set, javascript signature of methods\n * available in the remote service.\n * @param {function} [cb] if given, this function will be called on\n * completion of the bind.  The first argument will be an error if there is\n * one, and the second argument is an object with methods that perform rpcs to\n * service\n * methods.\n * @return {Promise} An object with methods that perform rpcs to service methods\n *\n */\nRuntime.prototype.bindTo = function(name, optServiceSignature, cb) {\n  var runtime = this;\n  var client = this._getClient();\n\n  if (typeof optServiceSignature === 'function') {\n    cb = optServiceSignature;\n    optServiceSignature = undefined;\n  }\n\n  if (cb) {\n    cb = cb.bind(runtime);\n  }\n\n  return client.bindTo(name, optServiceSignature, cb);\n};\n\n/**\n * Closes the underlying websocket connection.\n *\n * @example\n *\n * runtime.close(function(err, code, message){\n *   if (err) throw err;\n *   console.log('code: %s, message: %s', code, message)\n * });\n *\n * @param {Function} [cb] - Gets called once the underlying\n * websocket is closed. Arguments: error, code, message.\n *\n * @see {@link http://goo.gl/6nC1xs|WS Event: \"close\"}\n *\n */\nRuntime.prototype.close = function(cb) {\n  var runtime = this;\n\n  return runtime\n  ._getProxyConnection()\n  .close(cb);\n};\n\n/**\n * A Veyron server allows registration of services that can be\n * invoked remotely via RPCs.\n *\n * Usage:\n * var videoService = {\n *   play: function(videoName) {\n *     // Play video\n *   }\n * };\n *\n * var service = runtime.serve('mymedia/video', videoService)\n *\n * @param {string} name Name to serve under\n * @param {Object} serviceObject service object to serve\n * @param {*} serviceMetadata if provided a set of metadata for functions\n * in the service (such as number of return values).  It could either be\n * passed in as a properties object or a string that is the name of a\n * service that was defined in the idl files that the server knows about.\n * @param {function} cb if provided, the function will be called on\n * completion. The only argument is an error if there was one.\n * @return {Promise} Promise to be called when serve completes or fails\n * the endpoint address of the server will be returned as the value of promise\n */\nRuntime.prototype.serve = function(name, serviceObject, serviceMetadata, cb) {\n  var server = this._getServer();\n  return server.serve(name, serviceObject, serviceMetadata, cb);\n};\n\n/**\n * addIDL adds an IDL file to the set of definitions known by the server.\n * Services defined in IDL files passed into this method can be used to\n * describe the interface exported by a serviceObject passed into register.\n * @param {object} updates the output of the vdl tool on an idl.\n */\nRuntime.prototype.addIDL = function(updates) {\n  var server = this._getServer();\n  return server.addIDL(updates);\n};\n\n/**\n * Get or creates a new proxy connection\n * @return {ProxyConnection} A proxy connection\n */\nRuntime.prototype._getProxyConnection = function() {\n  if (!this._proxyConnection) {\n    this._proxyConnection = new ProxyConnection(this._wspr);\n  }\n  return this._proxyConnection;\n};\n\n/**\n * Get or creates a router\n * @return {ServerRouter} A router\n */\nRuntime.prototype._getRouter = function() {\n  if (!this._router) {\n    this._router = new ServerRouter(\n        this._getProxyConnection(),\n        this._name);\n  }\n  return this._router;\n};\n\n\n/**\n * Get or creates a client\n * @return {Client} A client\n */\nRuntime.prototype._getClient = function() {\n  this._client = this._client || new Client(this._getProxyConnection());\n  return this._client;\n};\n\n/**\n * Get or creates a server\n * @return {Server} A server\n */\nRuntime.prototype._getServer = function() {\n  this._server = this._server || new Server(this._getRouter());\n  return this._server;\n};\n\n/**\n * Create a new Namespace.\n * @param {string[]} Optional root names.\n * @return {Namespace} A namespace client instance.\n * TODO(aghassemi) rename back to newNamespace\n */\nRuntime.prototype.newNamespace = function(roots) {\n  var proxy = this._getProxyConnection();\n  return new Namespace(proxy, roots);\n};\n\n/**\n * TODO(bjornick): This should probably produce a PrivateId and not a PublicId,\n * but we don't have PrivateId store yet. This is mostly used for tests anyway.\n * Create a new Identity\n * @param {String} name the name for the identity.\n * @param {function} cb if provided a callback that will be called with the\n * new publicId.\n * @return {Promise} A promise that resolves to the new PublicId\n */\nRuntime.prototype.newIdentity = function(name, cb) {\n  var newIdentityDef = new Deferred(cb);\n  var messageDef = new Deferred();\n  var proxy = this._getProxyConnection();\n  var id = proxy.nextId();\n  var handler = new SimpleHandler(messageDef, proxy, id);\n\n  proxy.sendRequest(JSON.stringify(name), MessageType.NEW_ID, handler, id);\n\n  messageDef.promise.then(function(message) {\n    var id = new PublicId(message.names, message.handle, message.publicKey,\n                          proxy);\n\n    newIdentityDef.resolve(id);\n  }, newIdentityDef.reject);\n\n  return newIdentityDef.promise;\n};\n","/**\n * @fileoverview built-in Veyron errors\n */\n\nvar inherits = require('util').inherits;\n\nvar vError = {};\n\nvError.Actions = {\n  NoRetry: 0,\n  RetryConnection: 1,\n  RetryRefetch: 2,\n  RetryBackoff: 3,\n};\n\n/*\n * List of predefined error ids. Matches veyron2/vError/common.idl\n */\nvError.IdActions = {\n  Aborted: {\n    id: 'veyron.io/veyron/veyron2/verror.Aborted',\n    action: vError.Actions.NoRetry,\n  },\n  BadArg: {\n    id: 'veyron.io/veyron/veyron2/verror.BadArg',\n    action: vError.Actions.NoRetry,\n  },\n  BadProtocol: {\n    id: 'veyron.io/veyron/veyron2/verror.BadProtocol',\n    action: vError.Actions.NoRetry,\n  },\n  Exists: {\n    id: 'veyron.io/veyron/veyron2/verror.Exists',\n    action: vError.Actions.NoRetry,\n  },\n  Internal: {\n    id: 'veyron.io/veyron/veyron2/verror.Internal',\n    action: vError.Actions.NoRetry,\n  },\n  NoAccess: {\n    id: 'veyron.io/veyron/veyron2/verror.NoAccess',\n    action: vError.Actions.NoRetry,\n  },\n  NoExist: {\n    id: 'veyron.io/veyron/veyron2/verror.NoExist',\n    action: vError.Actions.NoRetry,\n  },\n  NoExistOrNoAccess: {\n    id: 'veyron.io/veyron/veyron2/verror.NoExistOrNoAccess',\n    action: vError.Actions.NoRetry,\n  },\n  Unknown: {\n    id: 'veyron.io/veyron/veyron2/verror.Unknown',\n    action: vError.Actions.NoRetry,\n  }\n};\n\n/*\n * Creates an error object given the ID as the name and a message\n * @constructor\n * @param {string} message message\n * @param {vError.IdActions} idAction idActionription of error\n */\nvError.VeyronError = function(message, idAction) {\n  if (!(this instanceof vError.VeyronError)) {\n    return new vError.VeyronError(message, idAction);\n  }\n\n  Error.call(this);\n\n  this.message = message || '';\n\n  this.idAction = idAction || vError.IdActions.Unknown;\n\n  if (! this.idAction.id) {\n    this.idAction.id = vError.IdActions.Unknown.id;\n  }\n\n  if (typeof Error.captureStackTrace === 'function') {\n    Error.captureStackTrace(this, vError.VeyronError);\n  } else {\n    this.stack = (new Error()).stack;\n  }\n};\n\ninherits(vError.VeyronError, Error);\n\n/*\n * Creates an error object indicating operation aborted, e.g. connection closed.\n * @constructor\n * @param {string} message message\n */\nvError.AbortedError = function(message) {\n  if (!(this instanceof vError.AbortedError)) {\n    return new vError.AbortedError(message);\n  }\n  vError.VeyronError.call(this, message, vError.IdActions.Aborted);\n};\ninherits(vError.AbortedError, vError.VeyronError);\n\n/*\n * Creates an error object indicating requester specified an invalid argument.\n * @constructor\n * @param {string} message message\n * @return {Error} Error object with name set to the badarg error id.\n */\nvError.BadArgError = function(message) {\n  if (!(this instanceof vError.BadArgError)) {\n    return new vError.BadArgError(message);\n  }\n  vError.VeyronError.call(this, message, vError.IdActions.BadArg);\n};\ninherits(vError.BadArgError, vError.VeyronError);\n\n/*\n * Creates an error object indicating protocol mismatch,\n * including type or argument errors.\n * @param {string} message message\n * @return {Error} Error object with name set to the bad protocol error id.\n */\nvError.BadProtocolError = function(message) {\n  if (!(this instanceof vError.BadProtocolError)) {\n    return new vError.BadProtocolError(message);\n  }\n  vError.VeyronError.call(this, message, vError.IdActions.BadProtocol);\n};\ninherits(vError.BadProtocolError, vError.VeyronError);\n\n/*\n * Creates an error object indicating requested entity already exists\n * @param {string} message message\n * @return {Error} Error object with name set to the exists error id.\n */\nvError.ExistsError = function(message) {\n  if (!(this instanceof vError.ExistsError)) {\n    return new vError.ExistsError(message);\n  }\n  vError.VeyronError.call(this, message, vError.IdActions.Exists);\n};\ninherits(vError.ExistsError, vError.VeyronError);\n\n/*\n * Creates an error object indicating internal invariants broken;\n * something is very wrong\n * @param {string} message message\n * @return {Error} Error object with name set to the internal error id.\n */\nvError.InternalError = function(message) {\n  if (!(this instanceof vError.InternalError)) {\n    return new vError.InternalError(message);\n  }\n  vError.VeyronError.call(this, message, vError.IdActions.Internal);\n};\ninherits(vError.InternalError, vError.VeyronError);\n\n/*\n * Creates an error object indicating requester isn't authorized\n * to access the entity.\n * @param {string} message message\n * @return {Error} Error object with name set to the not authorized error id.\n */\nvError.NoAccessError = function(message) {\n  if (!(this instanceof vError.NoAccessError)) {\n    return new vError.NoAccessError(message);\n  }\n  vError.VeyronError.call(this, message, vError.IdActions.NoAccess);\n};\ninherits(vError.NoAccessError, vError.VeyronError);\n\n/*\n * Creates an Error object indicating requested entity (e.g. object, method)\n * does not exist.\n * @param {string} message message\n * @return {Error} Error object with name set to the not found error id.\n */\nvError.NoExistError = function(message) {\n  if (!(this instanceof vError.NoExistError)) {\n    return new vError.NoExistError(message);\n  }\n  vError.VeyronError.call(this, message, vError.IdActions.NoExist);\n};\ninherits(vError.NoExistError, vError.VeyronError);\n\n/*\n * Creates an Error object indicating requested entity (e.g. object, method)\n * either does not exist, or that the requester is not authorized to access it.\n * @param {string} message message\n * @return {Error} Error object with name set to the not found error id.\n */\nvError.NoExistOrNoAccessError = function(message) {\n  if (!(this instanceof vError.NoExistOrNoAccessError)) {\n    return new vError.NoExistOrNoAccessError(message);\n  }\n  vError.VeyronError.call(this, message, vError.IdActions.NoExistOrNoAccess);\n};\ninherits(vError.NoExistOrNoAccessError, vError.VeyronError);\n\nvError.UnknownError = function(message) {\n  if (!(this instanceof vError.UnknownError)) {\n    return new vError.UnknownError(message);\n  }\n\n  vError.VeyronError.call(this, message);\n};\n\ninherits(vError.UnknownError, vError.VeyronError);\n\nmodule.exports = vError;\n","/**\n * @fileoverview Helpers for manipulating veyron names.\n */\n\nvar _numInitialSlashes = function(s) {\n  for (var i = 0; i < s.length; i++) {\n    if (s.charAt(i) !== '/') {\n      return i;\n    }\n  }\n  return s.length;\n};\nvar _numTailSlashes = function(s) {\n  for (var i = s.length - 1; i >= 0; i--) {\n    if (s.charAt(i) !== '/') {\n      return s.length - 1 - i;\n    }\n  }\n  return s.length;\n};\n\n\nvar _removeInitialSlashes = function(s) {\n  return s.replace(/^\\/*/g, '');\n};\nvar _removeTailSlashes = function(s) {\n  return s.replace(/\\/*$/g, '');\n};\n\nvar _joinNamePartsOnArray = function(parts) {\n  if (parts.length === 0) {\n    return '';\n  }\n\n  var name = parts[0];\n  for (var i = 1; i < parts.length; i++) {\n    var addedPart = parts[i];\n\n    var numNameSlashes = _numTailSlashes(name);\n    var numAddedPartSlashes = _numInitialSlashes(addedPart);\n\n    if (numNameSlashes === 0 && numAddedPartSlashes === 0) {\n      name += '/' + addedPart;\n      continue;\n    }\n\n    if (numAddedPartSlashes > numNameSlashes) {\n      name = _removeTailSlashes(name);\n      name += addedPart;\n    } else {\n      name += _removeInitialSlashes(addedPart);\n    }\n  }\n\n  return name;\n};\n\n/**\n * Joins parts of a name into a whole.\n * It preserves the rootedness and terminality of the name components.\n * Examples:\n * join(['a, b']) -> 'a/b'\n * join('/a/b/', '//d') -> '/a/b//d'\n * join('//a/b', 'c/') -> '//a/b/c/'\n * @param {array | varargs} Either a single array that contains the strings\n * to join or a variable number of string arguments that will be joined.\n * @return {string} A joined string\n */\nvar join = function(parts) {\n  if (Array.isArray(parts)) {\n    return _joinNamePartsOnArray(parts);\n  }\n  return _joinNamePartsOnArray(Array.prototype.slice.call(arguments));\n};\n\n/**\n  * Determines if a name is rooted, that is beginning with a single '/'.\n  * @param {string} The veyron name.\n  * @return {boolean} True if the name is rooted, false otherwise.\n  */\nvar isRooted = function(name) {\n  return _numInitialSlashes(name) === 1;\n};\n\n/**\n  * Determines if a name is terminal, meaning that it corresponds to a final\n  * endpoint and name and does not need to be resolved further.\n  * @param {string} The veyron name.\n  * @return {boolean} True if the name is a terminal name, false otherwise.\n  */\nvar isTerminal = function(name) {\n  var numInitialSlashes = _numInitialSlashes(name);\n  if (numInitialSlashes >= 2) {\n    // If the name begins with '//', it is terminal.\n    return true;\n  } else if (numInitialSlashes === 1) {\n    // If the name begins with a single slash, it is terminal if there are no\n    // more slashes (indexOf === -1) or if the next slash is a double slash.\n    var nextSlashIndex = name.substr(1).indexOf('/');\n    var nextDoubleSlashIndex = name.substr(1).indexOf('//');\n    return nextSlashIndex === nextDoubleSlashIndex;\n  } else {\n    // If there are no initial slashes, it is only terminal if it is the empty\n    // string.\n    return name.length === 0;\n  }\n};\n\n/**\n  * Converts a veyron name to a terminal name. This is used to generate a final\n  * name when a name has finished resolving.\n  * @param {string} The initial veyron name.\n  * @return {string} A terminal veyron name.\n  */\nvar convertToTerminalName = function(name) {\n  // '' -> '' and '/' -> ''\n  if (name === '' || name === '/') {\n    return '';\n  }\n\n  if (isRooted(name)) {\n    if (name.substr(1).indexOf('/') === -1) {\n      // '/endpoint' -> '/endpoint'\n      return name;\n    }\n    if (name.substr(1).indexOf('/') === name.length - 2) {\n      // '/endpoint/' -> '/endpoint'\n      return name.substring(0, name.length - 1);\n    }\n    // '/endpoint/something' -> '/endpoint//something'\n    // '/endpoint//something -> '/endpoint//something'\n    return name.replace(/^(\\/[^/]+?)[/]*\\//, '$1//');\n  } else {\n    // '/////something' -> '//something'\n    return '//' + _removeInitialSlashes(name);\n  }\n};\n\n/**\n  * Strips the basename off the rest of the given veyron name.\n  * @param {string} The veyron name.\n  * @return {string} The string prefixing the given name's basename.\n  */\nvar stripBasename = function(name) {\n  return name.substring(0, name.lastIndexOf('/') + 1);\n};\n\n/**\n  * Gets the basename of the given veyron name.\n  * @param {string} The veyron name.\n  * @return {string} The basename of the given name\n  */\nvar basename = function(name) {\n  return name.substring(name.lastIndexOf('/') + 1);\n};\n\nmodule.exports = {\n  join: join,\n  isTerminal: isTerminal,\n  isRooted: isRooted,\n  convertToTerminalName: convertToTerminalName,\n  stripBasename: stripBasename,\n  basename: basename\n};\n","/**\n * @fileoveriew A leaf dispatcher that uses a single service object for\n * all suffixes\n */\n\nvar IdlHelper = require('./../idl/idl');\nvar ServiceWrapper = IdlHelper.ServiceWrapper;\n\n/**\n * Returns a dispatcher function that will reuse the same service object\n * for all suffixes\n * @param {object} object the service object that has a set of exported methods\n * @param {object} metadata the metadata is an optional parameter that adds\n * annotations to the functions exported by the functions.  This is generally\n * created by running the vdl compiler.\n * @param {Authorizer} authorizer the authorizer to use.\n * @return {function} a dispatcher function that will reuse the same service\n * object.\n */\nfunction createLeafDispatcher(serviceObject, metadata, authorizer) {\n  var wrapper = new ServiceWrapper(serviceObject, metadata);\n  if (metadata && metadata._validate) {\n    var err = wrapper.validate(wrapper.metadata);\n    if (err) {\n      throw err;\n    }\n  }\n\n  return function() {\n    return {\n      service: wrapper,\n      authorizer: authorizer,\n    };\n  };\n}\n\n/**\n * Export module\n */\nmodule.exports = createLeafDispatcher;\n","/**\n * @fileoverview Caveats for blessings\n */\n\nmodule.exports = {\n  MethodCaveat: MethodCaveat,\n};\n\n/**\n * A caveat that is only valid for calling one of a list of methods.\n * @constructor\n * @param{Array} methods the methods that the blessee can call.\n */\nfunction MethodCaveat(methods) {\n  this._methods = methods;\n}\n\nMethodCaveat.prototype.toJSON = function() {\n  return {\n    _type: 'MethodCaveat',\n    data: this._methods\n };\n};\n","/**\n * @fileoverview The ACL authorizer\n */\n\nvar blessingMatches = require('./blessing_matching');\nvar vError = require('./../lib/verror');\n\nmodule.exports = authorizer;\n\nvar errACL = new vError.NoAccessError('acl authorization failed');\n\n/**\n * An access control list.\n * @typedef ACL\n * @type {Object}\n * @property {Object} in A map of blessing patterns to a list of labels that\n * the pattern is authorized for.  An example would be:\n * {\n *   'foo/bar': [Read, Write],\n *   'foo': [Read, Write, Admin],\n * }\n * This means that any 'foo/bar' has access to the read/write acces and foo\n * has read, write, and admin access.\n * @property {Object} notIn A map of principala patterns to a list of labels\n * they are disallowed for.\n */\n\n/**\n * The ACL authorizer.\n * @param {ACL} acl The set of acls to apply.\n * @return {Authorize} An authorizer that applies the acls.\n */\nfunction authorizer(acl) {\n  return function authorize(ctx) {\n    // If the remoteId is ourselves (i.e a self rpc), then we\n    // always authorize.\n    if (ctx.localId && ctx.remoteId &&\n        ctx.localId.publicKey === ctx.remoteId.publicKey) {\n      return null;\n    }\n    var remoteNames = ctx.remoteId.names;\n    for (var i = 0; i < remoteNames.length; i++) {\n      if (matchesACL(remoteNames[i], ctx.label, acl)) {\n        return null;\n      }\n    }\n    return errACL;\n  };\n}\n\n// Returns whether name passed in has permission for the passed in\n// label.\nfunction matchesACL(name, label, acl) {\n  // The set of labels that are allowed for\n  // the given names.\n  var pattern;\n  var patLabels;\n  var isAllowed = false;\n\n  // Add all the inclusive patterns.\n  for (pattern in acl.in) {\n    if (!acl.in.hasOwnProperty(pattern)) {\n      continue;\n    }\n    patLabels = acl.in[pattern];\n    if (blessingMatches(name, pattern)) {\n      if (patLabels.indexOf(label) !== -1) {\n        isAllowed = true;\n        break;\n      }\n    }\n  }\n\n  // If the names didn't match of the in patterns, then they are\n  // rejected.\n  if (!isAllowed) {\n    return false;\n  }\n\n  for (pattern in acl.notIn) {\n    if (!acl.notIn.hasOwnProperty(pattern)) {\n      continue;\n    }\n    if (pattern.lastIndexOf('...') === pattern.length - 4) {\n      pattern = pattern.substr(0, pattern.length - 3);\n    }\n    patLabels = acl.notIn[pattern];\n    // We flip name and pattern, because we want to match any blessing\n    // that could be derived from the pattern in the map.\n    if (blessingMatches(pattern, name)) {\n      if (patLabels.indexOf(label) !== -1) {\n        return false;\n      }\n    }\n  }\n\n  return true;\n}\n","/**\n * @fileoverview Veyron.js promise implementation.\n *\n * Currently this is just bluebird promises.\n *\n * We'd like our promise implementation to follow the es6/A+ promise spec, but\n * the \"es6-promises\" module eats errors, so we are using bluebird.\n *\n * See for reference:\n *   http://blog.soareschen.com/the-problem-with-es6-promises\n *   https://github.com/soareschen/es6-promise-debugging\n *   https://github.com/petkaantonov/bluebird#error-handling\n *\n * TODO(nlacasse): Wrap bluebird promises to only expose es6/A+ promise API.\n * Otherwise users might rely on non-A+ parts of the bluebird API, preventing us\n * from switching in the future.\n */\n\nmodule.exports = require('bluebird');\n","/**\n *  @fileoverview Server allows creation of services that can be invoked\n *  remotely via RPCs.\n *\n *  Usage:\n *  var videoService = {\n *    play: {\n *      // Play video\n *    }\n *  };\n *\n *  var s = new server(proxyConnection);\n *  s.serve('mymedia/video', videoService);\n */\n\nvar Deferred = require('./../lib/deferred');\nvar Promise = require('./../lib/promise');\nvar IdlHelper = require('./../idl/idl');\nvar ServiceWrapper = IdlHelper.ServiceWrapper;\nvar vLog = require('./../lib/vlog');\n\nvar nextServerID = 1; // The ID for the next server.\n\n/**\n * represents a veyron server which allows registration of services that can be\n * invoked remotely via RPCs.\n * @constructor\n * @param {Object} router the server router.\n */\nfunction Server(router) {\n  if (!(this instanceof Server)) {\n    return new Server(router);\n  }\n\n  this._router = router;\n  this._handle = 0;\n  this.id = nextServerID++;\n  this.dispatcher = null;\n  this.serviceObjectHandles = {};\n}\n\n/**\n * @typedef LookupResponse\n * @type {Object}\n * @property {ServiceWrapper} service The ServiceWrapper that will handle\n * method call.\n * @property {Authorize} authorizer An Authorizer that will handle the\n * authorization for the method call.  If null, then the default strict\n * authorizer will be used.\n */\n\n/**\n * A function that returns the service object for a suffix/method pair.\n * @callback Lookup\n * @param {string} suffix the suffix for the call\n * @param {string} method the method for the call\n * @param {Lookup-callback} cb the callback to call when the dispatch is\n * complete\n * @return {LookupResponse|Promise} either the LookupResponse object to\n * handle the method call or a Promise that will be resolved the service\n * callback.\n */\n\n/**\n * Callback passed into Lookup\n * @callback Lookup-callback\n * @param {Error} err an error if one occurred\n * @param {ServiceWrapper} object the object that will handle the method call\n */\n\n/**\n * Callback passed into Authorize\n * @callback Authorize-callback\n * @param {Error} err if set, the reason that the authorization failed.\n */\n\n/**\n * A function that returns an error if the operation is not authorizedd\n * @callback Authorize\n * @param {SecurityContext} context the context of the rpc.\n * @param {Authorize-callback} cb the callback to call with the result if\n * the rpc is asynchronous.  This can be ignored if the Authorizer returns\n * a promise or the result.\n * @return {Promise|Error} either an error that occurred (or null if there was\n * no error) or a Promise that will be resolved if the authorization succeeded\n * and rejected if it failed.\n */\n/**\n * Serve serves the given service object under the given name.  It will\n * register them with the mount table and maintain that registration so long\n * as the stop() method has not been called.  The name determines where\n * in the mount table's name tree the new services will appear.\n *\n * To serve names of the form \"mymedia/*\" make the calls:\n * serve(\"mymedia\", dispatcher);\n\n * serve may be called multiple times to serve the same service under\n * multiple names.  If different objects are given on the different calls\n * it is considered an error.\n *\n * @param {string} name Name to serve under\n * @param {Lookup} lookup a function that will take in the suffix\n * and the method to be called and return the service object for that suffix.\n * @param {function} cbif provided, the function will be called on\n * completion. The only argument is an error if there was one.\n * @return {Promise} Promise to be called when serve completes or fails\n * the endpoint address of the server will be returned as the value of promise\n */\nServer.prototype.serve = function(name, lookup, cb) {\n  this.dispatcher = lookup;\n  return this._router.serve(name, this, cb);\n};\n\n/**\n * Stop gracefully stops all services on this Server.\n * New calls are rejected, but any in-flight calls are allowed to complete.\n * All published named are unmounted.\n * @param {function} cb if provided, the function will be called on\n * completion. The only argument is an error if there was one.\n * @return {Promise} Promise to be called when stop service completes or fails\n */\nServer.prototype.stop = function(cb) {\n  return this._router.stopServer(this, cb);\n};\n\n/*\n * Returns the service that maps to the handle that is passed in\n * @param {Number} handle the handle for the service\n * @return {Object} the service object for the handle.\n */\nServer.prototype.getServiceForHandle = function(handle) {\n  var result = this.serviceObjectHandles[handle];\n  delete this.serviceObjectHandles[handle];\n\n  return result.service;\n};\n\n/*\n * Handles the authorization for an RPC.\n * @param {Number} handle the handle for the authorizer\n * @param {object} request the context of the authorization\n * @return {Promise} a promise that will be fulfilled with the result.\n */\nServer.prototype.handleAuthorization = function(handle, request) {\n  var handler = this.serviceObjectHandles[handle];\n  if (!handler || !handler.authorizer) {\n    return Promise.reject(new Error('Unknown handle ' + handle));\n  }\n  var def = new Deferred();\n\n  function cb(e) {\n    if (e) {\n      def.reject(e);\n      return;\n    }\n    def.resolve();\n  }\n\n  var result;\n  try {\n    result = handler.authorizer(request, cb);\n  } catch (e) {\n    vLog.error(e);\n    return Promise.reject(e);\n  }\n\n  if (result === undefined) {\n    return def.promise;\n  }\n\n  if (result === null) {\n    return Promise.resolve();\n  }\n\n  if (result.then) {\n    return result;\n  }\n\n  return Promise.reject(result);\n};\n\n/*\n * Handles the result of lookup and returns an error if there was any.\n */\nServer.prototype._handleLookupResult = function(object) {\n  if (!(object.service instanceof ServiceWrapper)) {\n    return new Error('The result of lookup should be of type ServiceWrapper');\n  }\n\n  object._handle = this._handle;\n  this.serviceObjectHandles[object._handle] = object;\n  this._handle++;\n  return null;\n};\n\n/*\n * Perform the lookup call to the user code on the suffix and method passed in.\n */\nServer.prototype._handleLookup = function(suffix, method) {\n  var self = this;\n  var def = new Deferred();\n  function cb(e, v) {\n    if (e) {\n      def.reject(e);\n      return;\n    }\n    var err = self._handleLookupResult(v);\n    if (err) {\n      def.reject(err);\n    } else {\n      def.resolve(v);\n    }\n  }\n\n  var result;\n  try {\n    result = this.dispatcher(suffix, method, cb);\n  } catch (e) {\n    def.reject(e);\n    vLog.error(e);\n    return def.promise;\n  }\n\n  function handleResult(v) {\n    var err = self._handleLookupResult(v);\n    if (err) {\n     return Promise.reject(err);\n    }\n    return Promise.resolve(v);\n  }\n\n  if (result === undefined) {\n    return def.promise.then(handleResult);\n  }\n\n  if (result instanceof Error) {\n    def.reject(result);\n    return def.promise;\n  }\n\n  var promise = Promise.resolve(result);\n  return promise.then(handleResult);\n};\n\n/**\n * Export the module\n */\nmodule.exports = Server;\n","/**\n * @fileoveriew A router that handles incoming server rpcs.\n */\n\nvar Promise = require('../lib/promise');\nvar Stream = require('../proxy/stream');\nvar MessageType = require('../proxy/message_type');\nvar IncomingPayloadType = require('../proxy/incoming_payload_type');\nvar ErrorConversion = require('../proxy/error_conversion');\nvar Deferred = require('./../lib/deferred');\nvar vLog = require('./../lib/vlog');\nvar SimpleHandler = require('../proxy/simple_handler');\nvar StreamHandler = require('../proxy/stream_handler');\nvar vError = require('../lib/verror');\nvar IdlHelper = require('./../idl/idl');\nvar SecurityContext = require('../security/context');\nvar ServerContext = require('./server_context');\n\n/**\n * A router that handles routing incoming requests to the right\n * server\n * @constructor\n */\nvar Router = function(proxy, appName) {\n  this._servers = {};\n  this._proxy = proxy;\n  this._streamMap = {};\n  this._contextMap = {};\n  this._appName = appName;\n  proxy.addIncomingHandler(IncomingPayloadType.INVOKE_REQUEST, this);\n  proxy.addIncomingHandler(IncomingPayloadType.LOOKUP_REQUEST, this);\n  proxy.addIncomingHandler(IncomingPayloadType.AUTHORIZATION_REQUEST, this);\n  proxy.addIncomingHandler(IncomingPayloadType.CANCEL, this);\n};\n\n/**\n * Injects the injections into the eight positions in args and\n * returns what was injected.\n * @param {Array} args The arguments to inject into.\n * @param {Object} injectionPositions A map of injected variables to the\n * position to put in args.\n * @param {Object} injections A map of injected variables to values.\n * @return {Array} the array of variables that were injected.\n */\nvar inject = function(args, injectionPositions, injections) {\n  var keys = Object.keys(injectionPositions);\n  var invertedMap = {};\n  keys.forEach(function(key) {\n    invertedMap[injectionPositions[key]] = key;\n  });\n  var values = keys.map(function getValue(k) {\n    return injectionPositions[k];\n  });\n  values.filter(function removeUndefined(value) {\n    return value !== undefined;\n  });\n  values.sort();\n  var keysInserted = [];\n  values.forEach(function actuallyInject(pos) {\n    var key = invertedMap[pos];\n    args.splice(pos, 0, injections[key]);\n    keysInserted.push(key);\n  });\n  return keysInserted;\n};\n\n// Wraps the call to the method with a try block in the smallest\n// function possible, so that v8 de-optimizes as little as possible.\nRouter.prototype.invokeMethod = function (receiver, method, args) {\n  // Call the registered method on the requested service\n  try {\n    return method.apply(receiver, args);\n  } catch (err) {\n\n    // Gaurd against rejecting non-errors\n    // TODO(jasoncampbell): consolidate all error conversion into verror\n    if (! (err instanceof Error)) {\n      var message;\n\n      if (typeof err === 'undefined' || err === null) {\n        message = 'Unknown exception.';\n      } else {\n        message = JSON.stringify(err);\n      }\n\n      return new Error(message);\n    }\n\n    return err;\n  }\n};\n\nRouter.prototype.handleRequest = function(messageId, type, request) {\n  switch (type) {\n    case IncomingPayloadType.INVOKE_REQUEST:\n      this.handleRPCRequest(messageId, request);\n      break;\n    case IncomingPayloadType.LOOKUP_REQUEST:\n      this.handleLookupRequest(messageId, request);\n      break;\n    case IncomingPayloadType.AUTHORIZATION_REQUEST:\n      this.handleAuthorizationRequest(messageId, request);\n      break;\n    case IncomingPayloadType.CANCEL:\n      this.handleCancel(messageId, request);\n      break;\n    default:\n      vLog.Error('Unknown request type ' + type);\n  }\n};\n\nRouter.prototype.handleAuthorizationRequest = function(messageId, request) {\n  var server = this._servers[request.serverID];\n  if (!server) {\n    var data = JSON.stringify({\n      err: new vError.ExistsError('unknown server')\n    });\n    this._proxy.sendRequest(data, MessageType.AUTHORIZATION_RESPONSE,\n        null, messageId);\n    return;\n  }\n  var router = this;\n  var securityContext = new SecurityContext(request.context, this._proxy);\n  server.handleAuthorization(request.handle, securityContext).then(function() {\n    router._proxy.sendRequest('{}', MessageType.AUTHORIZATION_RESPONSE, null,\n        messageId);\n  }).catch(function(e) {\n    var data = JSON.stringify({\n      err: ErrorConversion.toStandardErrorStruct(e, this._appName,\n                                                 request.context.method)\n    });\n    router._proxy.sendRequest(data, MessageType.AUTHORIZATION_RESPONSE, null,\n        messageId);\n  });\n};\n\nRouter.prototype.handleLookupRequest = function(messageId, request) {\n  var server = this._servers[request.serverID];\n  if (!server) {\n    var data = JSON.stringify({\n      err: new vError.ExistsError('unknown server')\n    });\n    this._proxy.sendRequest(data, MessageType.LOOKUP_RESPONSE,\n        null, messageId);\n    return;\n  }\n\n  var self = this;\n  server._handleLookup(request.suffix, request.method).then(function(value) {\n    var hasAuthorizer = (typeof value.authorizer === 'function');\n    var label = value.service.labelForMethod(request.method);\n    var data = {\n      signature: IdlHelper.generateIdlWireDescription(value.service),\n      hasAuthorizer: hasAuthorizer,\n      handle: value._handle,\n      label: label,\n    };\n    self._proxy.sendRequest(JSON.stringify(data), MessageType.LOOKUP_RESPONSE,\n        null, messageId);\n  }).catch(function(err) {\n    var data = JSON.stringify({\n      err: ErrorConversion.toStandardErrorStruct(err, self._appName,\n                                                 request.method),\n    });\n    self._proxy.sendRequest(data, MessageType.LOOKUP_RESPONSE,\n        null, messageId);\n  });\n};\n\n/**\n * Handles cancellations of in-progress requests againsts Javascript service\n * invokations.\n * @param {string} messageId Message Id set by the server.\n */\nRouter.prototype.handleCancel = function(messageId) {\n  var ctx = this._contextMap[messageId];\n  if (ctx) {\n    ctx.cancel();\n  }\n};\n\n/**\n * Handles incoming requests from the server to invoke methods on registered\n * services in JavaScript.\n * @param {string} messageId Message Id set by the server.\n * @param {Object} request Invocation request JSON. Request's structure is\n * {\n *   serverId: number // the server id\n *   method: string // Name of the method on the service to call\n *   args: [] // Array of positional arguments to be passed into the method\n * }\n */\nRouter.prototype.handleRPCRequest = function(messageId, request) {\n  var err;\n  var server = this._servers[request.serverId];\n  if (!server) {\n    err = new Error('Request for unknown server ' + request.serverId);\n    this.sendResult(messageId, request.method, null, err);\n    return;\n  }\n\n  var serviceWrapper = server.getServiceForHandle(request.handle);\n  if (!serviceWrapper) {\n    err = new Error('No service found');\n    this.sendResult(messageId, request.method, null, err);\n    return;\n  }\n\n  var serviceObject = serviceWrapper.object;\n\n  // Find the method\n  var serviceMethod = serviceObject[request.method];\n  if (serviceMethod === undefined) {\n    err = new Error('Requested method ' + request.method +\n        ' not found on');\n    this.sendResult(messageId, request.method, null, err);\n    return;\n  }\n  var metadata = serviceWrapper.metadata[request.method];\n\n  var self = this;\n  var sendInvocationError = function(e, metadata) {\n    var stackTrace;\n    if (e instanceof Error && e.stack !== undefined) {\n      stackTrace = e.stack;\n    }\n    vLog.debug('Requested method ' + request.method +\n        ' threw an exception on invoke: ', e, stackTrace);\n    var numOutArgs = metadata.numOutArgs;\n    var result;\n    switch (numOutArgs) {\n      case 0:\n        break;\n      case 1:\n        result = null;\n        break;\n      default:\n        result = new Array(numOutArgs);\n    }\n    self.sendResult(messageId, request.method, result, e,\n        metadata);\n  };\n  var args = request.args;\n\n  var ctx = new ServerContext(request, this._proxy);\n  this._contextMap[messageId] = ctx;\n\n  // Create callback to pass to the function, if it is requested.\n  var finished = false;\n  var cb = function cb(e, v) {\n    if (finished) {\n      return;\n    }\n    finished = true;\n    ctx.remoteId.release();\n    self.sendResult(messageId, request.method, v, e, metadata);\n  };\n\n  var injections = {\n    $stream: new Stream(messageId, this._proxy.senderPromise, false),\n    $cb: cb,\n    $context: ctx,\n    $suffix: ctx.suffix,\n    $name: ctx.name,\n    $remoteId: ctx.remoteId\n  };\n\n  var variables = inject(args, metadata.injections, injections);\n  if (variables.indexOf('$stream') !== -1) {\n    var stream = injections['$stream'];\n    this._streamMap[messageId] = stream;\n    var rpc = new StreamHandler(stream);\n    this._proxy.addIncomingStreamHandler(messageId, rpc);\n  }\n\n  // Invoke the method\n  var result = this.invokeMethod(serviceObject, serviceMethod, args);\n\n  if (result instanceof Error) {\n    sendInvocationError(result, metadata);\n    return;\n  }\n\n  // Normalize result to be a promise\n  var resultPromise = Promise.resolve(result);\n\n  if (variables.indexOf('$cb') !== -1) {\n    // The callback takes care of sending the result, so we don't use the\n    // promises.\n    return;\n  }\n\n  // Send the result back to the server\n  resultPromise.then(function(value) {\n    if (finished) {\n      return;\n    }\n    ctx.remoteId.release();\n    finished = true;\n    self.sendResult(messageId, request.method, value,\n        null, metadata);\n  }, function(err) {\n    if (finished) {\n      return;\n    }\n\n    finished = true;\n\n    // Gaurd against rejecting non-errors\n    // TODO(jasoncampbell): consolidate all error conversion into verror\n    if (! (err instanceof Error)) {\n      var message;\n\n      if (typeof err === 'undefined' || err === null) {\n        message = 'Unknown exception.';\n      } else {\n        message = JSON.stringify(err);\n      }\n\n      err = new Error(message);\n    }\n\n    sendInvocationError(err, metadata);\n  });\n};\n\n/**\n * Sends the result of a requested invocation back to jspr\n * @param {string} messageId Message id of the original invocation request\n * @param {string} name Name of method\n * @param {Object} value Result of the call\n * @param {Object} err Error from the call\n * @param {Object} metadata Metadata about the function.\n */\nRouter.prototype.sendResult = function(messageId, name, value, err, metadata) {\n  var results = [];\n  if (metadata) {\n    switch (metadata.numOutArgs) {\n      case 0:\n        if (value !== undefined) {\n          vLog.error('Unexpected return value from ' + name + ': ' + value);\n        }\n        results = [];\n        break;\n      case 1:\n        results = [value];\n        break;\n      default:\n        if (Array.isArray(value)) {\n          if (value.length !== metadata.numOutArgs) {\n            vLog.error('Wrong number of arguments returned by ' + name +\n                '. expected: ' + metadata.numOutArgs + ', got:' +\n                value.length);\n          }\n          results = value;\n        } else {\n          vLog.error('Wrong number of arguments returned by ' + name +\n              '. expected: ' + metadata.numOutArgs + ', got: 1');\n          results = [value];\n        }\n    }\n  } else {\n    results = [value];\n  }\n\n  var errorStruct = null;\n  if (err !== undefined && err !== null) {\n    errorStruct = ErrorConversion.toStandardErrorStruct(err, this._appName,\n                                                        name);\n  }\n\n  // Clean up the context map.\n  var ctx = this._contextMap[messageId];\n  if (ctx) {\n    // Set an empty error handler to catch the now useless cancellation error\n    // before we cancel the context.  This just prevents an annoying warning\n    // from being printed.\n    ctx.waitUntilDone().catch(function(err) {});\n    ctx.cancel();\n    delete this._contextMap[messageId];\n  }\n\n  // If this is a streaming request, queue up the final response after all\n  // the other stream requests are done.\n  var stream = this._streamMap[messageId];\n  if (stream) {\n    // We should probably remove the stream from the dictionary, but it's\n    // not clear if there is still a reference being held elsewhere.  If there\n    // isn't, then GC might prevent this final message from being sent out.\n    stream.serverClose(value, errorStruct);\n    this._proxy.dequeue(messageId);\n  } else {\n    var responseData = {\n      results: results,\n      err: errorStruct\n    };\n\n    var responseDataJSON = JSON.stringify(responseData);\n    this._proxy.sendRequest(responseDataJSON, MessageType.RESPONSE, null,\n        messageId);\n  }\n};\n\n/**\n * Serves the server under the given name\n * @param {string} name Name to serve under\n * @param {Veyron.Server} The server who will handle the requests for this\n * name.\n * @param {function} [cb] If provided, the function will be called when\n * serve completes.  The first argument passed in is the error if there\n * was any and the second argument is the endpoint.\n * @return {Promise} Promise to be called when serve completes or fails\n * the endpoint string of the server will be returned as the value of promise\n */\nRouter.prototype.serve = function(name, server, cb) {\n  vLog.info('Serving under the name: ', name);\n\n  var messageJSON = {\n    name: name,\n    serverId: server.id,\n  };\n\n  this._servers[server.id] = server;\n\n  var def = new Deferred(cb);\n  var message = JSON.stringify(messageJSON);\n  var id = this._proxy.id;\n  this._proxy.id += 2;\n  var handler = new SimpleHandler(def, this._proxy, id);\n  // Send the serve request to the proxy\n  this._proxy.sendRequest(message, MessageType.SERVE, handler, id);\n\n  return def.promise;\n};\n\n/**\n * Sends a stop server request to jspr.\n * @param {Server} server Server object to stop.\n * @param {function} cb if provided, the function will be called on\n * completion. The only argument is an error if there was one.\n * @return {Promise} Promise to be called when stop service completes or fails\n */\nRouter.prototype.stopServer = function(server, cb) {\n  var self = this;\n\n  var def = new Deferred(cb);\n  var id = this._proxy.id;\n  this._proxy.id += 2;\n  var handler = new SimpleHandler(def, this._proxy, id);\n  // Send the stop request to jspr\n  this._proxy.sendRequest(server.id.toString(), MessageType.STOP, handler, id);\n\n  return def.promise.then(function(result) {\n    delete self._servers[server.id];\n    return result;\n  });\n};\n\n\nmodule.exports = Router;\n","/**\n * @fileoverview WebSocket client implementation\n */\n\nvar WebSocket = require('ws');\nvar Deferred = require('./../lib/deferred');\nvar vLog = require('./../lib/vlog');\nvar Proxy = require('./proxy');\nvar isBrowser = require('is-browser');\n\n/**\n * A client for the veyron service using websockets. Connects to the veyron wspr\n * and performs RPCs.\n * @constructor\n * @param {string} url of wspr that connects to the veyron network\n * identity\n */\nfunction ProxyConnection(url) {\n  this.url = url.replace(/^(http|https)/, 'ws') + '/ws';\n  this.currentWebSocketPromise = null;\n  // Since we haven't finished constructing the Proxy object,\n  // we can't call this.getWebsocket() to return the sender promise.\n  // Instead, we create a new promise that will eventually call\n  // getWebsocket and only resolve the promise after Proxy.call\n  // has completed.\n  var def = new Deferred();\n  Proxy.call(this, def.promise);\n  def.resolve(this.getWebSocket());\n}\n\nProxyConnection.prototype = Object.create(Proxy.prototype);\n\nProxyConnection.prototype.constructor = ProxyConnection;\n\n/**\n * Connects to the server and returns an open web socket connection\n * @return {promise} a promise that will be fulfilled with a websocket object\n * when the connection is established.\n */\nProxyConnection.prototype.getWebSocket = function() {\n  // We are either connecting or already connected, return the same promise\n  if (this.currentWebSocketPromise) {\n    return this.currentWebSocketPromise;\n  }\n\n  // TODO(bjornick): Implement a timeout mechanism.\n  var websocket = new WebSocket(this.url);\n  var self = this;\n  var deferred = new Deferred();\n  this.currentWebSocketPromise = deferred.promise;\n  websocket.onopen = function() {\n    vLog.info('Connected to proxy at', self.url);\n    deferred.resolve(websocket);\n  };\n  websocket.onerror = function(e) {\n    // TODO(jasoncampbell): there can be more errors than just faild\n    // connection, additionally there can be more than one error emited. We\n    // should take care to cover these cases.\n    vLog.error('Failed to connect to proxy at url:', self.url);\n\n    var isEvent = isBrowser && !!window.Event && e instanceof window.Event;\n    var isErrorEvent = isEvent && e.type === 'error';\n\n    // It's possible to get DOM Websocket error events into here\n    if (isErrorEvent) {\n      e = new Error('WebSocket error - ' + self.url);\n    }\n\n    deferred.reject(e);\n  };\n\n  websocket.onmessage = function(frame) {\n    var message;\n    try {\n      message = JSON.parse(frame.data);\n    } catch (e) {\n      vLog.warn('Failed to parse ' + frame.data);\n      return;\n    }\n\n    self.process(message);\n  };\n\n  return deferred.promise;\n};\n\nProxyConnection.prototype.close = function(cb) {\n  var proxy = this;\n  var deferred = new Deferred(cb);\n\n  proxy\n  .getWebSocket()\n  .then(close, function(err) {\n    // TODO(jasoncampbell): Better error handling around websocket connection\n    // It's possible that the initial connection failed with\n    // \"Error: getaddrinfo ENOTFOUND\" Since there was not a\n    // connection to begin with in this case it can be considered\n    // successfully closed.\n    deferred.resolve();\n  });\n\n  return deferred.promise;\n\n  function close(websocket) {\n    websocket.onclose = deferred.resolve;\n    websocket.close();\n  }\n};\n\n/**\n * Export the module\n */\nmodule.exports = ProxyConnection;\n","/**\n * @fileoverview Enum for outgoing message types\n */\n\nvar MessageType = {\n  REQUEST: 0, // Request to invoke a method on a Veyron name\n  SERVE: 1, // Request to serve a server in JavaScript under a Veyron name\n  RESPONSE: 2, // Indicates a response from a registered service in JavaScript\n  STREAM_VALUE: 3, // Indicates a stream value\n  STREAM_CLOSE: 4, // Request to close a stream\n  SIGNATURE: 5, // Request to get signature of a remote server\n  STOP: 6, // Request to stop a server\n  BLESS: 8, // Blesses an identity\n  UNLINK_ID: 9, // Unlinks an identity\n  NEW_ID: 10,  // Creates a new public id for javascript.  This is only used\n               // by tests.\n  LOOKUP_RESPONSE: 11, // Response from a lookup call to Javacript.\n  AUTHORIZATION_RESPONSE: 12, // Response from an authorization call to JS.\n  NAMESPACE_REQUEST: 13, // Request to call a method on the namespace client.\n  CANCEL: 17 // Cancel an ongoing JS initiated call.\n};\n\nmodule.exports = MessageType;\n","/**\n *  @fileoverview Client for the veyron service.\n *\n *  Usage:\n *  var cl = new client(proxyConnection);\n *  var service = cl.bindTo('EndpointAddress', 'ServiceName');\n *  resultPromise = service.MethodName(arg);\n */\n\nvar Promise = require('../lib/promise');\nvar Deferred = require('../lib/deferred');\nvar vLog = require('../lib/vlog');\nvar ErrorConversion = require('../proxy/error_conversion');\nvar Stream = require('../proxy/stream');\nvar vError = require('../lib/verror');\nvar MessageType = require('../proxy/message_type');\nvar IncomingPayloadType = require('../proxy/incoming_payload_type');\nvar context = require('../runtime/context');\nvar constants = require('./constants');\n\nvar OutstandingRPC = function(ctx, options, cb) {\n  this._ctx = ctx;\n  this._proxy = options.proxy;\n  this._id = -1;\n  this._name = options.name;\n  this._methodName = options.methodName,\n  this._args = options.args;\n  this._numOutParams = options.numOutParams;\n  this._isStreaming = options.isStreaming || false;\n  this._cb = cb;\n  this._def = null;\n};\n\nOutstandingRPC.prototype.start = function() {\n  this._id = this._proxy.nextId();\n  var def = new Deferred(this._cb);\n\n  var streamingDeferred = null;\n  if (this._isStreaming) {\n    streamingDeferred = new Deferred();\n    def.stream = new Stream(this._id, streamingDeferred.promise, true);\n    def.promise.stream = def.stream;\n  }\n\n  var message = this.constructMessage();\n\n  this._def = def;\n  this._proxy.cancelFromContext(this._ctx, this._id);\n  this._proxy.sendRequest(message, MessageType.REQUEST, this, this._id);\n  if (streamingDeferred) {\n    this._proxy.senderPromise.then(function(ws) {\n      streamingDeferred.resolve(ws);\n    }, function(err) {\n      streamingDeferred.reject(err);\n    });\n  }\n\n  return def.promise;\n};\n\nOutstandingRPC.prototype.handleResponse = function(type, data) {\n  switch (type) {\n    case IncomingPayloadType.FINAL_RESPONSE:\n      this.handleCompletion(data);\n      break;\n    case IncomingPayloadType.STREAM_RESPONSE:\n      this.handleStreamData(data);\n      break;\n    case IncomingPayloadType.ERROR_RESPONSE:\n      this.handleError(data);\n      break;\n    case IncomingPayloadType.STREAM_CLOSE:\n      this.handleStreamClose();\n      break;\n    default:\n      this.handleError(\n          new vError.InternalError('Recieved unknown response type from wspr'));\n      break;\n  }\n};\n\nOutstandingRPC.prototype.handleCompletion = function(data) {\n  if (data.length === 1) {\n    data = data[0];\n  }\n  this._def.resolve(data);\n  if (this._def.stream) {\n    this._def.stream._queueRead(null);\n  }\n  this._proxy.dequeue(this._id);\n};\n\nOutstandingRPC.prototype.handleStreamData = function(data) {\n  if (this._def.stream) {\n    this._def.stream._queueRead(data);\n  } else {\n    vLog.warn('Ignoring streaming message for non-streaming flow : ' +\n        this._id);\n  }\n};\n\nOutstandingRPC.prototype.handleStreamClose = function() {\n  if (this._def.stream) {\n    this._def.stream._queueRead(null);\n  }\n};\n\nOutstandingRPC.prototype.handleError = function(data) {\n  var err;\n  if (data instanceof Error) {\n    err = data;\n  } else {\n    err = ErrorConversion.toJSerror(data);\n  }\n\n  if (this._def.stream) {\n    this._def.stream.emit('error', err);\n    this._def.stream.queueRead(null);\n  }\n  this._def.reject(err);\n  this._proxy.dequeue(this._id);\n};\n\n\n/**\n * Construct a message to send to the veyron native code\n * @return {string} json string to send to jspr\n */\nOutstandingRPC.prototype.constructMessage = function() {\n  var deadline = this._ctx.deadline();\n  var timeout = constants.NO_TIMEOUT;\n  if (deadline !== null) {\n    timeout = deadline - Date.now();\n  }\n\n  var jsonMessage = {\n    name: this._name,\n    method: this._methodName,\n    inArgs: this._args || [],\n    numOutArgs: this._numOutParams || 1,\n    isStreaming: this._isStreaming,\n    timeout: timeout\n  };\n  return JSON.stringify(jsonMessage);\n};\n\n/**\n * Client for the veyron service.\n * @constructor\n * @param {Object} proxyConnection Veyron proxy client\n */\nfunction Client(proxyConnection) {\n  if (!(this instanceof Client)) {\n    return new Client(proxyConnection);\n  }\n\n  this._proxyConnection = proxyConnection;\n}\n\n/**\n * Performs client side binding of a remote service to a native javascript\n * stub object.\n * @param {Context} A context.\n * @param {string} name the veyron name of the service to bind to.\n * @param {object} optServiceSignature if set, javascript signature of methods\n * available in the remote service.\n * @param {function} [cb] if given, this function will be called on\n * completion of the bind.  The first argument will be an error if there is\n * one, and the second argument is an object with methods that perform rpcs to\n * service\n * methods.\n * @return {Promise} An object with methods that perform rpcs to service methods\n */\nClient.prototype.bindTo = function(ctx, name, optServiceSignature, cb) {\n  cb = context.optionalContext(arguments);\n  var self = this;\n\n  if (typeof cb !== 'function') {\n    optServiceSignature = cb;\n    cb = undefined;\n  }\n  if (typeof optServiceSignature === 'function') {\n    cb = optServiceSignature;\n    optServiceSignature = undefined;\n  }\n\n  var def = new Deferred(cb);\n  var serviceSignaturePromise;\n\n  if (optServiceSignature !== undefined) {\n    serviceSignaturePromise = Promise.resolve(optServiceSignature);\n  } else {\n    vLog.debug('Requesting service signature for:', name);\n    var proxy = self._proxyConnection;\n    serviceSignaturePromise = proxy.getServiceSignature(ctx, name);\n  }\n\n  var promise = def.promise;\n\n  serviceSignaturePromise.then(function(serviceSignature) {\n    vLog.debug('Received signature for:', name, serviceSignature);\n    var boundObject = {};\n\n    var bindMethod = function(methodName) {\n      var methodInfo = serviceSignature[methodName];\n      var numOutParams = methodInfo.numOutArgs;\n\n      boundObject[methodName] = function() {\n        var callback;\n        var ctx;\n        var first = 0;\n        var last = arguments.length - 1;\n        if (last >= 0) {\n          // The first argument is an optional context\n          // TODO(mattr): The context will become non-optional at some point.\n          // The last argument is an optional callback\n          if (arguments[first] instanceof context.Context) {\n            first++;\n            ctx = arguments[0];\n          }\n          if (typeof arguments[last] === 'function') {\n            callback = arguments[last];\n            last--;\n          }\n        }\n        var args = Array.prototype.slice.call(arguments, first, last + 1);\n\n        // TODO(mattr): For now, if the context isn't specified we\n        // make one up here with a fake runtime.  In the future the\n        // context will be required and we can eliminate this hack.\n        if (!ctx) {\n          ctx = new context.Context({});\n        }\n\n        // TODO(jasoncampbell): This should probably be a more meaningful\n        // error with its own constructor so that it can be checked in a\n        // programatic way:\n        //\n        //     service\n        //     .foo('bar')\n        //     .catch(ArgumentsArityError, function(err) {\n        //       console.error('invalid number of arguments')\n        //     })\n        //\n        var expected = methodInfo.inArgs.length;\n        var actual = args.length;\n\n        if (actual !== expected) {\n          var message = [\n            'Invalid number of arguments to',\n            '\"' + methodName + '\".',\n            'Expected',\n            expected,\n            'but there were',\n            actual + '.'\n          ].join(' ');\n\n          var deferred = new Deferred(callback);\n          var error = new Error(message);\n\n          deferred.reject(error);\n\n          return deferred.promise;\n        }\n\n        var rpc = new OutstandingRPC(ctx, {\n           proxy: self._proxyConnection,\n           name: name,\n           methodName: methodName,\n           args: args,\n           numOutParams: numOutParams,\n           isStreaming: methodInfo.isStreaming\n        }, callback);\n\n        return rpc.start();\n      };\n    };\n\n    for (var methodName in serviceSignature) {\n      if (serviceSignature.hasOwnProperty(methodName)) {\n        bindMethod(methodName);\n      }\n    }\n\n    //Also stub out signature() on the bound object.\n    boundObject.signature = function(callback) {\n      var deferred = new Deferred(callback);\n\n      deferred.resolve(serviceSignature);\n\n      return deferred.promise;\n    };\n\n    def.resolve(boundObject);\n  }).catch (def.reject);\n\n  return promise;\n};\n\n/**\n * Export the module\n */\nmodule.exports = Client;\n","var Deferred = require('../lib/deferred');\nvar MessageType = require('../proxy/message_type');\nvar Stream = require('../proxy/stream');\nvar StreamHandler = require('../proxy/stream_handler');\nvar SimpleHandler = require('../proxy/simple_handler');\n\nmodule.exports = Namespace;\n/**\n * Create a new Namespace.\n * @param {Proxy} Proxy instance.\n * @param {string[]} Optional root names.\n * @constructor\n */\nfunction Namespace(proxy, roots) {\n    this._proxy = proxy;\n    this._roots = roots;\n}\n\nvar NamespaceMethods = {\n    GLOB: 0,\n    MOUNT: 1,\n    UNMOUNT: 2,\n    RESOLVE: 3\n};\n\n/**\n * Glob streams all names matching pattern. If recursive is true, it also\n * returns all names below the matching ones.\n * @param {string} pattern Glob pattern to match\n * @param {function} cb(err, stream) Optional callback\n * @return {Promise} A promise with an stream object hanging from it.\n */\nNamespace.prototype.glob = function(pattern, cb) {\n  var args = {\n    pattern: pattern\n  };\n\n  return this._sendStreamingRequest(NamespaceMethods.GLOB, args, cb);\n};\n\n/*\n * Mount the server object address under the object name, expiring after\n * @param {string} name Object name\n * @param {string} server Server object address\n * @param {integer} ttl Expiry time for the mount in milliseconds. ttl of zero\n * implies never expire.\n * @param {boolean} Optional replaceMount Whether the previous mount should\n * be replaced by the new server object address. False by default.\n * @param {function} cb(err) Optional callback\n * @return {Promise} A promise to be resolved when mount is complete or rejected\n * when mount has an error\n */\nNamespace.prototype.mount = function(name, server, ttl, replaceMount, cb) {\n  ttl = ttl || 0; // Default is 0\n  replaceMount = !!replaceMount; // Cast to bool\n  var args = {\n    name: name,\n    server: server,\n    ttl: ttl * 1000, // Go API uses nanoseconds, we use milliseconds in JS\n    replaceMount: replaceMount\n  };\n\n  return this._sendRequest(NamespaceMethods.MOUNT, args, cb);\n};\n\n/*\n * Unmount the server object address from the object name, or if server is empty\n * unmount all server object address from the object name.\n * @param {string} name Object name\n * @param {string} server Server object address\n * @param {function} cb(err) Optional callback\n * @return {Promise} A promise to be resolved when unmount is complete or\n * rejected when mount has an error\n */\nNamespace.prototype.unmount = function(name, server, cb) {\n  server = server || '';\n  var args = {\n    name: name,\n    server: server\n  };\n\n  return this._sendRequest(NamespaceMethods.UNMOUNT, args, cb);\n};\n\n/*\n * Resolve the object name into its mounted servers.\n * @param {string} name Object name\n * @param {function} cb(err, servers[]) Optional callback\n * @return {Promise} A promise to be resolved an string array of server object\n * addresses or rejected when mount has an error\n */\nNamespace.prototype.resolve = function(name, cb) {\n  var args = {\n    name: name\n  };\n\n  return this._sendRequest(NamespaceMethods.RESOLVE, args, cb);\n};\n\n/**\n * Sets the roots that the local Namespace is relative to.\n * All relative names passed to the methods above will be interpreted as\n * relative to these roots.\n * The roots will be tried in the order that they are specified in the parameter\n * list for setRoots.\n * @param {Array | varargs} roots object names for the roots\n */\nNamespace.prototype.setRoots = function(roots) {\n  if (!Array.isArray(roots)) {\n    roots = Array.prototype.slice.call(arguments);\n  }\n  this._roots = roots;\n};\n\nNamespace.prototype._sendRequest = function(method, args, cb) {\n  var def = new Deferred(cb);\n  var id = this._proxy.nextId();\n  var handler = new SimpleHandler(def, this._proxy, id);\n  var message = this._createMessage(method, args);\n  this._proxy.sendRequest(message, MessageType.NAMESPACE_REQUEST, handler, id);\n  return def.promise;\n};\n\nNamespace.prototype._sendStreamingRequest = function(method, args, cb) {\n  var def = new Deferred(cb);\n  var id = this._proxy.nextId();\n  def.stream = new Stream(id, this._proxy.senderPromise, true);\n  var handler = new StreamHandler(def.stream);\n  var message = this._createMessage(method, args);\n  this._proxy.sendRequest(message, MessageType.NAMESPACE_REQUEST, null, id);\n  this._proxy.addIncomingStreamHandler(id, handler);\n\n  def.promise.stream = def.stream;\n  return def.promise;\n};\n\nNamespace.prototype._createMessage = function(method, args) {\n  var messageObject = {\n    method: method,\n    args: args || null,\n    roots: this._roots || []\n  };\n\n  return JSON.stringify(messageObject);\n};","/**\n * @fileoverview PrivateId stub for veyron identities\n */\n\nvar Deferred = require('../lib/deferred');\nvar SimpleHandler = require('../proxy/simple_handler');\nvar PublicId = require('./public');\nvar MessageType = require('../proxy/message_type');\n\n/**\n * The private portion of a veyron identity\n */\nfunction PrivateId(proxy) {\n  this._proxy = proxy;\n}\n\n/*\n * Blesses the given PublicId with the given caveats.\n * @param {PublicId} blessee the PublicId to bless.\n * @param {String} name the name the bless the id under.\n * @param {Number} duration the duration of the blessing in milliseconds.\n * @param {Array} caveats an array of ServiceCavaeats.\n * @papram {function} cb an optional callback that will return the blessing\n * @return {Promise} a promise that will be resolved with the blessing\n */\n\nPrivateId.prototype.bless = function(blessee, name, duration, caveats, cb) {\n  var def = new Deferred(cb);\n  if (!(blessee instanceof PublicId)) {\n    def.reject(new Error('blessee should be of type PublicId'));\n    return def.promise;\n  }\n\n  var message = JSON.stringify({\n    handle: blessee._id,\n    name: name,\n    durationMs: duration,\n    caveats: caveats\n  });\n  var id = this._proxy.nextId();\n  var handler = new SimpleHandler(def, this._proxy, id);\n  this._proxy.sendRequest(message, MessageType.BLESS, handler, id);\n  var self = this._proxy;\n  return def.promise.then(function(message) {\n    var id = new PublicId(message.names, message.handle, message.publicKey,\n                          self._proxy);\n    return id;\n  });\n};\n\nmodule.exports = PrivateId;\n","/**\n * @fileoverview PublicId stub of veyron identities\n */\n\nvar MessageType = require('../proxy/message_type');\nvar blessingMatches = require('./blessing_matching');\n\n/**\n * The public portion of a veyron identity.\n */\nfunction PublicId(names, id, key, proxy) {\n  this.names = names;\n  this._id = id;\n  this._count = 1;\n  this._proxy = proxy;\n  this._key = key;\n}\n\n/**\n * Returns whether the PublicId matches a principal pattern. There\n * are basically two types of patterns.  A fixed name pattern\n * looks like 'a/b' and matches names 'a/b' and 'a', but not\n * 'a/b/c', 'aa', or 'a/bb'. 'a' is considered a match because\n * the owner of 'a' can trivially create the name 'a/b'.  A star\n * pattern looks like 'a/b/*' and it matches anything that 'a/b' matches\n * as well as any name blessed by 'a/b', i.e 'a/b/c', 'a/b/c/d'.\n * @param {string} pattern The pattern to match against.\n * @return {boolean} Returns true iff the PublicId has a name that matches\n * the pattern passed in.\n */\nPublicId.prototype.match = function(pattern) {\n  if (pattern === '' || !pattern) {\n    return false;\n  }\n  for (var i = 0; i < this.names.length; i++) {\n    if (blessingMatches(this.names[i], pattern)) {\n      return true;\n    }\n  }\n  return false;\n};\n\n/**\n * Increments the reference count on the PublicId.  When the reference count\n * goes to zero, the PublicId will be removed from the cache in the go code.\n */\nPublicId.prototype.retain = function() {\n  this._count++;\n};\n\n/**\n * Decrements the reference count on the PublicId.  When the reference count\n * goes to zero, the PublicId will be removed from the cache in the go code.\n */\nPublicId.prototype.release = function() {\n  this._count--;\n  if (this._count === 0) {\n    var message = JSON.stringify(this._id);\n    this._proxy.sendRequest(message, MessageType.UNLINK_ID, null,\n        this._proxy.nextId());\n  }\n};\n\nPublicId.prototype.toJSON = function() {\n  return {\n    id: this._id,\n    names: this.names,\n    key: this._key\n  };\n};\n\nmodule.exports = PublicId;\n","/**\n * @fileoverview A simple handler that resolves or rejects a promise\n * on a response from the proxy.\n */\nvar IncomingPayloadType = require('./incoming_payload_type');\nvar ErrorConversion = require('./error_conversion');\nvar vError = require('./../lib/verror');\n\n/**\n * An object that rejects/resolves a promise based on a response\n * from the proxy.\n * @constructor\n * @param def the promise to resolve/reject\n * @param proxy the proxy from which to dequeue the handler\n * @param id the flow id of the message\n */\nvar Handler = function(def, proxy, id) {\n  this._proxy = proxy;\n  this._def = def;\n  this._id = id;\n};\n\nHandler.prototype.handleResponse = function(type, message) {\n  switch (type) {\n    case IncomingPayloadType.FINAL_RESPONSE:\n      this._def.resolve(message);\n      break;\n    case IncomingPayloadType.ERROR_RESPONSE:\n      var err = message;\n      if (!(err instanceof Error)) {\n\t      err = ErrorConversion.toJSerror(message);\n      }\n      this._def.reject(err);\n      break;\n    default:\n      this._def.reject(\n          new vError.InternalError('unknown response type ' + type));\n  }\n  this._proxy.dequeue(this._id);\n};\n\nmodule.exports = Handler;\n","/**\n * @fileoverview Parses the Veyron IDL\n */\n\nvar vError = require('../lib/verror');\nvar idlHelper = {};\n\n/**\n * Generates an IDL wire description for a given service by iterating over the\n * methods in the service object.\n * Method names beginning with '_' are considered private and skipped.\n * Arg names beginning with '$' are not part of the idl and are filled in by\n * the veyron libraries (e.g. $context).\n * @param {object} service a description of the service. This is a map from\n * method name to method description.\n * @return {object} a representation of the idl. This must match the format of\n * JSONServiceSignature in Veyron's go code.\n */\nidlHelper.generateIdlWireDescription = function(service) {\n  var idlWire = {};\n  var metadata = service.metadata;\n  for (var methodName in metadata) {\n    if (metadata.hasOwnProperty(methodName)) {\n      var methodMetadata = metadata[methodName];\n\n      var params = methodMetadata.params;\n      var inArgs = [];\n      for (var i = 0; i < params.length; i++) {\n        var param = params[i];\n        if (param[0] !== '$') {\n          inArgs.push(param);\n        }\n      }\n\n      idlWire[methodName] = {\n        InArgs: inArgs,\n        NumOutArgs: methodMetadata.numOutArgs + 1,\n        IsStreaming: methodMetadata.injections['$stream'] !== undefined\n      };\n    }\n  }\n\n  return idlWire;\n};\n\n/**\n * Returns an array of parameter names for a function.\n * from go/fypon (stack overflow) and based on angularjs's implementation\n * @param {function} func the function object\n * @return {string[]} list of the parameters\n */\nvar getParamNames = function(func) {\n  // represent the function as a string and strip comments\n  var fnStr = func.toString().replace(/((\\/\\/.*$)|(\\/\\*[\\s\\S]*?\\*\\/))/mg, '');\n  // get the arguments from the string\n  var result = fnStr.slice(fnStr.indexOf('(') + 1, fnStr.indexOf(')')).\n      match(/([^\\s,]+)/g);\n  if (result === null) {\n    result = [];\n  }\n  return result;\n};\n\n/**\n * Wraps a Service with annotations for each exported function.\n * @constructor\n * @param {object} service the service that is being exported.\n * @param {object} extraMetadata if provided, adds extra metadata for\n * the functions exported (such as number of return values).\n */\nidlHelper.ServiceWrapper = function(service, extraMetadata) {\n  this.object = service;\n  this.metadata = {};\n  extraMetadata = extraMetadata || {};\n\n  for (var methodName in service) {\n    if (methodName.length > 0 && methodName[0] !== '_') {\n      if (methodName[0] >= 'A' && methodName[0] <= 'Z') {\n        var camelCaseName = methodName.charAt(0).toLowerCase() +\n          methodName.slice(1);\n        throw new Error('Method names must be camel case. Perhaps rename \\'' +\n          methodName + '\\' to \\'' + camelCaseName + '\\'');\n      }\n      var method = service[methodName];\n      if (typeof method === 'function') {\n        var params = getParamNames(method);\n        var injections = {};\n        for (var i = 0; i < params.length; i++) {\n          var name = params[i];\n          if (name[0] === '$') {\n            injections[name] = i;\n          }\n        }\n        var metadata = {\n          params: params,\n          injections: injections,\n          numOutArgs: 1\n        };\n\n        // We only want to copy over the accepted metadata options.\n        if (extraMetadata[methodName]) {\n          var extra = extraMetadata[methodName];\n          if (extra.numOutArgs !== undefined) {\n            metadata.numOutArgs = extra.numOutArgs;\n          }\n\n          metadata.label = extra.label;\n        }\n\n        this.metadata[methodName] = metadata;\n      }\n    }\n  }\n};\n\nidlHelper.ServiceWrapper.prototype.validate = function(definition) {\n  for (var name in definition) {\n    if (definition.hasOwnProperty(name)) {\n      var metadata = this.metadata[name];\n      if (!metadata) {\n        return new vError.BadArgError('Missing method: ' + name);\n      }\n      var expected = definition[name];\n      var inputArgs = metadata.params.length -\n          Object.keys(metadata.injections).length;\n      if (inputArgs !== expected.numInArgs) {\n        return new vError.BadArgError('Wrong number of input args for ' +\n            name + ', got: ' + inputArgs + ', expected: ' +\n            expected.numInArgs);\n      }\n\n      if (metadata.numOutArgs !== expected.numOutArgs) {\n        return new vError.BadArgError('Wrong number of output args for ' +\n            name + ', got: ' + metadata.numOutArgs + ', expected ' +\n            expected.numOutArgs);\n      }\n\n      var hasStreaming = metadata.injections.hasOwnProperty('$stream');\n      var expectingStreaming = (expected.inputStreaming ||\n          expected.outputStreaming);\n      if (expectingStreaming && !hasStreaming) {\n        return new vError.BadArgError('Expected ' + name + ' to be ' +\n              'streaming');\n      } else if (!expectingStreaming && hasStreaming) {\n        return new vError.BadArgError('Expected ' + name + ' to not be ' +\n              'streaming');\n\n      }\n    }\n  }\n\n  for (name in this.metadata) {\n    if (this.metadata.hasOwnProperty(name) &&\n        !definition.hasOwnProperty(name)) {\n      return new vError.BadArgError('Unexpected method ' + name +\n          ' implemented.');\n    }\n  }\n  return null;\n};\n\nidlHelper.ServiceWrapper.prototype.labelForMethod = function(method) {\n  if (!this.metadata.hasOwnProperty(method)) {\n    return 0;\n  }\n  return this.metadata[method].label || 0;\n};\n\n/**\n * Export the module\n */\nmodule.exports = idlHelper;\n","/**\n * @fileoverview blessing pattern matcher\n */\nmodule.exports = blessingMatches;\n\n// A blessing matches if it is a prefix of the pattern or if the pattern ends\n// in a '/...' and the pattern is a prefix of the blessing.\nfunction blessingMatches(blessing, pattern) {\n  var paths = blessing.split('/');\n  var expectedPaths = pattern.split('/');\n  for (var i = 0; i < expectedPaths.length; i++) {\n    // If there is a '...' at the end of the pattern then\n    // we have a match, since the prefix of the pattern\n    // was matched by the blessing.\n    if (expectedPaths[i] === '...') {\n      return i === expectedPaths.length - 1;\n    }\n\n    // name is a prefix of pattern\n    if (i === paths.length) {\n      return true;\n    }\n\n    if (paths[i] !== expectedPaths[i]) {\n      return false;\n    }\n  }\n\n  return paths.length === expectedPaths.length;\n}\n\n","// Copyright Joyent, Inc. and other Node contributors.\n//\n// Permission is hereby granted, free of charge, to any person obtaining a\n// copy of this software and associated documentation files (the\n// \"Software\"), to deal in the Software without restriction, including\n// without limitation the rights to use, copy, modify, merge, publish,\n// distribute, sublicense, and/or sell copies of the Software, and to permit\n// persons to whom the Software is furnished to do so, subject to the\n// following conditions:\n//\n// The above copyright notice and this permission notice shall be included\n// in all copies or substantial portions of the Software.\n//\n// THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS\n// OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF\n// MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN\n// NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM,\n// DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR\n// OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE\n// USE OR OTHER DEALINGS IN THE SOFTWARE.\n\nvar formatRegExp = /%[sdj%]/g;\nexports.format = function(f) {\n  if (!isString(f)) {\n    var objects = [];\n    for (var i = 0; i < arguments.length; i++) {\n      objects.push(inspect(arguments[i]));\n    }\n    return objects.join(' ');\n  }\n\n  var i = 1;\n  var args = arguments;\n  var len = args.length;\n  var str = String(f).replace(formatRegExp, function(x) {\n    if (x === '%%') return '%';\n    if (i >= len) return x;\n    switch (x) {\n      case '%s': return String(args[i++]);\n      case '%d': return Number(args[i++]);\n      case '%j':\n        try {\n          return JSON.stringify(args[i++]);\n        } catch (_) {\n          return '[Circular]';\n        }\n      default:\n        return x;\n    }\n  });\n  for (var x = args[i]; i < len; x = args[++i]) {\n    if (isNull(x) || !isObject(x)) {\n      str += ' ' + x;\n    } else {\n      str += ' ' + inspect(x);\n    }\n  }\n  return str;\n};\n\n\n// Mark that a method should not be used.\n// Returns a modified function which warns once by default.\n// If --no-deprecation is set, then it is a no-op.\nexports.deprecate = function(fn, msg) {\n  // Allow for deprecating things in the process of starting up.\n  if (isUndefined(global.process)) {\n    return function() {\n      return exports.deprecate(fn, msg).apply(this, arguments);\n    };\n  }\n\n  if (process.noDeprecation === true) {\n    return fn;\n  }\n\n  var warned = false;\n  function deprecated() {\n    if (!warned) {\n      if (process.throwDeprecation) {\n        throw new Error(msg);\n      } else if (process.traceDeprecation) {\n        console.trace(msg);\n      } else {\n        console.error(msg);\n      }\n      warned = true;\n    }\n    return fn.apply(this, arguments);\n  }\n\n  return deprecated;\n};\n\n\nvar debugs = {};\nvar debugEnviron;\nexports.debuglog = function(set) {\n  if (isUndefined(debugEnviron))\n    debugEnviron = process.env.NODE_DEBUG || '';\n  set = set.toUpperCase();\n  if (!debugs[set]) {\n    if (new RegExp('\\\\b' + set + '\\\\b', 'i').test(debugEnviron)) {\n      var pid = process.pid;\n      debugs[set] = function() {\n        var msg = exports.format.apply(exports, arguments);\n        console.error('%s %d: %s', set, pid, msg);\n      };\n    } else {\n      debugs[set] = function() {};\n    }\n  }\n  return debugs[set];\n};\n\n\n/**\n * Echos the value of a value. Trys to print the value out\n * in the best way possible given the different types.\n *\n * @param {Object} obj The object to print out.\n * @param {Object} opts Optional options object that alters the output.\n */\n/* legacy: obj, showHidden, depth, colors*/\nfunction inspect(obj, opts) {\n  // default options\n  var ctx = {\n    seen: [],\n    stylize: stylizeNoColor\n  };\n  // legacy...\n  if (arguments.length >= 3) ctx.depth = arguments[2];\n  if (arguments.length >= 4) ctx.colors = arguments[3];\n  if (isBoolean(opts)) {\n    // legacy...\n    ctx.showHidden = opts;\n  } else if (opts) {\n    // got an \"options\" object\n    exports._extend(ctx, opts);\n  }\n  // set default options\n  if (isUndefined(ctx.showHidden)) ctx.showHidden = false;\n  if (isUndefined(ctx.depth)) ctx.depth = 2;\n  if (isUndefined(ctx.colors)) ctx.colors = false;\n  if (isUndefined(ctx.customInspect)) ctx.customInspect = true;\n  if (ctx.colors) ctx.stylize = stylizeWithColor;\n  return formatValue(ctx, obj, ctx.depth);\n}\nexports.inspect = inspect;\n\n\n// http://en.wikipedia.org/wiki/ANSI_escape_code#graphics\ninspect.colors = {\n  'bold' : [1, 22],\n  'italic' : [3, 23],\n  'underline' : [4, 24],\n  'inverse' : [7, 27],\n  'white' : [37, 39],\n  'grey' : [90, 39],\n  'black' : [30, 39],\n  'blue' : [34, 39],\n  'cyan' : [36, 39],\n  'green' : [32, 39],\n  'magenta' : [35, 39],\n  'red' : [31, 39],\n  'yellow' : [33, 39]\n};\n\n// Don't use 'blue' not visible on cmd.exe\ninspect.styles = {\n  'special': 'cyan',\n  'number': 'yellow',\n  'boolean': 'yellow',\n  'undefined': 'grey',\n  'null': 'bold',\n  'string': 'green',\n  'date': 'magenta',\n  // \"name\": intentionally not styling\n  'regexp': 'red'\n};\n\n\nfunction stylizeWithColor(str, styleType) {\n  var style = inspect.styles[styleType];\n\n  if (style) {\n    return '\\u001b[' + inspect.colors[style][0] + 'm' + str +\n           '\\u001b[' + inspect.colors[style][1] + 'm';\n  } else {\n    return str;\n  }\n}\n\n\nfunction stylizeNoColor(str, styleType) {\n  return str;\n}\n\n\nfunction arrayToHash(array) {\n  var hash = {};\n\n  array.forEach(function(val, idx) {\n    hash[val] = true;\n  });\n\n  return hash;\n}\n\n\nfunction formatValue(ctx, value, recurseTimes) {\n  // Provide a hook for user-specified inspect functions.\n  // Check that value is an object with an inspect function on it\n  if (ctx.customInspect &&\n      value &&\n      isFunction(value.inspect) &&\n      // Filter out the util module, it's inspect function is special\n      value.inspect !== exports.inspect &&\n      // Also filter out any prototype objects using the circular check.\n      !(value.constructor && value.constructor.prototype === value)) {\n    var ret = value.inspect(recurseTimes, ctx);\n    if (!isString(ret)) {\n      ret = formatValue(ctx, ret, recurseTimes);\n    }\n    return ret;\n  }\n\n  // Primitive types cannot have properties\n  var primitive = formatPrimitive(ctx, value);\n  if (primitive) {\n    return primitive;\n  }\n\n  // Look up the keys of the object.\n  var keys = Object.keys(value);\n  var visibleKeys = arrayToHash(keys);\n\n  if (ctx.showHidden) {\n    keys = Object.getOwnPropertyNames(value);\n  }\n\n  // IE doesn't make error fields non-enumerable\n  // http://msdn.microsoft.com/en-us/library/ie/dww52sbt(v=vs.94).aspx\n  if (isError(value)\n      && (keys.indexOf('message') >= 0 || keys.indexOf('description') >= 0)) {\n    return formatError(value);\n  }\n\n  // Some type of object without properties can be shortcutted.\n  if (keys.length === 0) {\n    if (isFunction(value)) {\n      var name = value.name ? ': ' + value.name : '';\n      return ctx.stylize('[Function' + name + ']', 'special');\n    }\n    if (isRegExp(value)) {\n      return ctx.stylize(RegExp.prototype.toString.call(value), 'regexp');\n    }\n    if (isDate(value)) {\n      return ctx.stylize(Date.prototype.toString.call(value), 'date');\n    }\n    if (isError(value)) {\n      return formatError(value);\n    }\n  }\n\n  var base = '', array = false, braces = ['{', '}'];\n\n  // Make Array say that they are Array\n  if (isArray(value)) {\n    array = true;\n    braces = ['[', ']'];\n  }\n\n  // Make functions say that they are functions\n  if (isFunction(value)) {\n    var n = value.name ? ': ' + value.name : '';\n    base = ' [Function' + n + ']';\n  }\n\n  // Make RegExps say that they are RegExps\n  if (isRegExp(value)) {\n    base = ' ' + RegExp.prototype.toString.call(value);\n  }\n\n  // Make dates with properties first say the date\n  if (isDate(value)) {\n    base = ' ' + Date.prototype.toUTCString.call(value);\n  }\n\n  // Make error with message first say the error\n  if (isError(value)) {\n    base = ' ' + formatError(value);\n  }\n\n  if (keys.length === 0 && (!array || value.length == 0)) {\n    return braces[0] + base + braces[1];\n  }\n\n  if (recurseTimes < 0) {\n    if (isRegExp(value)) {\n      return ctx.stylize(RegExp.prototype.toString.call(value), 'regexp');\n    } else {\n      return ctx.stylize('[Object]', 'special');\n    }\n  }\n\n  ctx.seen.push(value);\n\n  var output;\n  if (array) {\n    output = formatArray(ctx, value, recurseTimes, visibleKeys, keys);\n  } else {\n    output = keys.map(function(key) {\n      return formatProperty(ctx, value, recurseTimes, visibleKeys, key, array);\n    });\n  }\n\n  ctx.seen.pop();\n\n  return reduceToSingleString(output, base, braces);\n}\n\n\nfunction formatPrimitive(ctx, value) {\n  if (isUndefined(value))\n    return ctx.stylize('undefined', 'undefined');\n  if (isString(value)) {\n    var simple = '\\'' + JSON.stringify(value).replace(/^\"|\"$/g, '')\n                                             .replace(/'/g, \"\\\\'\")\n                                             .replace(/\\\\\"/g, '\"') + '\\'';\n    return ctx.stylize(simple, 'string');\n  }\n  if (isNumber(value))\n    return ctx.stylize('' + value, 'number');\n  if (isBoolean(value))\n    return ctx.stylize('' + value, 'boolean');\n  // For some reason typeof null is \"object\", so special case here.\n  if (isNull(value))\n    return ctx.stylize('null', 'null');\n}\n\n\nfunction formatError(value) {\n  return '[' + Error.prototype.toString.call(value) + ']';\n}\n\n\nfunction formatArray(ctx, value, recurseTimes, visibleKeys, keys) {\n  var output = [];\n  for (var i = 0, l = value.length; i < l; ++i) {\n    if (hasOwnProperty(value, String(i))) {\n      output.push(formatProperty(ctx, value, recurseTimes, visibleKeys,\n          String(i), true));\n    } else {\n      output.push('');\n    }\n  }\n  keys.forEach(function(key) {\n    if (!key.match(/^\\d+$/)) {\n      output.push(formatProperty(ctx, value, recurseTimes, visibleKeys,\n          key, true));\n    }\n  });\n  return output;\n}\n\n\nfunction formatProperty(ctx, value, recurseTimes, visibleKeys, key, array) {\n  var name, str, desc;\n  desc = Object.getOwnPropertyDescriptor(value, key) || { value: value[key] };\n  if (desc.get) {\n    if (desc.set) {\n      str = ctx.stylize('[Getter/Setter]', 'special');\n    } else {\n      str = ctx.stylize('[Getter]', 'special');\n    }\n  } else {\n    if (desc.set) {\n      str = ctx.stylize('[Setter]', 'special');\n    }\n  }\n  if (!hasOwnProperty(visibleKeys, key)) {\n    name = '[' + key + ']';\n  }\n  if (!str) {\n    if (ctx.seen.indexOf(desc.value) < 0) {\n      if (isNull(recurseTimes)) {\n        str = formatValue(ctx, desc.value, null);\n      } else {\n        str = formatValue(ctx, desc.value, recurseTimes - 1);\n      }\n      if (str.indexOf('\\n') > -1) {\n        if (array) {\n          str = str.split('\\n').map(function(line) {\n            return '  ' + line;\n          }).join('\\n').substr(2);\n        } else {\n          str = '\\n' + str.split('\\n').map(function(line) {\n            return '   ' + line;\n          }).join('\\n');\n        }\n      }\n    } else {\n      str = ctx.stylize('[Circular]', 'special');\n    }\n  }\n  if (isUndefined(name)) {\n    if (array && key.match(/^\\d+$/)) {\n      return str;\n    }\n    name = JSON.stringify('' + key);\n    if (name.match(/^\"([a-zA-Z_][a-zA-Z_0-9]*)\"$/)) {\n      name = name.substr(1, name.length - 2);\n      name = ctx.stylize(name, 'name');\n    } else {\n      name = name.replace(/'/g, \"\\\\'\")\n                 .replace(/\\\\\"/g, '\"')\n                 .replace(/(^\"|\"$)/g, \"'\");\n      name = ctx.stylize(name, 'string');\n    }\n  }\n\n  return name + ': ' + str;\n}\n\n\nfunction reduceToSingleString(output, base, braces) {\n  var numLinesEst = 0;\n  var length = output.reduce(function(prev, cur) {\n    numLinesEst++;\n    if (cur.indexOf('\\n') >= 0) numLinesEst++;\n    return prev + cur.replace(/\\u001b\\[\\d\\d?m/g, '').length + 1;\n  }, 0);\n\n  if (length > 60) {\n    return braces[0] +\n           (base === '' ? '' : base + '\\n ') +\n           ' ' +\n           output.join(',\\n  ') +\n           ' ' +\n           braces[1];\n  }\n\n  return braces[0] + base + ' ' + output.join(', ') + ' ' + braces[1];\n}\n\n\n// NOTE: These type checking functions intentionally don't use `instanceof`\n// because it is fragile and can be easily faked with `Object.create()`.\nfunction isArray(ar) {\n  return Array.isArray(ar);\n}\nexports.isArray = isArray;\n\nfunction isBoolean(arg) {\n  return typeof arg === 'boolean';\n}\nexports.isBoolean = isBoolean;\n\nfunction isNull(arg) {\n  return arg === null;\n}\nexports.isNull = isNull;\n\nfunction isNullOrUndefined(arg) {\n  return arg == null;\n}\nexports.isNullOrUndefined = isNullOrUndefined;\n\nfunction isNumber(arg) {\n  return typeof arg === 'number';\n}\nexports.isNumber = isNumber;\n\nfunction isString(arg) {\n  return typeof arg === 'string';\n}\nexports.isString = isString;\n\nfunction isSymbol(arg) {\n  return typeof arg === 'symbol';\n}\nexports.isSymbol = isSymbol;\n\nfunction isUndefined(arg) {\n  return arg === void 0;\n}\nexports.isUndefined = isUndefined;\n\nfunction isRegExp(re) {\n  return isObject(re) && objectToString(re) === '[object RegExp]';\n}\nexports.isRegExp = isRegExp;\n\nfunction isObject(arg) {\n  return typeof arg === 'object' && arg !== null;\n}\nexports.isObject = isObject;\n\nfunction isDate(d) {\n  return isObject(d) && objectToString(d) === '[object Date]';\n}\nexports.isDate = isDate;\n\nfunction isError(e) {\n  return isObject(e) &&\n      (objectToString(e) === '[object Error]' || e instanceof Error);\n}\nexports.isError = isError;\n\nfunction isFunction(arg) {\n  return typeof arg === 'function';\n}\nexports.isFunction = isFunction;\n\nfunction isPrimitive(arg) {\n  return arg === null ||\n         typeof arg === 'boolean' ||\n         typeof arg === 'number' ||\n         typeof arg === 'string' ||\n         typeof arg === 'symbol' ||  // ES6 symbol\n         typeof arg === 'undefined';\n}\nexports.isPrimitive = isPrimitive;\n\nexports.isBuffer = require('./support/isBuffer');\n\nfunction objectToString(o) {\n  return Object.prototype.toString.call(o);\n}\n\n\nfunction pad(n) {\n  return n < 10 ? '0' + n.toString(10) : n.toString(10);\n}\n\n\nvar months = ['Jan', 'Feb', 'Mar', 'Apr', 'May', 'Jun', 'Jul', 'Aug', 'Sep',\n              'Oct', 'Nov', 'Dec'];\n\n// 26 Feb 16:19:34\nfunction timestamp() {\n  var d = new Date();\n  var time = [pad(d.getHours()),\n              pad(d.getMinutes()),\n              pad(d.getSeconds())].join(':');\n  return [d.getDate(), months[d.getMonth()], time].join(' ');\n}\n\n\n// log is just a thin wrapper to console.log that prepends a timestamp\nexports.log = function() {\n  console.log('%s - %s', timestamp(), exports.format.apply(exports, arguments));\n};\n\n\n/**\n * Inherit the prototype methods from one constructor into another.\n *\n * The Function.prototype.inherits from lang.js rewritten as a standalone\n * function (not on Function.prototype). NOTE: If this file is to be loaded\n * during bootstrapping this function needs to be rewritten using some native\n * functions as prototype setup using normal JavaScript does not work as\n * expected during bootstrapping (see mirror.js in r114903).\n *\n * @param {function} ctor Constructor function which needs to inherit the\n *     prototype.\n * @param {function} superCtor Constructor function to inherit prototype from.\n */\nexports.inherits = require('inherits');\n\nexports._extend = function(origin, add) {\n  // Don't do anything if add isn't an object\n  if (!add || !isObject(add)) return origin;\n\n  var keys = Object.keys(add);\n  var i = keys.length;\n  while (i--) {\n    origin[keys[i]] = add[keys[i]];\n  }\n  return origin;\n};\n\nfunction hasOwnProperty(obj, prop) {\n  return Object.prototype.hasOwnProperty.call(obj, prop);\n}\n","// Generated by CoffeeScript 1.6.3\n(function() {\n  var EventEmitter, Postie,\n    __bind = function(fn, me){ return function(){ return fn.apply(me, arguments); }; },\n    __hasProp = {}.hasOwnProperty,\n    __extends = function(child, parent) { for (var key in parent) { if (__hasProp.call(parent, key)) child[key] = parent[key]; } function ctor() { this.constructor = child; } ctor.prototype = parent.prototype; child.prototype = new ctor(); child.__super__ = parent.prototype; return child; },\n    __slice = [].slice;\n\n  EventEmitter = require('events').EventEmitter;\n\n  Postie = (function(_super) {\n    __extends(Postie, _super);\n\n    Postie.prototype.target = null;\n\n    Postie.prototype.origin = null;\n\n    function Postie(target, origin) {\n      if (origin == null) {\n        origin = '*';\n      }\n      this.handleMessage = __bind(this.handleMessage, this);\n      if (!(this instanceof Postie)) {\n        return new Postie(target, origin);\n      }\n      Postie.__super__.constructor.call(this);\n      this.target = target;\n      this.origin = origin;\n      this.listen();\n    }\n\n    /*\n    Sends a package over channel.\n    \n    - `channel` (String): The channel to send the package over\n    - `pkg...` (Array...): The package to send. It will take any arguments after the first,\n      stick them in a JSON array and then on the other end call the callback\n      with those arguments applied to the callback.\n    \n    Returns the result of the postMessage call.\n    */\n\n\n    Postie.prototype.post = function() {\n      var channel, packed, pkg;\n      channel = arguments[0], pkg = 2 <= arguments.length ? __slice.call(arguments, 1) : [];\n      packed = this.pack(channel, pkg);\n      return this.target.postMessage(packed, this.origin);\n    };\n\n    /*\n    Sets up the postMessage handler\n    */\n\n\n    Postie.prototype.listen = function() {\n      if (window.addEventListener) {\n        return window.addEventListener('message', this.handleMessage);\n      } else {\n        return window.attachEvent('onmessage', this.handleMessage);\n      }\n    };\n\n    /*\n    Handles a postmessage event. Attempt to unpack it, and if we can emit an\n    event.\n    \n    - `event` (Event): The event to handle.\n    */\n\n\n    Postie.prototype.handleMessage = function(event) {\n      var unpackaged;\n      if (unpackaged = this.unpack(event.data)) {\n        return this.emit.apply(this, [unpackaged.channel].concat(__slice.call(unpackaged[\"package\"])));\n      }\n    };\n\n    /*\n    Takes a string from a postmessage event and tries to unpack it. If it is\n    successful it will return the unpacked object, otherwise it will return\n    false.\n    \n    - `data` (String): The data to attempt to unpack.\n    \n    Returns the unpacked data as an Object, or `false`.\n    */\n\n\n    Postie.prototype.unpack = function(data) {\n      var error, pkg;\n      try {\n        pkg = JSON.parse(data);\n        return {\n          channel: pkg._postie.channel,\n          \"package\": pkg._postie[\"package\"]\n        };\n      } catch (_error) {\n        error = _error;\n        return false;\n      }\n    };\n\n    /*\n    Packs a channel string and a package to send into a String that we can send\n    over postMessage to be unpacked on the other side.\n    \n    - `channel` (String): The channel the package is being sent on.\n    - `pkg` (Mixed): The package to pack with the channel into the string.\n    \n    Returns a String which can be unpacked into its old representation via\n    `@unpack()`.\n    */\n\n\n    Postie.prototype.pack = function(channel, pkg) {\n      return JSON.stringify({\n        _postie: {\n          channel: channel,\n          \"package\": pkg\n        }\n      });\n    };\n\n    return Postie;\n\n  })(EventEmitter);\n\n  module.exports = Postie;\n\n}).call(this);\n","module.exports = true;","module.exports = extend\n\nfunction extend() {\n    var target = {}\n\n    for (var i = 0; i < arguments.length; i++) {\n        var source = arguments[i]\n\n        for (var key in source) {\n            if (source.hasOwnProperty(key)) {\n                target[key] = source[key]\n            }\n        }\n    }\n\n    return target\n}\n","/**\n * @fileoverview Streaming RPC implementation on top of websockets.\n */\n\nvar MessageType = require('./message_type');\nvar Duplex = require('stream').Duplex;\nvar inherits = require('util').inherits;\n\n/*\n * A stream that allows sending and receiving data for a streaming rpc.  If\n * onmessage is set and a function, it will be called whenever there is data on.\n * the stream. The stream implements the promise api.  When the rpc is complete,\n * the stream will be fulfilled.  If there is an error, then the stream will be\n * rejected.\n * @constructor\n *\n * @param {number} flowId flow id\n * @param {Promise} webSocketPromise Promise of a websocket connection when\n * it's established\n * @param {boolean} isClient if set, then this is the client stream.\n */\nvar Stream = function(flowId, webSocketPromise, isClient) {\n  Duplex.call(this, { objectMode: true });\n  this.flowId = flowId;\n  this.isClient = isClient;\n  this.webSocketPromise = webSocketPromise;\n  this.onmessage = null;\n\n  // The buffer of messages that will be passed to push\n  // when the internal buffer has room.\n  this.wsBuffer = [];\n\n  // If set, objects are directly written to the internal buffer\n  // rather than wsBuffer.\n  this.shouldQueue = false;\n};\n\ninherits(Stream, Duplex);\n\n/**\n * Closes the stream, telling the other side that there is no more data.\n */\nStream.prototype.clientClose = function() {\n  var object = {\n    id: this.flowId,\n    type: MessageType.STREAM_CLOSE\n  };\n  Duplex.prototype.write.call(this, object);\n};\n\nStream.prototype.serverClose = function(value, err) {\n  var object = {\n    id: this.flowId,\n    type: MessageType.RESPONSE,\n    data: JSON.stringify({\n      results: [value || null],\n      err: err || null\n    })\n  };\n  Duplex.prototype.write.call(this, object);\n};\n\n/**\n * Implements the _read method needed by those subclassing Duplex.\n * The parameter passed in is ignored, since it doesn't really make\n * sense in object mode.\n */\nStream.prototype._read = function() {\n  // On a call to read, copy any objects in the websocket buffer into\n  // the internal stream buffer.  If we exhaust the websocket buffer\n  // and still have more room in the internal buffer, we set shouldQueue\n  // so we directly write to the internal buffer.\n  var i = 0;\n  while (i < this.wsBuffer.length && this.push(this.wsBuffer[i])) {\n    ++i;\n  }\n  if (i > 0) {\n    this.wsBuffer = this.wsBuffer.splice(i);\n  }\n\n  this.shouldQueue = this.wsBuffer.length === 0;\n};\n\n/**\n * Queue the object passed in for reading\n */\nStream.prototype._queueRead = function(object) {\n  if (this.shouldQueue) {\n    // If we have run into the limit of the internal buffer,\n    // update this.shouldQueue.\n    this.shouldQueue = this.push(object);\n  } else {\n    this.wsBuffer.push(object);\n  }\n};\n\n/**\n * Writes an object to the stream.\n * @param {*} chunk The data to write to the stream.\n * @param {null} encoding ignored for object streams.\n * @param {function} cb if set, the function to call when the write\n * completes.\n * @return {boolean} Returns false if the write buffer is full.\n */\nStream.prototype.write = function(chunk, encoding, cb) {\n  var object = {\n    id: this.flowId,\n    data: JSON.stringify(chunk),\n    type: MessageType.STREAM_VALUE\n  };\n  return Duplex.prototype.write.call(this, object, encoding, cb);\n};\n\nStream.prototype._write = function(chunk, encoding, cb) {\n  this.webSocketPromise.then(function(websocket) {\n    websocket.send(JSON.stringify(chunk));\n    cb();\n  });\n};\n\n/**\n * Writes an optional object to the stream and ends the stream.\n * @param {*} chunk The data to write to the stream.\n * @param {null} encoding ignored for object streams.\n * @param {function} cb if set, the function to call when the write\n * completes.\n */\nStream.prototype.end = function(chunk, encoding, cb) {\n  if (this.isClient) {\n    if (chunk !== undefined) {\n      this.write(chunk, encoding);\n    }\n    this.clientClose();\n  } else {\n    // We probably shouldn't allow direct calls to end, since we need\n    // a return value here, but if they are piping streams, the developer\n    // probably doesn't care about the return value.\n    this.serverClose();\n  }\n\n  Duplex.prototype.end.call(this, null, null, cb);\n};\n\nmodule.exports = Stream;\n","/**\n * @fileoverview Enum for incoming payload types\n */\n\nvar IncomingPayloadType = {\n  FINAL_RESPONSE: 0, // Final response to a call originating from JS\n  STREAM_RESPONSE: 1, // Stream response to a call originating from JS\n  ERROR_RESPONSE: 2, // Error response to a call originating from JS\n  INVOKE_REQUEST: 3, // Request to invoke a method in JS originating from server\n  STREAM_CLOSE: 4,  // Response saying that the stream is closed\n  LOOKUP_REQUEST: 5, // A request to perform a dispatcher lookup\n  AUTHORIZATION_REQUEST: 6,  // A request to authorize an rpc.\n  CANCEL: 7 // A request to cancel a previously invoked JS method\n};\n\nmodule.exports = IncomingPayloadType;\n","/**\n * @fileoverview conversion between JavaScript and veyron2/verror Error object\n */\n\nvar vError = require('./../lib/verror');\n\nmodule.exports = {\n  toStandardErrorStruct: toStandardErrorStruct,\n  toJSerror: toJSerror\n};\n\n/*\n * Implements the same structure as Standard struct in veyron2/verror\n * @private\n * @param {Object} idAction idActionription of the error, which in JavaScript,\n * corresponds to the name property of an Error object.\n */\nvar _standard = function(idAction, message, paramList) {\n  this.idAction = idAction;\n  this.msg = message;\n  this.paramList = paramList;\n};\n\n/*\n * Converts from a JavaScript error object to verror standard struct which\n * wspr expects as error format.\n * @private\n * @param {Error} err JavaScript error object\n * @param {string} appName name of the app\n * @param {string} operation operation name.\n * @return {_standard} verror standard struct\n */\nfunction toStandardErrorStruct(err, appName, operation) {\n  var idAction = vError.IdActions.Unknown;\n  var message = '';\n  var paramList = [];\n\n  if (err instanceof Error) {\n    message = err.message;\n\n    if (err.idAction) {\n      idAction = err.idAction;\n    }\n    paramList = err.paramList || [];\n  } else if (err !== undefined && err !== null) {\n    // coerce to string\n    message = err + '';\n  }\n\n  if (!paramList[0] && appName) {\n    paramList[0] = appName;\n  }\n\n  if (!paramList[1] && operation) {\n    paramList[1] = operation;\n  }\n  return new _standard(idAction, message, paramList);\n}\n\n// TODO(jasoncampbell): Change this so that the error map is easier to\n// lookup constructors etc.\nvar errors = {};\n\nObject.keys(vError.IdActions).forEach(function(key) {\n  var value = vError.IdActions[key];\n  var ctor = vError[key + 'Error'];\n\n  errors[value.id] = ctor;\n});\n\n/*\n * Converts from a verror standard struct which comes from wspr to JavaScript\n * Error object ensuring message and name are set properly\n * @private\n * @param {_standard} verr verror standard struct\n * @return {Error} JavaScript error object\n */\nfunction toJSerror(verr) {\n  var err;\n\n  // iDAction from GO, idAction from JS\n  var idAction = verr.iDAction || verr.idAction;\n  var id = idAction.iD || idAction.id;\n  var msg = verr.msg || (id + ': ' + verr.paramList.join(' '));\n\n  var Ctor = errors[id];\n\n  if (Ctor) {\n    err = new Ctor(msg);\n  } else {\n    err = new vError.VeyronError(msg, idAction);\n  }\n  err.paramList = verr.paramList || [];\n\n  return err;\n}\n","var IncomingPayloadType = require('./incoming_payload_type');\nvar ErrorConversion = require('./error_conversion');\n\nmodule.exports = Handler;\n\n/*\n * A simple incoming stream handler that handles incoming response, error\n * and close messages and queues them on the given stream object.\n * @param {Stream} Stream instance\n * @constructor\n */\nfunction Handler(stream) {\n  this._stream = stream;\n}\n\nHandler.prototype.handleResponse = function(type, data) {\n  switch (type) {\n    case IncomingPayloadType.STREAM_RESPONSE:\n      this._stream._queueRead(data);\n      break;\n    case IncomingPayloadType.STREAM_CLOSE:\n      this._stream._queueRead(null);\n      break;\n    case IncomingPayloadType.ERROR_RESPONSE:\n      this._stream.emit('error', ErrorConversion.toJSerror(data));\n      break;\n  }\n};","/**\n * @fileoverview A context passed to the authorizer\n */\nvar PublicId = require('./public.js');\nmodule.exports = Context;\n\nfunction Context(ctx, proxy) {\n  this.method = ctx.method;\n  this.name = ctx.name;\n  this.suffix = ctx.suffix;\n  // TODO(bjornick): Use the enums.\n  this.label = ctx.label;\n  this.localId = new PublicId(ctx.localID.names, ctx.localID.handle,\n                              ctx.localID.publicKey, proxy);\n  this.remoteId = new PublicId(ctx.remoteID.names, ctx.remoteID.handle,\n                              ctx.remoteID.publicKey, proxy);\n  // TODO(bjornick): Create endpoints.\n  this.localEndpoint = ctx.localEndpoint;\n  this.remoteEndpoint = ctx.remoteEndpoint;\n}\n","/*\n * @fileoverview The server context is a subclass of context that has\n * extra information about the state of a server call.\n */\n\nvar PublicId = require('../security/public');\nvar context = require('../runtime/context');\nvar inherits = require('util').inherits;\nvar constants = require('./constants');\n\nmodule.exports = ServerContext;\n\n/*\n * A ServerContext is a context.Context subclass that includes additional\n * information about an ongoing server call.\n * @constructor\n * @param request An rpc request object.\n * @param proxy A proxy instance.\n */\nfunction ServerContext(request, proxy) {\n  if (!(this instanceof ServerContext)) {\n    return new ServerContext();\n  }\n\n  // TODO(mattr): What to pass for runtime? Remove runtime as a param?\n  this._ctx = new context.Context({});\n  if (request.context.timeout !== constants.NO_TIMEOUT) {\n    this._ctx = this._ctx.withTimeout(request.context.timeout);\n  } else {\n    this._ctx = this._ctx.withCancel();\n  }\n  this.suffix = request.context.suffix;\n  this.name = request.context.name;\n  this.remoteId = new PublicId(request.context.remoteID.names,\n                               request.context.remoteID.handle,\n                               request.context.remoteID.publicKey,\n                               proxy);\n}\ninherits(ServerContext, context.Context);\n\nServerContext.prototype.deadline = function() {\n  return this._ctx.deadline();\n};\nServerContext.prototype.done = function() {\n  return this._ctx.done();\n};\nServerContext.prototype.waitUntilDone = function(callback) {\n  return this._ctx.waitUntilDone(callback);\n};\nServerContext.prototype.runtime = function() {\n  return this._ctx.runtime();\n};\nServerContext.prototype.value = function(key) {\n  return this._ctx.value();\n};\nServerContext.prototype.cancel = function() {\n  return this._ctx.cancel();\n};\n","/**\n * @fileoverview An object that handles marshaling and unmarshal\n * messages from the native veyron implementation.\n */\n\nvar MessageType = require('./message_type');\nvar IncomingPayloadType = require('./incoming_payload_type');\nvar Deferred = require('./../lib/deferred');\nvar vLog = require('./../lib/vlog');\nvar SimpleHandler = require('./simple_handler');\nvar context = require('../runtime/context');\n\n// Cache the service signatures for one hour.\nvar BIND_CACHE_TTL = 3600 * 1000;\n\n/**\n * A client for the native veyron implementation.\n * @constructor\n * @param {Promise} sender A promise that is resolved when we are able to send\n * a message to the native veron implementation. It should be resolved with an\n * object that has a send function that will send messages to the native\n * implementation.\n */\nfunction Proxy(sender) {\n  // We use odd numbers for the message ids, so that the server can use even\n  // numbers.\n  this.id = 1;\n  this.outstandingRequests = {};\n  this.bindCache = {};\n  this.senderPromise = sender;\n  this.incomingRequestHandlers = {};\n}\n\n/**\n * Handles a message from native veyron implementation.\n * @param {Object} messsage The message from the native veyron code.\n */\nProxy.prototype.process = function(message) {\n  // Messages originating from server are even numbers\n  var isServerOriginatedMessage = (message.id % 2) === 0;\n\n  var handler = this.outstandingRequests[message.id];\n\n  var payload;\n  try {\n    payload = JSON.parse(message.data);\n  } catch (e) {\n    if (!isServerOriginatedMessage) {\n      handler.handleResponse(IncomingPayloadType.ERROR_RESPONSE, message.data);\n    }\n    return;\n  }\n\n  // If we don't know about this flow, just drop the message. Unless it\n  // originated from the sever.\n  if (!isServerOriginatedMessage && !handler) {\n    vLog.warn('Dropping message for unknown flow ' + message.id + ' ' +\n        message.data);\n    return;\n  }\n\n  if (!handler) {\n    handler = this.incomingRequestHandlers[payload.type];\n    if (!handler) {\n      vLog.warn('Dropping message for unknown invoke payload ' + payload.type);\n      return;\n    }\n    handler.handleRequest(message.id, payload.type, payload.message);\n  } else {\n    handler.handleResponse(payload.type, payload.message);\n  }\n};\n\nProxy.prototype.dequeue = function(id) {\n  delete this.outstandingRequests[id];\n};\n\nProxy.prototype.nextId = function() {\n  var id = this.id;\n  this.id += 2;\n  return id;\n};\n\n/**\n * Gets the signature including methods names, number of arguments for a given\n * service name.\n * @param {Context} A context instance.\n * @param {string} name the veyron name of the service to get signature for.\n * @return {Promise} Signature of the service in JSON format\n */\nProxy.prototype.getServiceSignature = function(ctx, name) {\n  name = context.optionalContext(arguments);\n\n  var proxy = this;\n  var deferred = new Deferred();\n  var now = Date.now;\n\n  // TODO(jasoncampbell): Cache logic should be isolated elsewhere and\n  // attached to the Proxy instance. The async-cache module with maxAge set\n  // to BIND_CACHE_TTL would be a good fit here:\n  // https://www.npmjs.org/package/async-cache\n  var cache = this.bindCache[name];\n\n  if (cache && (now() - cache.fetched < BIND_CACHE_TTL)) {\n    deferred.resolve(cache.signature);\n    return deferred.promise;\n  }\n\n  deferred.promise.then(function(signature) {\n    proxy.bindCache[name] = {\n      signature: signature,\n      fetched: now()\n    };\n  });\n\n  var messageJSON = { name: name };\n  var message = JSON.stringify(messageJSON);\n\n  var id = proxy.nextId();\n  var handler = new SimpleHandler(deferred, proxy, id);\n  this.cancelFromContext(ctx, id);\n  proxy.sendRequest(message, MessageType.SIGNATURE, handler, id);\n\n  return deferred.promise;\n};\n\n\nProxy.prototype.addIncomingHandler = function(type, handler) {\n  this.incomingRequestHandlers[type] = handler;\n};\n\nProxy.prototype.addIncomingStreamHandler = function(id, handler) {\n  this.outstandingRequests[id] = handler;\n};\n\n/*\n * Arranges to notify downstream servers when the given\n * context is cancelled.  It also causes outstanding handlers for\n * those requests to receive a cancellation error.\n */\nProxy.prototype.cancelFromContext = function(ctx, id) {\n  var proxy = this;\n  ctx.waitUntilDone().catch(function(error) {\n    var h = proxy.outstandingRequests[id];\n    proxy.sendRequest(null, MessageType.CANCEL, null, id);\n    if (h) {\n      h.handleResponse(IncomingPayloadType.ERROR_RESPONSE, error);\n      delete proxy.outstandingRequests[id];\n    }\n  });\n};\n\n/**\n * Establishes the connection if needed, frames the message with the next id,\n * adds the given deferred to outstanding requests queue and sends the request\n * to the server\n * @param {Object} message Message to send\n * @param {MessageType} type Type of message to send\n * @param {Object} handler An object with a handleResponse method that takes\n * a response type and a message.  If null, then responses for this flow\n * are ignored.\n * @param {Number} id Use this flow id instead of generating\n * a new one.\n */\nProxy.prototype.sendRequest = function(message, type, handler, id) {\n  if (handler) {\n    this.outstandingRequests[id] = handler;\n  }\n  var body = JSON.stringify({ id: id, data: message, type: type });\n\n  var self = this;\n  this.senderPromise.then(function(sender) {\n    sender.send(body);\n  }).catch(function(err) {\n    // TODO(jasoncampbell): Add tests that cover this case, also sender.send\n    // above is async and will break out of the try/catch promise mechanism\n    // in node.\n    var h = self.outstandingRequests[id];\n\n    if (h) {\n      h.handleResponse(IncomingPayloadType.ERROR_RESPONSE, err);\n      delete self.outstandingRequests[id];\n    }\n  });\n};\n\n/**\n * Export the module\n */\nmodule.exports = Proxy;\n","/**\n * @fileoverview Constants related to ipc.\n */\n\nmodule.exports = {\n  // NO_TIMEOUT is a special value sent over the wire to indicate\n  // that the call should have no timeout.  It is:\n  // (2^63 - 1) / 1000000.  The (2^63 - 1) is the equivalant constant in Go\n  // and the 1000000 is a conversion from ns to ms.\n  NO_TIMEOUT: 9223372036854\n};\n","/**\n * @fileoverview Veyron Context\n */\n\nvar Deferred = require('../lib/deferred');\nvar Promise = require('../lib/promise');\nvar vError = require('../lib/verror');\nvar inherits = require('util').inherits;\n\nmodule.exports = {\n  optionalContext: optionalContext,\n  Context: Context,\n  ContextKey: ContextKey,\n  DeadlineExceededError: DeadlineExceededError,\n  CancelledError: CancelledError\n};\n\n/*\n * Adjusts the arg positions if the context is not present.  This is\n * intended as a temporary measure to ease the transition to having\n * context as a required first parameter.  Eventually this can be\n * changed to throw errors and then be removed altogether.\n * This function returns the last argument, which you must assign\n * manually.\n * @param {arguments} A function arguments list.\n * @return {*} The last argument of the host function.\n */\nfunction optionalContext(args) {\n  var lastidx = args.length - 1;\n  if (lastidx >= 0 && args[0] instanceof Context) {\n    return args[lastidx];\n  }\n\n  var last = args[lastidx];\n  for (var i = lastidx; i > 0; i--) {\n    args[i] = args[i - 1];\n  }\n  args[0] = new Context({});\n  return last;\n}\n\n/*\n * Creates an Error object indicating that the context was cancelled\n * due to an expired deadline.\n * @constructor\n * @param {string} message message\n */\nfunction DeadlineExceededError() {\n  if (!(this instanceof DeadlineExceededError)) {\n    return new DeadlineExceededError();\n  }\n  vError.AbortedError.call(this, 'deadline exceeded');\n}\ninherits(DeadlineExceededError, vError.AbortedError);\n\n/*\n * Creates an Error object indicating that the context was manually\n * cancelled.\n * @constructor\n */\nfunction CancelledError() {\n  if (!(this instanceof CancelledError)) {\n    return new CancelledError();\n  }\n  vError.AbortedError.call(this, 'cancelled');\n}\ninherits(CancelledError, vError.AbortedError);\n\n/*\n * Creates an object than can be used as a key in the value and\n * withValue methods of a context.  Modules that want to attach data\n * to the context should first construct a key, then use that key\n * whenever they want store or retrieve their data from the context.\n * @constructor\n */\nfunction ContextKey() {\n  if (!(this instanceof ContextKey)) {\n    return new ContextKey();\n  }\n  this._key = ContextKey._nextKey;\n  ContextKey._nextKey++;\n}\n\nContextKey._nextKey = 0;\n\n/*\n * Creates a new root context.  This should be used to generate a\n * context for a new operation which is unrealted to any ongoing\n * activity.\n * @constructor\n * @param {Runtime} runtime The runtime to attach to this context\n */\nfunction Context(runtime) {\n  if (!(this instanceof Context)) {\n    return new Context(runtime);\n  }\n\n  if (runtime === null) {\n    throw new vError.BadArgError(\n      'Attempting to construct context with null runtime.');\n  }\n\n  this._runtime = runtime;\n}\n\n/*\n * Returns the time at which this context will be automatically\n * canceled.  If no deadline has been set, null is returned.\n * @return {Date} The Date corresponding to the deadline\n */\nContext.prototype.deadline = function() {\n  return null;\n};\n\n\n/*\n * Returns true if the context has exceeded its deadline or has\n * been cancelled.\n * @return {boolean} True if the context is done\n */\nContext.prototype.done = function() {\n  return false;\n};\n\n/*\n * Returns a promise that will be resolved when the context exceeds\n * its deadline or is cancelled.  Optionally you can pass a callback\n * that will be run when the promise is resolved.\n * @param {function} A callback function(error) to call upon cancellation\n */\nContext.prototype.waitUntilDone = function(callback) {\n  // The root context can never be cancelled, and therefore we\n  // throw away the context and return a promise that will never\n  // be resolved.\n  return new Promise(function(){});\n};\n\n/*\n * Returns the runtime used to create this context.  This is\n * guaranteed to be non-null.\n * @return {Runtime} The runtime, guaranteed to be non-null\n */\nContext.prototype.runtime = function() {\n  return this._runtime;\n};\n\n/*\n * Returns the value corresponding to the given key.  The\n * value/withValue methods can be used to attach data to context that\n * will be carried across API boundaries.  You should use this only\n * for data that is relevant across multiple API boundaries and not\n * just to pass extra parameters to functions and methods.  The key\n * must be an instance of ContextKey.  This function will return null\n * if there is no value associated with the given key.\n * @param {ContextKey} A ContextKey to look up\n * @return {*} The value associated with the key, or null\n */\nContext.prototype.value = function(key) {\n  return null;\n};\n\n/*\n * Returns a new context derived from the current context but that\n * will return the given value when value(key) is called with the\n * given key.\n * @param {ContextKey} A key.\n * @param {*} A value to associate with the key.\n * @return {Context} A new derived context.\n */\nContext.prototype.withValue = function(key, value) {\n  return new ValueContext(this, key, value);\n};\n\n/*\n * Returns a new context derived from the current context but that\n * can be cancelled.  The returned context will have an additional\n * method cancel() which can be used to cancel the context.\n * @return {Context} A new derived cancellable context.\n */\nContext.prototype.withCancel = function() {\n  return new CancelContext(this);\n};\n\n/*\n * Returns a new context derived from the current context but that\n * will be automatically cancelled after a given deadline.  The\n * returned context will have an additional method cancel() which can\n * be used to cancel the context early.\n * @param {Date} A date object which specifies the deadline.\n * @return {Context} A new derived cancellable context.\n */\nContext.prototype.withDeadline = function(deadline) {\n  return new DeadlineContext(this, deadline);\n};\n\n/*\n * Returns a new context derived from the current context but that\n * will be automatically cancelled after a given timeout.  The\n * returned context will have an additional method cancel() which can\n * be used to cancel the context early.\n * @param {Number} A timeout in milliseconds.\n * @return {Context} A new derived cancellable context.\n */\nContext.prototype.withTimeout = function(timeout) {\n  return new DeadlineContext(this, Date.now() + timeout);\n};\n\n\n// ChildContext is a the base class for other context specializations.\n// It defers all its calls to its parent.\nfunction ChildContext(parent) {\n  this._parent = parent;\n  // I explicitly don't call Context here because I don't\n  // want to set _runtime on every instance.\n}\ninherits(ChildContext, Context);\n\nChildContext.prototype.deadline = function() {\n  return this._parent.deadline();\n};\nChildContext.prototype.done = function() {\n  return this._parent.done();\n};\nChildContext.prototype.waitUntilDone = function(callback) {\n  return this._parent.waitUntilDone(callback);\n};\nChildContext.prototype.runtime = function() {\n  return this._parent.runtime();\n};\nChildContext.prototype.value = function(key) {\n  return this._parent.value();\n};\n\n// ValueContext is a context that associates a single key with a\n// single value.\nfunction ValueContext(parent, key, value) {\n  if (!(key instanceof ContextKey)) {\n    throw new vError.BadArgError(\n      'Attempting to set a value on a context, ' +\n      'but the key is not of type ContextKey.');\n  }\n\n  this._key = key;\n  this._value = value;\n  ChildContext.call(this, parent);\n}\ninherits(ValueContext, ChildContext);\n\nValueContext.prototype.value = function(key) {\n  if (!(key instanceof ContextKey)) {\n    throw new vError.BadArgError(\n      'Attempting to look up a value on a context, ' +\n      'but the key is not of type ContextKey.');\n  }\n  if (key._key === this._key._key) {\n    return this._value;\n  }\n  return this._parent.value(key);\n};\n\n// cancellableAncestor walks up the tree of parent contexts to find\n// the nearest ancestor that is cancellable.\nfunction cancellableAncestor(parent) {\n  for (; parent instanceof ChildContext; parent = parent._parent) {\n    if (parent instanceof CancelContext) {\n      return parent;\n    }\n  }\n  // If we've reached the root, there is no cancellable ancestor.\n  return null;\n}\n\n// A CancelContext is a context which can be cancelled.\nfunction CancelContext(parent) {\n  this._id = CancelContext._nextID;\n  CancelContext._nextID++;\n\n  this._done = false;\n  this._deferred = new Deferred();\n  this._children = {};\n\n  // We need to arrange to be cancelled when our parent is.\n  var ca = cancellableAncestor(parent);\n  if (ca) {\n    ca._children[this._id] = this;\n  }\n\n  ChildContext.call(this, parent);\n}\ninherits(CancelContext, ChildContext);\n\nCancelContext._nextID = 0;\n\nCancelContext.prototype.done = function() {\n  return this._done;\n};\n\nCancelContext.prototype._cancel = function(error) {\n  this._done = true;\n  this._deferred.reject(error);\n  for (var id in this._children) {\n    if (this._children.hasOwnProperty(id)) {\n      this._children[id]._cancel(error);\n    }\n  }\n  this._children = {};\n};\n\nCancelContext.prototype.cancel = function() {\n  var ca = cancellableAncestor(this._parent);\n  if (ca) {\n    delete ca._children[this._id];\n  }\n  this._cancel(new CancelledError());\n};\n\nCancelContext.prototype.waitUntilDone = function(callback) {\n  this._deferred.addCallback(callback);\n  return this._deferred.promise;\n};\n\n// A DeadlineContext cancels itself when its deadline is met.\nfunction DeadlineContext(parent, deadline) {\n  this._deadline = deadline;\n  this._timerID = setTimeout(this._expire.bind(this), deadline - Date.now());\n\n  CancelContext.call(this, parent);\n}\ninherits(DeadlineContext, CancelContext);\n\nDeadlineContext.prototype.deadline = function() {\n  return this._deadline;\n};\n\nDeadlineContext.prototype._cancel = function(error) {\n  clearTimeout(this._timerID);\n  CancelContext.prototype._cancel.call(this, error);\n};\n\nDeadlineContext.prototype._expire = function(error) {\n  this._cancel(new DeadlineExceededError());\n};\n","module.exports = function isBuffer(arg) {\n  return arg && typeof arg === 'object'\n    && typeof arg.copy === 'function'\n    && typeof arg.fill === 'function'\n    && typeof arg.readUInt8 === 'function';\n}","// Copyright Joyent, Inc. and other Node contributors.\n//\n// Permission is hereby granted, free of charge, to any person obtaining a\n// copy of this software and associated documentation files (the\n// \"Software\"), to deal in the Software without restriction, including\n// without limitation the rights to use, copy, modify, merge, publish,\n// distribute, sublicense, and/or sell copies of the Software, and to permit\n// persons to whom the Software is furnished to do so, subject to the\n// following conditions:\n//\n// The above copyright notice and this permission notice shall be included\n// in all copies or substantial portions of the Software.\n//\n// THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS\n// OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF\n// MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN\n// NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM,\n// DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR\n// OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE\n// USE OR OTHER DEALINGS IN THE SOFTWARE.\n\nfunction EventEmitter() {\n  this._events = this._events || {};\n  this._maxListeners = this._maxListeners || undefined;\n}\nmodule.exports = EventEmitter;\n\n// Backwards-compat with node 0.10.x\nEventEmitter.EventEmitter = EventEmitter;\n\nEventEmitter.prototype._events = undefined;\nEventEmitter.prototype._maxListeners = undefined;\n\n// By default EventEmitters will print a warning if more than 10 listeners are\n// added to it. This is a useful default which helps finding memory leaks.\nEventEmitter.defaultMaxListeners = 10;\n\n// Obviously not all Emitters should be limited to 10. This function allows\n// that to be increased. Set to zero for unlimited.\nEventEmitter.prototype.setMaxListeners = function(n) {\n  if (!isNumber(n) || n < 0 || isNaN(n))\n    throw TypeError('n must be a positive number');\n  this._maxListeners = n;\n  return this;\n};\n\nEventEmitter.prototype.emit = function(type) {\n  var er, handler, len, args, i, listeners;\n\n  if (!this._events)\n    this._events = {};\n\n  // If there is no 'error' event listener then throw.\n  if (type === 'error') {\n    if (!this._events.error ||\n        (isObject(this._events.error) && !this._events.error.length)) {\n      er = arguments[1];\n      if (er instanceof Error) {\n        throw er; // Unhandled 'error' event\n      }\n      throw TypeError('Uncaught, unspecified \"error\" event.');\n    }\n  }\n\n  handler = this._events[type];\n\n  if (isUndefined(handler))\n    return false;\n\n  if (isFunction(handler)) {\n    switch (arguments.length) {\n      // fast cases\n      case 1:\n        handler.call(this);\n        break;\n      case 2:\n        handler.call(this, arguments[1]);\n        break;\n      case 3:\n        handler.call(this, arguments[1], arguments[2]);\n        break;\n      // slower\n      default:\n        len = arguments.length;\n        args = new Array(len - 1);\n        for (i = 1; i < len; i++)\n          args[i - 1] = arguments[i];\n        handler.apply(this, args);\n    }\n  } else if (isObject(handler)) {\n    len = arguments.length;\n    args = new Array(len - 1);\n    for (i = 1; i < len; i++)\n      args[i - 1] = arguments[i];\n\n    listeners = handler.slice();\n    len = listeners.length;\n    for (i = 0; i < len; i++)\n      listeners[i].apply(this, args);\n  }\n\n  return true;\n};\n\nEventEmitter.prototype.addListener = function(type, listener) {\n  var m;\n\n  if (!isFunction(listener))\n    throw TypeError('listener must be a function');\n\n  if (!this._events)\n    this._events = {};\n\n  // To avoid recursion in the case that type === \"newListener\"! Before\n  // adding it to the listeners, first emit \"newListener\".\n  if (this._events.newListener)\n    this.emit('newListener', type,\n              isFunction(listener.listener) ?\n              listener.listener : listener);\n\n  if (!this._events[type])\n    // Optimize the case of one listener. Don't need the extra array object.\n    this._events[type] = listener;\n  else if (isObject(this._events[type]))\n    // If we've already got an array, just append.\n    this._events[type].push(listener);\n  else\n    // Adding the second element, need to change to array.\n    this._events[type] = [this._events[type], listener];\n\n  // Check for listener leak\n  if (isObject(this._events[type]) && !this._events[type].warned) {\n    var m;\n    if (!isUndefined(this._maxListeners)) {\n      m = this._maxListeners;\n    } else {\n      m = EventEmitter.defaultMaxListeners;\n    }\n\n    if (m && m > 0 && this._events[type].length > m) {\n      this._events[type].warned = true;\n      console.error('(node) warning: possible EventEmitter memory ' +\n                    'leak detected. %d listeners added. ' +\n                    'Use emitter.setMaxListeners() to increase limit.',\n                    this._events[type].length);\n      if (typeof console.trace === 'function') {\n        // not supported in IE 10\n        console.trace();\n      }\n    }\n  }\n\n  return this;\n};\n\nEventEmitter.prototype.on = EventEmitter.prototype.addListener;\n\nEventEmitter.prototype.once = function(type, listener) {\n  if (!isFunction(listener))\n    throw TypeError('listener must be a function');\n\n  var fired = false;\n\n  function g() {\n    this.removeListener(type, g);\n\n    if (!fired) {\n      fired = true;\n      listener.apply(this, arguments);\n    }\n  }\n\n  g.listener = listener;\n  this.on(type, g);\n\n  return this;\n};\n\n// emits a 'removeListener' event iff the listener was removed\nEventEmitter.prototype.removeListener = function(type, listener) {\n  var list, position, length, i;\n\n  if (!isFunction(listener))\n    throw TypeError('listener must be a function');\n\n  if (!this._events || !this._events[type])\n    return this;\n\n  list = this._events[type];\n  length = list.length;\n  position = -1;\n\n  if (list === listener ||\n      (isFunction(list.listener) && list.listener === listener)) {\n    delete this._events[type];\n    if (this._events.removeListener)\n      this.emit('removeListener', type, listener);\n\n  } else if (isObject(list)) {\n    for (i = length; i-- > 0;) {\n      if (list[i] === listener ||\n          (list[i].listener && list[i].listener === listener)) {\n        position = i;\n        break;\n      }\n    }\n\n    if (position < 0)\n      return this;\n\n    if (list.length === 1) {\n      list.length = 0;\n      delete this._events[type];\n    } else {\n      list.splice(position, 1);\n    }\n\n    if (this._events.removeListener)\n      this.emit('removeListener', type, listener);\n  }\n\n  return this;\n};\n\nEventEmitter.prototype.removeAllListeners = function(type) {\n  var key, listeners;\n\n  if (!this._events)\n    return this;\n\n  // not listening for removeListener, no need to emit\n  if (!this._events.removeListener) {\n    if (arguments.length === 0)\n      this._events = {};\n    else if (this._events[type])\n      delete this._events[type];\n    return this;\n  }\n\n  // emit removeListener for all listeners on all events\n  if (arguments.length === 0) {\n    for (key in this._events) {\n      if (key === 'removeListener') continue;\n      this.removeAllListeners(key);\n    }\n    this.removeAllListeners('removeListener');\n    this._events = {};\n    return this;\n  }\n\n  listeners = this._events[type];\n\n  if (isFunction(listeners)) {\n    this.removeListener(type, listeners);\n  } else {\n    // LIFO order\n    while (listeners.length)\n      this.removeListener(type, listeners[listeners.length - 1]);\n  }\n  delete this._events[type];\n\n  return this;\n};\n\nEventEmitter.prototype.listeners = function(type) {\n  var ret;\n  if (!this._events || !this._events[type])\n    ret = [];\n  else if (isFunction(this._events[type]))\n    ret = [this._events[type]];\n  else\n    ret = this._events[type].slice();\n  return ret;\n};\n\nEventEmitter.listenerCount = function(emitter, type) {\n  var ret;\n  if (!emitter._events || !emitter._events[type])\n    ret = 0;\n  else if (isFunction(emitter._events[type]))\n    ret = 1;\n  else\n    ret = emitter._events[type].length;\n  return ret;\n};\n\nfunction isFunction(arg) {\n  return typeof arg === 'function';\n}\n\nfunction isNumber(arg) {\n  return typeof arg === 'number';\n}\n\nfunction isObject(arg) {\n  return typeof arg === 'object' && arg !== null;\n}\n\nfunction isUndefined(arg) {\n  return arg === void 0;\n}\n","/**\n * The MIT License (MIT)\n * \n * Copyright (c) 2014 Petka Antonov\n * \n * Permission is hereby granted, free of charge, to any person obtaining a copy\n * of this software and associated documentation files (the \"Software\"), to deal\n * in the Software without restriction, including without limitation the rights\n * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell\n * copies of the Software, and to permit persons to whom the Software is\n * furnished to do so, subject to the following conditions:</p>\n * \n * The above copyright notice and this permission notice shall be included in\n * all copies or substantial portions of the Software.\n * \n * THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT.  IN NO EVENT SHALL THE\n * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\n * THE SOFTWARE.\n * \n */\n\"use strict\";\nvar Promise = require(\"./promise.js\")();\nmodule.exports = Promise;","// Copyright Joyent, Inc. and other Node contributors.\n//\n// Permission is hereby granted, free of charge, to any person obtaining a\n// copy of this software and associated documentation files (the\n// \"Software\"), to deal in the Software without restriction, including\n// without limitation the rights to use, copy, modify, merge, publish,\n// distribute, sublicense, and/or sell copies of the Software, and to permit\n// persons to whom the Software is furnished to do so, subject to the\n// following conditions:\n//\n// The above copyright notice and this permission notice shall be included\n// in all copies or substantial portions of the Software.\n//\n// THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS\n// OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF\n// MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN\n// NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM,\n// DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR\n// OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE\n// USE OR OTHER DEALINGS IN THE SOFTWARE.\n\nmodule.exports = Stream;\n\nvar EE = require('events').EventEmitter;\nvar inherits = require('inherits');\n\ninherits(Stream, EE);\nStream.Readable = require('readable-stream/readable.js');\nStream.Writable = require('readable-stream/writable.js');\nStream.Duplex = require('readable-stream/duplex.js');\nStream.Transform = require('readable-stream/transform.js');\nStream.PassThrough = require('readable-stream/passthrough.js');\n\n// Backwards-compat with node 0.4.x\nStream.Stream = Stream;\n\n\n\n// old-style streams.  Note that the pipe method (the only relevant\n// part of this class) is overridden in the Readable class.\n\nfunction Stream() {\n  EE.call(this);\n}\n\nStream.prototype.pipe = function(dest, options) {\n  var source = this;\n\n  function ondata(chunk) {\n    if (dest.writable) {\n      if (false === dest.write(chunk) && source.pause) {\n        source.pause();\n      }\n    }\n  }\n\n  source.on('data', ondata);\n\n  function ondrain() {\n    if (source.readable && source.resume) {\n      source.resume();\n    }\n  }\n\n  dest.on('drain', ondrain);\n\n  // If the 'end' option is not supplied, dest.end() will be called when\n  // source gets the 'end' or 'close' events.  Only dest.end() once.\n  if (!dest._isStdio && (!options || options.end !== false)) {\n    source.on('end', onend);\n    source.on('close', onclose);\n  }\n\n  var didOnEnd = false;\n  function onend() {\n    if (didOnEnd) return;\n    didOnEnd = true;\n\n    dest.end();\n  }\n\n\n  function onclose() {\n    if (didOnEnd) return;\n    didOnEnd = true;\n\n    if (typeof dest.destroy === 'function') dest.destroy();\n  }\n\n  // don't leave dangling pipes when there are errors.\n  function onerror(er) {\n    cleanup();\n    if (EE.listenerCount(this, 'error') === 0) {\n      throw er; // Unhandled stream error in pipe.\n    }\n  }\n\n  source.on('error', onerror);\n  dest.on('error', onerror);\n\n  // remove all the event listeners that were added.\n  function cleanup() {\n    source.removeListener('data', ondata);\n    dest.removeListener('drain', ondrain);\n\n    source.removeListener('end', onend);\n    source.removeListener('close', onclose);\n\n    source.removeListener('error', onerror);\n    dest.removeListener('error', onerror);\n\n    source.removeListener('end', cleanup);\n    source.removeListener('close', cleanup);\n\n    dest.removeListener('close', cleanup);\n  }\n\n  source.on('end', cleanup);\n  source.on('close', cleanup);\n\n  dest.on('close', cleanup);\n\n  dest.emit('pipe', source);\n\n  // Allow for unix-like usage: A.pipe(B).pipe(C)\n  return dest;\n};\n","if (typeof Object.create === 'function') {\n  // implementation from standard node.js 'util' module\n  module.exports = function inherits(ctor, superCtor) {\n    ctor.super_ = superCtor\n    ctor.prototype = Object.create(superCtor.prototype, {\n      constructor: {\n        value: ctor,\n        enumerable: false,\n        writable: true,\n        configurable: true\n      }\n    });\n  };\n} else {\n  // old school shim for old browsers\n  module.exports = function inherits(ctor, superCtor) {\n    ctor.super_ = superCtor\n    var TempCtor = function () {}\n    TempCtor.prototype = superCtor.prototype\n    ctor.prototype = new TempCtor()\n    ctor.prototype.constructor = ctor\n  }\n}\n","/**\n * The MIT License (MIT)\n * \n * Copyright (c) 2014 Petka Antonov\n * \n * Permission is hereby granted, free of charge, to any person obtaining a copy\n * of this software and associated documentation files (the \"Software\"), to deal\n * in the Software without restriction, including without limitation the rights\n * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell\n * copies of the Software, and to permit persons to whom the Software is\n * furnished to do so, subject to the following conditions:</p>\n * \n * The above copyright notice and this permission notice shall be included in\n * all copies or substantial portions of the Software.\n * \n * THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT.  IN NO EVENT SHALL THE\n * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\n * THE SOFTWARE.\n * \n */\n\"use strict\";\nvar old;\nif (typeof Promise !== \"undefined\") old = Promise;\nfunction noConflict(bluebird) {\n    try { if (Promise === bluebird) Promise = old; }\n    catch (e) {}\n    return bluebird;\n}\nmodule.exports = function() {\nvar util = require(\"./util.js\");\nvar async = require(\"./async.js\");\nvar errors = require(\"./errors.js\");\n\nvar INTERNAL = function(){};\nvar APPLY = {};\nvar NEXT_FILTER = {e: null};\n\nvar cast = require(\"./thenables.js\")(Promise, INTERNAL);\nvar PromiseArray = require(\"./promise_array.js\")(Promise, INTERNAL, cast);\nvar CapturedTrace = require(\"./captured_trace.js\")();\nvar CatchFilter = require(\"./catch_filter.js\")(NEXT_FILTER);\nvar PromiseResolver = require(\"./promise_resolver.js\");\n\nvar isArray = util.isArray;\n\nvar errorObj = util.errorObj;\nvar tryCatch1 = util.tryCatch1;\nvar tryCatch2 = util.tryCatch2;\nvar tryCatchApply = util.tryCatchApply;\nvar RangeError = errors.RangeError;\nvar TypeError = errors.TypeError;\nvar CancellationError = errors.CancellationError;\nvar TimeoutError = errors.TimeoutError;\nvar OperationalError = errors.OperationalError;\nvar originatesFromRejection = errors.originatesFromRejection;\nvar markAsOriginatingFromRejection = errors.markAsOriginatingFromRejection;\nvar canAttach = errors.canAttach;\nvar thrower = util.thrower;\nvar apiRejection = require(\"./errors_api_rejection\")(Promise);\n\n\nvar makeSelfResolutionError = function Promise$_makeSelfResolutionError() {\n    return new TypeError(\"circular promise resolution chain\");\n};\n\nfunction Promise(resolver) {\n    if (typeof resolver !== \"function\") {\n        throw new TypeError(\"the promise constructor requires a resolver function\");\n    }\n    if (this.constructor !== Promise) {\n        throw new TypeError(\"the promise constructor cannot be invoked directly\");\n    }\n    this._bitField = 0;\n    this._fulfillmentHandler0 = void 0;\n    this._rejectionHandler0 = void 0;\n    this._promise0 = void 0;\n    this._receiver0 = void 0;\n    this._settledValue = void 0;\n    this._boundTo = void 0;\n    if (resolver !== INTERNAL) this._resolveFromResolver(resolver);\n}\n\nfunction returnFirstElement(elements) {\n    return elements[0];\n}\n\nPromise.prototype.bind = function Promise$bind(thisArg) {\n    var maybePromise = cast(thisArg, void 0);\n    var ret = new Promise(INTERNAL);\n    if (maybePromise instanceof Promise) {\n        var binder = maybePromise.then(function(thisArg) {\n            ret._setBoundTo(thisArg);\n        });\n        var p = Promise.all([this, binder]).then(returnFirstElement);\n        ret._follow(p);\n    } else {\n        ret._follow(this);\n        ret._setBoundTo(thisArg);\n    }\n    ret._propagateFrom(this, 2 | 1);\n    return ret;\n};\n\nPromise.prototype.toString = function Promise$toString() {\n    return \"[object Promise]\";\n};\n\nPromise.prototype.caught = Promise.prototype[\"catch\"] =\nfunction Promise$catch(fn) {\n    var len = arguments.length;\n    if (len > 1) {\n        var catchInstances = new Array(len - 1),\n            j = 0, i;\n        for (i = 0; i < len - 1; ++i) {\n            var item = arguments[i];\n            if (typeof item === \"function\") {\n                catchInstances[j++] = item;\n            } else {\n                var catchFilterTypeError =\n                    new TypeError(\n                        \"A catch filter must be an error constructor \"\n                        + \"or a filter function\");\n\n                this._attachExtraTrace(catchFilterTypeError);\n                return Promise.reject(catchFilterTypeError);\n            }\n        }\n        catchInstances.length = j;\n        fn = arguments[i];\n\n        this._resetTrace();\n        var catchFilter = new CatchFilter(catchInstances, fn, this);\n        return this._then(void 0, catchFilter.doFilter, void 0,\n            catchFilter, void 0);\n    }\n    return this._then(void 0, fn, void 0, void 0, void 0);\n};\n\nfunction reflect() {\n    return new Promise.PromiseInspection(this);\n}\n\nPromise.prototype.reflect = function Promise$reflect() {\n    return this._then(reflect, reflect, void 0, this, void 0);\n};\n\nPromise.prototype.then =\nfunction Promise$then(didFulfill, didReject, didProgress) {\n    return this._then(didFulfill, didReject, didProgress,\n        void 0, void 0);\n};\n\n\nPromise.prototype.done =\nfunction Promise$done(didFulfill, didReject, didProgress) {\n    var promise = this._then(didFulfill, didReject, didProgress,\n        void 0, void 0);\n    promise._setIsFinal();\n};\n\nPromise.prototype.spread = function Promise$spread(didFulfill, didReject) {\n    return this._then(didFulfill, didReject, void 0,\n        APPLY, void 0);\n};\n\nPromise.prototype.isCancellable = function Promise$isCancellable() {\n    return !this.isResolved() &&\n        this._cancellable();\n};\n\nPromise.prototype.toJSON = function Promise$toJSON() {\n    var ret = {\n        isFulfilled: false,\n        isRejected: false,\n        fulfillmentValue: void 0,\n        rejectionReason: void 0\n    };\n    if (this.isFulfilled()) {\n        ret.fulfillmentValue = this._settledValue;\n        ret.isFulfilled = true;\n    } else if (this.isRejected()) {\n        ret.rejectionReason = this._settledValue;\n        ret.isRejected = true;\n    }\n    return ret;\n};\n\nPromise.prototype.all = function Promise$all() {\n    return new PromiseArray(this).promise();\n};\n\n\nPromise.is = function Promise$Is(val) {\n    return val instanceof Promise;\n};\n\nPromise.all = function Promise$All(promises) {\n    return new PromiseArray(promises).promise();\n};\n\nPromise.prototype.error = function Promise$_error(fn) {\n    return this.caught(originatesFromRejection, fn);\n};\n\nPromise.prototype._resolveFromSyncValue =\nfunction Promise$_resolveFromSyncValue(value) {\n    if (value === errorObj) {\n        this._cleanValues();\n        this._setRejected();\n        this._settledValue = value.e;\n        this._ensurePossibleRejectionHandled();\n    } else {\n        var maybePromise = cast(value, void 0);\n        if (maybePromise instanceof Promise) {\n            this._follow(maybePromise);\n        } else {\n            this._cleanValues();\n            this._setFulfilled();\n            this._settledValue = value;\n        }\n    }\n};\n\nPromise.method = function Promise$_Method(fn) {\n    if (typeof fn !== \"function\") {\n        throw new TypeError(\"fn must be a function\");\n    }\n    return function Promise$_method() {\n        var value;\n        switch(arguments.length) {\n        case 0: value = tryCatch1(fn, this, void 0); break;\n        case 1: value = tryCatch1(fn, this, arguments[0]); break;\n        case 2: value = tryCatch2(fn, this, arguments[0], arguments[1]); break;\n        default:\n            var $_len = arguments.length;var args = new Array($_len); for(var $_i = 0; $_i < $_len; ++$_i) {args[$_i] = arguments[$_i];}\n            value = tryCatchApply(fn, args, this); break;\n        }\n        var ret = new Promise(INTERNAL);\n        ret._setTrace(void 0);\n        ret._resolveFromSyncValue(value);\n        return ret;\n    };\n};\n\nPromise.attempt = Promise[\"try\"] = function Promise$_Try(fn, args, ctx) {\n    if (typeof fn !== \"function\") {\n        return apiRejection(\"fn must be a function\");\n    }\n    var value = isArray(args)\n        ? tryCatchApply(fn, args, ctx)\n        : tryCatch1(fn, ctx, args);\n\n    var ret = new Promise(INTERNAL);\n    ret._setTrace(void 0);\n    ret._resolveFromSyncValue(value);\n    return ret;\n};\n\nPromise.defer = Promise.pending = function Promise$Defer() {\n    var promise = new Promise(INTERNAL);\n    promise._setTrace(void 0);\n    return new PromiseResolver(promise);\n};\n\nPromise.bind = function Promise$Bind(thisArg) {\n    var maybePromise = cast(thisArg, void 0);\n    var ret = new Promise(INTERNAL);\n    ret._setTrace(void 0);\n\n    if (maybePromise instanceof Promise) {\n        var p = maybePromise.then(function(thisArg) {\n            ret._setBoundTo(thisArg);\n        });\n        ret._follow(p);\n    } else {\n        ret._setBoundTo(thisArg);\n        ret._setFulfilled();\n    }\n    return ret;\n};\n\nPromise.cast = function Promise$_Cast(obj) {\n    var ret = cast(obj, void 0);\n    if (!(ret instanceof Promise)) {\n        var val = ret;\n        ret = new Promise(INTERNAL);\n        ret._setTrace(void 0);\n        ret._setFulfilled();\n        ret._cleanValues();\n        ret._settledValue = val;\n    }\n    return ret;\n};\n\nPromise.resolve = Promise.fulfilled = Promise.cast;\n\nPromise.reject = Promise.rejected = function Promise$Reject(reason) {\n    var ret = new Promise(INTERNAL);\n    ret._setTrace(void 0);\n    markAsOriginatingFromRejection(reason);\n    ret._cleanValues();\n    ret._setRejected();\n    ret._settledValue = reason;\n    if (!canAttach(reason)) {\n        var trace = new Error(reason + \"\");\n        ret._setCarriedStackTrace(trace);\n    }\n    ret._ensurePossibleRejectionHandled();\n    return ret;\n};\n\nPromise.onPossiblyUnhandledRejection =\nfunction Promise$OnPossiblyUnhandledRejection(fn) {\n        CapturedTrace.possiblyUnhandledRejection = typeof fn === \"function\"\n                                                    ? fn : void 0;\n};\n\nvar unhandledRejectionHandled;\nPromise.onUnhandledRejectionHandled =\nfunction Promise$onUnhandledRejectionHandled(fn) {\n    unhandledRejectionHandled = typeof fn === \"function\" ? fn : void 0;\n};\n\nvar debugging = false || !!(\n    typeof process !== \"undefined\" &&\n    typeof process.execPath === \"string\" &&\n    typeof process.env === \"object\" &&\n    (process.env[\"BLUEBIRD_DEBUG\"] ||\n        process.env[\"NODE_ENV\"] === \"development\")\n);\n\n\nPromise.longStackTraces = function Promise$LongStackTraces() {\n    if (async.haveItemsQueued() &&\n        debugging === false\n   ) {\n        throw new Error(\"cannot enable long stack traces after promises have been created\");\n    }\n    debugging = CapturedTrace.isSupported();\n};\n\nPromise.hasLongStackTraces = function Promise$HasLongStackTraces() {\n    return debugging && CapturedTrace.isSupported();\n};\n\nPromise.prototype._then =\nfunction Promise$_then(\n    didFulfill,\n    didReject,\n    didProgress,\n    receiver,\n    internalData\n) {\n    var haveInternalData = internalData !== void 0;\n    var ret = haveInternalData ? internalData : new Promise(INTERNAL);\n\n    if (!haveInternalData) {\n        if (debugging) {\n            var haveSameContext = this._peekContext() === this._traceParent;\n            ret._traceParent = haveSameContext ? this._traceParent : this;\n        }\n        ret._propagateFrom(this, 7);\n    }\n\n    var callbackIndex =\n        this._addCallbacks(didFulfill, didReject, didProgress, ret, receiver);\n\n    if (this.isResolved()) {\n        async.invoke(this._queueSettleAt, this, callbackIndex);\n    }\n\n    return ret;\n};\n\nPromise.prototype._length = function Promise$_length() {\n    return this._bitField & 262143;\n};\n\nPromise.prototype._isFollowingOrFulfilledOrRejected =\nfunction Promise$_isFollowingOrFulfilledOrRejected() {\n    return (this._bitField & 939524096) > 0;\n};\n\nPromise.prototype._isFollowing = function Promise$_isFollowing() {\n    return (this._bitField & 536870912) === 536870912;\n};\n\nPromise.prototype._setLength = function Promise$_setLength(len) {\n    this._bitField = (this._bitField & -262144) |\n        (len & 262143);\n};\n\nPromise.prototype._setFulfilled = function Promise$_setFulfilled() {\n    this._bitField = this._bitField | 268435456;\n};\n\nPromise.prototype._setRejected = function Promise$_setRejected() {\n    this._bitField = this._bitField | 134217728;\n};\n\nPromise.prototype._setFollowing = function Promise$_setFollowing() {\n    this._bitField = this._bitField | 536870912;\n};\n\nPromise.prototype._setIsFinal = function Promise$_setIsFinal() {\n    this._bitField = this._bitField | 33554432;\n};\n\nPromise.prototype._isFinal = function Promise$_isFinal() {\n    return (this._bitField & 33554432) > 0;\n};\n\nPromise.prototype._cancellable = function Promise$_cancellable() {\n    return (this._bitField & 67108864) > 0;\n};\n\nPromise.prototype._setCancellable = function Promise$_setCancellable() {\n    this._bitField = this._bitField | 67108864;\n};\n\nPromise.prototype._unsetCancellable = function Promise$_unsetCancellable() {\n    this._bitField = this._bitField & (~67108864);\n};\n\nPromise.prototype._setRejectionIsUnhandled =\nfunction Promise$_setRejectionIsUnhandled() {\n    this._bitField = this._bitField | 2097152;\n};\n\nPromise.prototype._unsetRejectionIsUnhandled =\nfunction Promise$_unsetRejectionIsUnhandled() {\n    this._bitField = this._bitField & (~2097152);\n    if (this._isUnhandledRejectionNotified()) {\n        this._unsetUnhandledRejectionIsNotified();\n        this._notifyUnhandledRejectionIsHandled();\n    }\n};\n\nPromise.prototype._isRejectionUnhandled =\nfunction Promise$_isRejectionUnhandled() {\n    return (this._bitField & 2097152) > 0;\n};\n\nPromise.prototype._setUnhandledRejectionIsNotified =\nfunction Promise$_setUnhandledRejectionIsNotified() {\n    this._bitField = this._bitField | 524288;\n};\n\nPromise.prototype._unsetUnhandledRejectionIsNotified =\nfunction Promise$_unsetUnhandledRejectionIsNotified() {\n    this._bitField = this._bitField & (~524288);\n};\n\nPromise.prototype._isUnhandledRejectionNotified =\nfunction Promise$_isUnhandledRejectionNotified() {\n    return (this._bitField & 524288) > 0;\n};\n\nPromise.prototype._setCarriedStackTrace =\nfunction Promise$_setCarriedStackTrace(capturedTrace) {\n    this._bitField = this._bitField | 1048576;\n    this._fulfillmentHandler0 = capturedTrace;\n};\n\nPromise.prototype._unsetCarriedStackTrace =\nfunction Promise$_unsetCarriedStackTrace() {\n    this._bitField = this._bitField & (~1048576);\n    this._fulfillmentHandler0 = void 0;\n};\n\nPromise.prototype._isCarryingStackTrace =\nfunction Promise$_isCarryingStackTrace() {\n    return (this._bitField & 1048576) > 0;\n};\n\nPromise.prototype._getCarriedStackTrace =\nfunction Promise$_getCarriedStackTrace() {\n    return this._isCarryingStackTrace()\n        ? this._fulfillmentHandler0\n        : void 0;\n};\n\nPromise.prototype._receiverAt = function Promise$_receiverAt(index) {\n    var ret = index === 0\n        ? this._receiver0\n        : this[(index << 2) + index - 5 + 4];\n    if (this._isBound() && ret === void 0) {\n        return this._boundTo;\n    }\n    return ret;\n};\n\nPromise.prototype._promiseAt = function Promise$_promiseAt(index) {\n    return index === 0\n        ? this._promise0\n        : this[(index << 2) + index - 5 + 3];\n};\n\nPromise.prototype._fulfillmentHandlerAt =\nfunction Promise$_fulfillmentHandlerAt(index) {\n    return index === 0\n        ? this._fulfillmentHandler0\n        : this[(index << 2) + index - 5 + 0];\n};\n\nPromise.prototype._rejectionHandlerAt =\nfunction Promise$_rejectionHandlerAt(index) {\n    return index === 0\n        ? this._rejectionHandler0\n        : this[(index << 2) + index - 5 + 1];\n};\n\nPromise.prototype._addCallbacks = function Promise$_addCallbacks(\n    fulfill,\n    reject,\n    progress,\n    promise,\n    receiver\n) {\n    var index = this._length();\n\n    if (index >= 262143 - 5) {\n        index = 0;\n        this._setLength(0);\n    }\n\n    if (index === 0) {\n        this._promise0 = promise;\n        if (receiver !== void 0) this._receiver0 = receiver;\n        if (typeof fulfill === \"function\" && !this._isCarryingStackTrace())\n            this._fulfillmentHandler0 = fulfill;\n        if (typeof reject === \"function\") this._rejectionHandler0 = reject;\n        if (typeof progress === \"function\") this._progressHandler0 = progress;\n    } else {\n        var base = (index << 2) + index - 5;\n        this[base + 3] = promise;\n        this[base + 4] = receiver;\n        this[base + 0] = typeof fulfill === \"function\"\n                                            ? fulfill : void 0;\n        this[base + 1] = typeof reject === \"function\"\n                                            ? reject : void 0;\n        this[base + 2] = typeof progress === \"function\"\n                                            ? progress : void 0;\n    }\n    this._setLength(index + 1);\n    return index;\n};\n\nPromise.prototype._setProxyHandlers =\nfunction Promise$_setProxyHandlers(receiver, promiseSlotValue) {\n    var index = this._length();\n\n    if (index >= 262143 - 5) {\n        index = 0;\n        this._setLength(0);\n    }\n    if (index === 0) {\n        this._promise0 = promiseSlotValue;\n        this._receiver0 = receiver;\n    } else {\n        var base = (index << 2) + index - 5;\n        this[base + 3] = promiseSlotValue;\n        this[base + 4] = receiver;\n        this[base + 0] =\n        this[base + 1] =\n        this[base + 2] = void 0;\n    }\n    this._setLength(index + 1);\n};\n\nPromise.prototype._proxyPromiseArray =\nfunction Promise$_proxyPromiseArray(promiseArray, index) {\n    this._setProxyHandlers(promiseArray, index);\n};\n\nPromise.prototype._proxyPromise = function Promise$_proxyPromise(promise) {\n    promise._setProxied();\n    this._setProxyHandlers(promise, -15);\n};\n\nPromise.prototype._setBoundTo = function Promise$_setBoundTo(obj) {\n    if (obj !== void 0) {\n        this._bitField = this._bitField | 8388608;\n        this._boundTo = obj;\n    } else {\n        this._bitField = this._bitField & (~8388608);\n    }\n};\n\nPromise.prototype._isBound = function Promise$_isBound() {\n    return (this._bitField & 8388608) === 8388608;\n};\n\nPromise.prototype._resolveFromResolver =\nfunction Promise$_resolveFromResolver(resolver) {\n    var promise = this;\n    this._setTrace(void 0);\n    this._pushContext();\n\n    function Promise$_resolver(val) {\n        if (promise._tryFollow(val)) {\n            return;\n        }\n        promise._fulfill(val);\n    }\n    function Promise$_rejecter(val) {\n        var trace = canAttach(val) ? val : new Error(val + \"\");\n        promise._attachExtraTrace(trace);\n        markAsOriginatingFromRejection(val);\n        promise._reject(val, trace === val ? void 0 : trace);\n    }\n    var r = tryCatch2(resolver, void 0, Promise$_resolver, Promise$_rejecter);\n    this._popContext();\n\n    if (r !== void 0 && r === errorObj) {\n        var e = r.e;\n        var trace = canAttach(e) ? e : new Error(e + \"\");\n        promise._reject(e, trace);\n    }\n};\n\nPromise.prototype._spreadSlowCase =\nfunction Promise$_spreadSlowCase(targetFn, promise, values, boundTo) {\n    var promiseForAll = new PromiseArray(values).promise();\n    var promise2 = promiseForAll._then(function() {\n        return targetFn.apply(boundTo, arguments);\n    }, void 0, void 0, APPLY, void 0);\n    promise._follow(promise2);\n};\n\nPromise.prototype._callSpread =\nfunction Promise$_callSpread(handler, promise, value) {\n    var boundTo = this._boundTo;\n    if (isArray(value)) {\n        for (var i = 0, len = value.length; i < len; ++i) {\n            if (cast(value[i], void 0) instanceof Promise) {\n                this._spreadSlowCase(handler, promise, value, boundTo);\n                return;\n            }\n        }\n    }\n    promise._pushContext();\n    return tryCatchApply(handler, value, boundTo);\n};\n\nPromise.prototype._callHandler =\nfunction Promise$_callHandler(\n    handler, receiver, promise, value) {\n    var x;\n    if (receiver === APPLY && !this.isRejected()) {\n        x = this._callSpread(handler, promise, value);\n    } else {\n        promise._pushContext();\n        x = tryCatch1(handler, receiver, value);\n    }\n    promise._popContext();\n    return x;\n};\n\nPromise.prototype._settlePromiseFromHandler =\nfunction Promise$_settlePromiseFromHandler(\n    handler, receiver, value, promise\n) {\n    if (!(promise instanceof Promise)) {\n        handler.call(receiver, value, promise);\n        return;\n    }\n    var x = this._callHandler(handler, receiver, promise, value);\n    if (promise._isFollowing()) return;\n\n    if (x === errorObj || x === promise || x === NEXT_FILTER) {\n        var err = x === promise\n                    ? makeSelfResolutionError()\n                    : x.e;\n        var trace = canAttach(err) ? err : new Error(err + \"\");\n        if (x !== NEXT_FILTER) promise._attachExtraTrace(trace);\n        promise._rejectUnchecked(err, trace);\n    } else {\n        var castValue = cast(x, promise);\n        if (castValue instanceof Promise) {\n            if (castValue.isRejected() &&\n                !castValue._isCarryingStackTrace() &&\n                !canAttach(castValue._settledValue)) {\n                var trace = new Error(castValue._settledValue + \"\");\n                promise._attachExtraTrace(trace);\n                castValue._setCarriedStackTrace(trace);\n            }\n            promise._follow(castValue);\n            promise._propagateFrom(castValue, 1);\n        } else {\n            promise._fulfillUnchecked(x);\n        }\n    }\n};\n\nPromise.prototype._follow =\nfunction Promise$_follow(promise) {\n    this._setFollowing();\n\n    if (promise.isPending()) {\n        this._propagateFrom(promise, 1);\n        promise._proxyPromise(this);\n    } else if (promise.isFulfilled()) {\n        this._fulfillUnchecked(promise._settledValue);\n    } else {\n        this._rejectUnchecked(promise._settledValue,\n            promise._getCarriedStackTrace());\n    }\n\n    if (promise._isRejectionUnhandled()) promise._unsetRejectionIsUnhandled();\n\n    if (debugging &&\n        promise._traceParent == null) {\n        promise._traceParent = this;\n    }\n};\n\nPromise.prototype._tryFollow =\nfunction Promise$_tryFollow(value) {\n    if (this._isFollowingOrFulfilledOrRejected() ||\n        value === this) {\n        return false;\n    }\n    var maybePromise = cast(value, void 0);\n    if (!(maybePromise instanceof Promise)) {\n        return false;\n    }\n    this._follow(maybePromise);\n    return true;\n};\n\nPromise.prototype._resetTrace = function Promise$_resetTrace() {\n    if (debugging) {\n        this._trace = new CapturedTrace(this._peekContext() === void 0);\n    }\n};\n\nPromise.prototype._setTrace = function Promise$_setTrace(parent) {\n    if (debugging) {\n        var context = this._peekContext();\n        this._traceParent = context;\n        var isTopLevel = context === void 0;\n        if (parent !== void 0 &&\n            parent._traceParent === context) {\n            this._trace = parent._trace;\n        } else {\n            this._trace = new CapturedTrace(isTopLevel);\n        }\n    }\n    return this;\n};\n\nPromise.prototype._attachExtraTrace =\nfunction Promise$_attachExtraTrace(error) {\n    if (debugging) {\n        var promise = this;\n        var stack = error.stack;\n        stack = typeof stack === \"string\" ? stack.split(\"\\n\") : [];\n        CapturedTrace.protectErrorMessageNewlines(stack);\n        var headerLineCount = 1;\n        var combinedTraces = 1;\n        while(promise != null &&\n            promise._trace != null) {\n            stack = CapturedTrace.combine(\n                stack,\n                promise._trace.stack.split(\"\\n\")\n            );\n            promise = promise._traceParent;\n            combinedTraces++;\n        }\n\n        var stackTraceLimit = Error.stackTraceLimit || 10;\n        var max = (stackTraceLimit + headerLineCount) * combinedTraces;\n        var len = stack.length;\n        if (len > max) {\n            stack.length = max;\n        }\n\n        if (len > 0)\n            stack[0] = stack[0].split(\"\\u0002\\u0000\\u0001\").join(\"\\n\");\n\n        if (stack.length <= headerLineCount) {\n            error.stack = \"(No stack trace)\";\n        } else {\n            error.stack = stack.join(\"\\n\");\n        }\n    }\n};\n\nPromise.prototype._cleanValues = function Promise$_cleanValues() {\n    if (this._cancellable()) {\n        this._cancellationParent = void 0;\n    }\n};\n\nPromise.prototype._propagateFrom =\nfunction Promise$_propagateFrom(parent, flags) {\n    if ((flags & 1) > 0 && parent._cancellable()) {\n        this._setCancellable();\n        this._cancellationParent = parent;\n    }\n    if ((flags & 4) > 0) {\n        this._setBoundTo(parent._boundTo);\n    }\n    if ((flags & 2) > 0) {\n        this._setTrace(parent);\n    }\n};\n\nPromise.prototype._fulfill = function Promise$_fulfill(value) {\n    if (this._isFollowingOrFulfilledOrRejected()) return;\n    this._fulfillUnchecked(value);\n};\n\nPromise.prototype._reject =\nfunction Promise$_reject(reason, carriedStackTrace) {\n    if (this._isFollowingOrFulfilledOrRejected()) return;\n    this._rejectUnchecked(reason, carriedStackTrace);\n};\n\nPromise.prototype._settlePromiseAt = function Promise$_settlePromiseAt(index) {\n    var handler = this.isFulfilled()\n        ? this._fulfillmentHandlerAt(index)\n        : this._rejectionHandlerAt(index);\n\n    var value = this._settledValue;\n    var receiver = this._receiverAt(index);\n    var promise = this._promiseAt(index);\n\n    if (typeof handler === \"function\") {\n        this._settlePromiseFromHandler(handler, receiver, value, promise);\n    } else {\n        var done = false;\n        var isFulfilled = this.isFulfilled();\n        if (receiver !== void 0) {\n            if (receiver instanceof Promise &&\n                receiver._isProxied()) {\n                receiver._unsetProxied();\n\n                if (isFulfilled) receiver._fulfillUnchecked(value);\n                else receiver._rejectUnchecked(value,\n                    this._getCarriedStackTrace());\n                done = true;\n            } else if (receiver instanceof PromiseArray) {\n                if (isFulfilled) receiver._promiseFulfilled(value, promise);\n                else receiver._promiseRejected(value, promise);\n                done = true;\n            }\n        }\n\n        if (!done) {\n            if (isFulfilled) promise._fulfill(value);\n            else promise._reject(value, this._getCarriedStackTrace());\n        }\n    }\n\n    if (index >= 4) {\n        this._queueGC();\n    }\n};\n\nPromise.prototype._isProxied = function Promise$_isProxied() {\n    return (this._bitField & 4194304) === 4194304;\n};\n\nPromise.prototype._setProxied = function Promise$_setProxied() {\n    this._bitField = this._bitField | 4194304;\n};\n\nPromise.prototype._unsetProxied = function Promise$_unsetProxied() {\n    this._bitField = this._bitField & (~4194304);\n};\n\nPromise.prototype._isGcQueued = function Promise$_isGcQueued() {\n    return (this._bitField & -1073741824) === -1073741824;\n};\n\nPromise.prototype._setGcQueued = function Promise$_setGcQueued() {\n    this._bitField = this._bitField | -1073741824;\n};\n\nPromise.prototype._unsetGcQueued = function Promise$_unsetGcQueued() {\n    this._bitField = this._bitField & (~-1073741824);\n};\n\nPromise.prototype._queueGC = function Promise$_queueGC() {\n    if (this._isGcQueued()) return;\n    this._setGcQueued();\n    async.invokeLater(this._gc, this, void 0);\n};\n\nPromise.prototype._gc = function Promise$gc() {\n    var len = this._length() * 5 - 5;\n    for (var i = 0; i < len; i++) {\n        delete this[i];\n    }\n    this._clearFirstHandlerData();\n    this._setLength(0);\n    this._unsetGcQueued();\n};\n\nPromise.prototype._clearFirstHandlerData =\nfunction Promise$_clearFirstHandlerData() {\n    this._fulfillmentHandler0 = void 0;\n    this._rejectionHandler0 = void 0;\n    this._promise0 = void 0;\n    this._receiver0 = void 0;\n};\n\nPromise.prototype._queueSettleAt = function Promise$_queueSettleAt(index) {\n    if (this._isRejectionUnhandled()) this._unsetRejectionIsUnhandled();\n    async.invoke(this._settlePromiseAt, this, index);\n};\n\nPromise.prototype._fulfillUnchecked =\nfunction Promise$_fulfillUnchecked(value) {\n    if (!this.isPending()) return;\n    if (value === this) {\n        var err = makeSelfResolutionError();\n        this._attachExtraTrace(err);\n        return this._rejectUnchecked(err, void 0);\n    }\n    this._cleanValues();\n    this._setFulfilled();\n    this._settledValue = value;\n    var len = this._length();\n\n    if (len > 0) {\n        async.invoke(this._settlePromises, this, len);\n    }\n};\n\nPromise.prototype._rejectUncheckedCheckError =\nfunction Promise$_rejectUncheckedCheckError(reason) {\n    var trace = canAttach(reason) ? reason : new Error(reason + \"\");\n    this._rejectUnchecked(reason, trace === reason ? void 0 : trace);\n};\n\nPromise.prototype._rejectUnchecked =\nfunction Promise$_rejectUnchecked(reason, trace) {\n    if (!this.isPending()) return;\n    if (reason === this) {\n        var err = makeSelfResolutionError();\n        this._attachExtraTrace(err);\n        return this._rejectUnchecked(err);\n    }\n    this._cleanValues();\n    this._setRejected();\n    this._settledValue = reason;\n\n    if (this._isFinal()) {\n        async.invokeLater(thrower, void 0, trace === void 0 ? reason : trace);\n        return;\n    }\n    var len = this._length();\n\n    if (trace !== void 0) this._setCarriedStackTrace(trace);\n\n    if (len > 0) {\n        async.invoke(this._rejectPromises, this, null);\n    } else {\n        this._ensurePossibleRejectionHandled();\n    }\n};\n\nPromise.prototype._rejectPromises = function Promise$_rejectPromises() {\n    this._settlePromises();\n    this._unsetCarriedStackTrace();\n};\n\nPromise.prototype._settlePromises = function Promise$_settlePromises() {\n    var len = this._length();\n    for (var i = 0; i < len; i++) {\n        this._settlePromiseAt(i);\n    }\n};\n\nPromise.prototype._ensurePossibleRejectionHandled =\nfunction Promise$_ensurePossibleRejectionHandled() {\n    this._setRejectionIsUnhandled();\n    if (CapturedTrace.possiblyUnhandledRejection !== void 0) {\n        async.invokeLater(this._notifyUnhandledRejection, this, void 0);\n    }\n};\n\nPromise.prototype._notifyUnhandledRejectionIsHandled =\nfunction Promise$_notifyUnhandledRejectionIsHandled() {\n    if (typeof unhandledRejectionHandled === \"function\") {\n        async.invokeLater(unhandledRejectionHandled, void 0, this);\n    }\n};\n\nPromise.prototype._notifyUnhandledRejection =\nfunction Promise$_notifyUnhandledRejection() {\n    if (this._isRejectionUnhandled()) {\n        var reason = this._settledValue;\n        var trace = this._getCarriedStackTrace();\n\n        this._setUnhandledRejectionIsNotified();\n\n        if (trace !== void 0) {\n            this._unsetCarriedStackTrace();\n            reason = trace;\n        }\n        if (typeof CapturedTrace.possiblyUnhandledRejection === \"function\") {\n            CapturedTrace.possiblyUnhandledRejection(reason, this);\n        }\n    }\n};\n\nvar contextStack = [];\nPromise.prototype._peekContext = function Promise$_peekContext() {\n    var lastIndex = contextStack.length - 1;\n    if (lastIndex >= 0) {\n        return contextStack[lastIndex];\n    }\n    return void 0;\n\n};\n\nPromise.prototype._pushContext = function Promise$_pushContext() {\n    if (!debugging) return;\n    contextStack.push(this);\n};\n\nPromise.prototype._popContext = function Promise$_popContext() {\n    if (!debugging) return;\n    contextStack.pop();\n};\n\nPromise.noConflict = function Promise$NoConflict() {\n    return noConflict(Promise);\n};\n\nPromise.setScheduler = function(fn) {\n    if (typeof fn !== \"function\") throw new TypeError(\"fn must be a function\");\n    async._schedule = fn;\n};\n\nif (!CapturedTrace.isSupported()) {\n    Promise.longStackTraces = function(){};\n    debugging = false;\n}\n\nPromise._makeSelfResolutionError = makeSelfResolutionError;\nrequire(\"./finally.js\")(Promise, NEXT_FILTER, cast);\nrequire(\"./direct_resolve.js\")(Promise);\nrequire(\"./synchronous_inspection.js\")(Promise);\nrequire(\"./join.js\")(Promise, PromiseArray, cast, INTERNAL);\nPromise.RangeError = RangeError;\nPromise.CancellationError = CancellationError;\nPromise.TimeoutError = TimeoutError;\nPromise.TypeError = TypeError;\nPromise.OperationalError = OperationalError;\nPromise.RejectionError = OperationalError;\nPromise.AggregateError = errors.AggregateError;\n\nutil.toFastProperties(Promise);\nutil.toFastProperties(Promise.prototype);\nPromise.Promise = Promise;\nrequire('./timers.js')(Promise,INTERNAL,cast);\nrequire('./race.js')(Promise,INTERNAL,cast);\nrequire('./call_get.js')(Promise);\nrequire('./generators.js')(Promise,apiRejection,INTERNAL,cast);\nrequire('./map.js')(Promise,PromiseArray,apiRejection,cast,INTERNAL);\nrequire('./nodeify.js')(Promise);\nrequire('./promisify.js')(Promise,INTERNAL);\nrequire('./props.js')(Promise,PromiseArray,cast);\nrequire('./reduce.js')(Promise,PromiseArray,apiRejection,cast,INTERNAL);\nrequire('./settle.js')(Promise,PromiseArray);\nrequire('./some.js')(Promise,PromiseArray,apiRejection);\nrequire('./progress.js')(Promise,PromiseArray);\nrequire('./cancel.js')(Promise,INTERNAL);\nrequire('./filter.js')(Promise,INTERNAL);\nrequire('./any.js')(Promise,PromiseArray);\nrequire('./each.js')(Promise,INTERNAL);\nrequire('./using.js')(Promise,apiRejection,cast);\n\nPromise.prototype = Promise.prototype;\nreturn Promise;\n\n};\n","\n/**\n * Module dependencies.\n */\n\nvar global = (function() { return this; })();\n\n/**\n * WebSocket constructor.\n */\n\nvar WebSocket = global.WebSocket || global.MozWebSocket;\n\n/**\n * Module exports.\n */\n\nmodule.exports = WebSocket ? ws : null;\n\n/**\n * WebSocket constructor.\n *\n * The third `opts` options object gets ignored in web browsers, since it's\n * non-standard, and throws a TypeError if passed to the constructor.\n * See: https://github.com/einaros/ws/issues/227\n *\n * @param {String} uri\n * @param {Array} protocols (optional)\n * @param {Object) opts (optional)\n * @api public\n */\n\nfunction ws(uri, protocols, opts) {\n  var instance;\n  if (protocols) {\n    instance = new WebSocket(uri, protocols);\n  } else {\n    instance = new WebSocket(uri);\n  }\n  return instance;\n}\n\nif (WebSocket) ws.prototype = WebSocket.prototype;\n","/**\n * The MIT License (MIT)\n * \n * Copyright (c) 2014 Petka Antonov\n * \n * Permission is hereby granted, free of charge, to any person obtaining a copy\n * of this software and associated documentation files (the \"Software\"), to deal\n * in the Software without restriction, including without limitation the rights\n * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell\n * copies of the Software, and to permit persons to whom the Software is\n * furnished to do so, subject to the following conditions:</p>\n * \n * The above copyright notice and this permission notice shall be included in\n * all copies or substantial portions of the Software.\n * \n * THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT.  IN NO EVENT SHALL THE\n * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\n * THE SOFTWARE.\n * \n */\n\"use strict\";\nvar es5 = require(\"./es5.js\");\nvar haveGetters = (function(){\n    try {\n        var o = {};\n        es5.defineProperty(o, \"f\", {\n            get: function () {\n                return 3;\n            }\n        });\n        return o.f === 3;\n    }\n    catch (e) {\n        return false;\n    }\n\n})();\nvar canEvaluate = typeof navigator == \"undefined\";\nvar errorObj = {e: {}};\nfunction tryCatch1(fn, receiver, arg) {\n    try { return fn.call(receiver, arg); }\n    catch (e) {\n        errorObj.e = e;\n        return errorObj;\n    }\n}\n\nfunction tryCatch2(fn, receiver, arg, arg2) {\n    try { return fn.call(receiver, arg, arg2); }\n    catch (e) {\n        errorObj.e = e;\n        return errorObj;\n    }\n}\n\nfunction tryCatch3(fn, receiver, arg, arg2, arg3) {\n    try { return fn.call(receiver, arg, arg2, arg3); }\n    catch (e) {\n        errorObj.e = e;\n        return errorObj;\n    }\n}\n\nfunction tryCatch4(fn, receiver, arg, arg2, arg3, arg4) {\n    try { return fn.call(receiver, arg, arg2, arg3, arg4); }\n    catch (e) {\n        errorObj.e = e;\n        return errorObj;\n    }\n}\n\nfunction tryCatchApply(fn, args, receiver) {\n    try { return fn.apply(receiver, args); }\n    catch (e) {\n        errorObj.e = e;\n        return errorObj;\n    }\n}\n\nvar inherits = function(Child, Parent) {\n    var hasProp = {}.hasOwnProperty;\n\n    function T() {\n        this.constructor = Child;\n        this.constructor$ = Parent;\n        for (var propertyName in Parent.prototype) {\n            if (hasProp.call(Parent.prototype, propertyName) &&\n                propertyName.charAt(propertyName.length-1) !== \"$\"\n           ) {\n                this[propertyName + \"$\"] = Parent.prototype[propertyName];\n            }\n        }\n    }\n    T.prototype = Parent.prototype;\n    Child.prototype = new T();\n    return Child.prototype;\n};\n\nfunction asString(val) {\n    return typeof val === \"string\" ? val : (\"\" + val);\n}\n\nfunction isPrimitive(val) {\n    return val == null || val === true || val === false ||\n        typeof val === \"string\" || typeof val === \"number\";\n\n}\n\nfunction isObject(value) {\n    return !isPrimitive(value);\n}\n\nfunction maybeWrapAsError(maybeError) {\n    if (!isPrimitive(maybeError)) return maybeError;\n\n    return new Error(asString(maybeError));\n}\n\nfunction withAppended(target, appendee) {\n    var len = target.length;\n    var ret = new Array(len + 1);\n    var i;\n    for (i = 0; i < len; ++i) {\n        ret[i] = target[i];\n    }\n    ret[i] = appendee;\n    return ret;\n}\n\nfunction getDataPropertyOrDefault(obj, key, defaultValue) {\n    if (es5.isES5) {\n        var desc = Object.getOwnPropertyDescriptor(obj, key);\n        if (desc != null) {\n            return desc.get == null && desc.set == null\n                    ? desc.value\n                    : defaultValue;\n        }\n    } else {\n        return {}.hasOwnProperty.call(obj, key) ? obj[key] : void 0;\n    }\n}\n\nfunction notEnumerableProp(obj, name, value) {\n    if (isPrimitive(obj)) return obj;\n    var descriptor = {\n        value: value,\n        configurable: true,\n        enumerable: false,\n        writable: true\n    };\n    es5.defineProperty(obj, name, descriptor);\n    return obj;\n}\n\n\nvar wrapsPrimitiveReceiver = (function() {\n    return this !== \"string\";\n}).call(\"string\");\n\nfunction thrower(r) {\n    throw r;\n}\n\nvar inheritedDataKeys = (function() {\n    if (es5.isES5) {\n        return function(obj, opts) {\n            var ret = [];\n            var visitedKeys = Object.create(null);\n            var getKeys = Object(opts).includeHidden\n                ? Object.getOwnPropertyNames\n                : Object.keys;\n            while (obj != null) {\n                var keys;\n                try {\n                    keys = getKeys(obj);\n                } catch (e) {\n                    return ret;\n                }\n                for (var i = 0; i < keys.length; ++i) {\n                    var key = keys[i];\n                    if (visitedKeys[key]) continue;\n                    visitedKeys[key] = true;\n                    var desc = Object.getOwnPropertyDescriptor(obj, key);\n                    if (desc != null && desc.get == null && desc.set == null) {\n                        ret.push(key);\n                    }\n                }\n                obj = es5.getPrototypeOf(obj);\n            }\n            return ret;\n        };\n    } else {\n        return function(obj) {\n            var ret = [];\n            /*jshint forin:false */\n            for (var key in obj) {\n                ret.push(key);\n            }\n            return ret;\n        };\n    }\n\n})();\n\nfunction isClass(fn) {\n    try {\n        if (typeof fn === \"function\") {\n            var keys = es5.keys(fn.prototype);\n            return keys.length > 0 &&\n                   !(keys.length === 1 && keys[0] === \"constructor\");\n        }\n        return false;\n    } catch (e) {\n        return false;\n    }\n}\n\nfunction toFastProperties(obj) {\n    /*jshint -W027*/\n    function f() {}\n    f.prototype = obj;\n    return f;\n    eval(obj);\n}\n\nvar rident = /^[a-z$_][a-z$_0-9]*$/i;\nfunction isIdentifier(str) {\n    return rident.test(str);\n}\n\nfunction filledRange(count, prefix, suffix) {\n    var ret = new Array(count);\n    for(var i = 0; i < count; ++i) {\n        ret[i] = prefix + i + suffix;\n    }\n    return ret;\n}\n\nvar ret = {\n    isClass: isClass,\n    isIdentifier: isIdentifier,\n    inheritedDataKeys: inheritedDataKeys,\n    getDataPropertyOrDefault: getDataPropertyOrDefault,\n    thrower: thrower,\n    isArray: es5.isArray,\n    haveGetters: haveGetters,\n    notEnumerableProp: notEnumerableProp,\n    isPrimitive: isPrimitive,\n    isObject: isObject,\n    canEvaluate: canEvaluate,\n    errorObj: errorObj,\n    tryCatch1: tryCatch1,\n    tryCatch2: tryCatch2,\n    tryCatch3: tryCatch3,\n    tryCatch4: tryCatch4,\n    tryCatchApply: tryCatchApply,\n    inherits: inherits,\n    withAppended: withAppended,\n    asString: asString,\n    maybeWrapAsError: maybeWrapAsError,\n    wrapsPrimitiveReceiver: wrapsPrimitiveReceiver,\n    toFastProperties: toFastProperties,\n    filledRange: filledRange\n};\n\nmodule.exports = ret;\n","/**\n * The MIT License (MIT)\n * \n * Copyright (c) 2014 Petka Antonov\n * \n * Permission is hereby granted, free of charge, to any person obtaining a copy\n * of this software and associated documentation files (the \"Software\"), to deal\n * in the Software without restriction, including without limitation the rights\n * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell\n * copies of the Software, and to permit persons to whom the Software is\n * furnished to do so, subject to the following conditions:</p>\n * \n * The above copyright notice and this permission notice shall be included in\n * all copies or substantial portions of the Software.\n * \n * THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT.  IN NO EVENT SHALL THE\n * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\n * THE SOFTWARE.\n * \n */\n\"use strict\";\nvar schedule = require(\"./schedule.js\");\nvar Queue = require(\"./queue.js\");\nvar errorObj = require(\"./util.js\").errorObj;\nvar tryCatch1 = require(\"./util.js\").tryCatch1;\nvar _process = typeof process !== \"undefined\" ? process : void 0;\n\nfunction Async() {\n    this._isTickUsed = false;\n    this._schedule = schedule;\n    this._length = 0;\n    this._lateBuffer = new Queue(16);\n    this._functionBuffer = new Queue(65536);\n    var self = this;\n    this.consumeFunctionBuffer = function Async$consumeFunctionBuffer() {\n        self._consumeFunctionBuffer();\n    };\n}\n\nAsync.prototype.haveItemsQueued = function Async$haveItemsQueued() {\n    return this._length > 0;\n};\n\nAsync.prototype.invokeLater = function Async$invokeLater(fn, receiver, arg) {\n    if (_process !== void 0 &&\n        _process.domain != null &&\n        !fn.domain) {\n        fn = _process.domain.bind(fn);\n    }\n    this._lateBuffer.push(fn, receiver, arg);\n    this._queueTick();\n};\n\nAsync.prototype.invoke = function Async$invoke(fn, receiver, arg) {\n    if (_process !== void 0 &&\n        _process.domain != null &&\n        !fn.domain) {\n        fn = _process.domain.bind(fn);\n    }\n    var functionBuffer = this._functionBuffer;\n    functionBuffer.push(fn, receiver, arg);\n    this._length = functionBuffer.length();\n    this._queueTick();\n};\n\nAsync.prototype._consumeFunctionBuffer =\nfunction Async$_consumeFunctionBuffer() {\n    var functionBuffer = this._functionBuffer;\n    while (functionBuffer.length() > 0) {\n        var fn = functionBuffer.shift();\n        var receiver = functionBuffer.shift();\n        var arg = functionBuffer.shift();\n        fn.call(receiver, arg);\n    }\n    this._reset();\n    this._consumeLateBuffer();\n};\n\nAsync.prototype._consumeLateBuffer = function Async$_consumeLateBuffer() {\n    var buffer = this._lateBuffer;\n    while(buffer.length() > 0) {\n        var fn = buffer.shift();\n        var receiver = buffer.shift();\n        var arg = buffer.shift();\n        var res = tryCatch1(fn, receiver, arg);\n        if (res === errorObj) {\n            this._queueTick();\n            if (fn.domain != null) {\n                fn.domain.emit(\"error\", res.e);\n            } else {\n                throw res.e;\n            }\n        }\n    }\n};\n\nAsync.prototype._queueTick = function Async$_queue() {\n    if (!this._isTickUsed) {\n        this._schedule(this.consumeFunctionBuffer);\n        this._isTickUsed = true;\n    }\n};\n\nAsync.prototype._reset = function Async$_reset() {\n    this._isTickUsed = false;\n    this._length = 0;\n};\n\nmodule.exports = new Async();\n","/**\n * The MIT License (MIT)\n * \n * Copyright (c) 2014 Petka Antonov\n * \n * Permission is hereby granted, free of charge, to any person obtaining a copy\n * of this software and associated documentation files (the \"Software\"), to deal\n * in the Software without restriction, including without limitation the rights\n * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell\n * copies of the Software, and to permit persons to whom the Software is\n * furnished to do so, subject to the following conditions:</p>\n * \n * The above copyright notice and this permission notice shall be included in\n * all copies or substantial portions of the Software.\n * \n * THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT.  IN NO EVENT SHALL THE\n * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\n * THE SOFTWARE.\n * \n */\n\"use strict\";\nvar Objectfreeze = require(\"./es5.js\").freeze;\nvar util = require(\"./util.js\");\nvar inherits = util.inherits;\nvar notEnumerableProp = util.notEnumerableProp;\n\nfunction markAsOriginatingFromRejection(e) {\n    try {\n        notEnumerableProp(e, \"isOperational\", true);\n    }\n    catch(ignore) {}\n}\n\nfunction originatesFromRejection(e) {\n    if (e == null) return false;\n    return ((e instanceof OperationalError) ||\n        e[\"isOperational\"] === true);\n}\n\nfunction isError(obj) {\n    return obj instanceof Error;\n}\n\nfunction canAttach(obj) {\n    return isError(obj);\n}\n\nfunction subError(nameProperty, defaultMessage) {\n    function SubError(message) {\n        if (!(this instanceof SubError)) return new SubError(message);\n        this.message = typeof message === \"string\" ? message : defaultMessage;\n        this.name = nameProperty;\n        if (Error.captureStackTrace) {\n            Error.captureStackTrace(this, this.constructor);\n        }\n    }\n    inherits(SubError, Error);\n    return SubError;\n}\n\nvar _TypeError, _RangeError;\nvar CancellationError = subError(\"CancellationError\", \"cancellation error\");\nvar TimeoutError = subError(\"TimeoutError\", \"timeout error\");\nvar AggregateError = subError(\"AggregateError\", \"aggregate error\");\ntry {\n    _TypeError = TypeError;\n    _RangeError = RangeError;\n} catch(e) {\n    _TypeError = subError(\"TypeError\", \"type error\");\n    _RangeError = subError(\"RangeError\", \"range error\");\n}\n\nvar methods = (\"join pop push shift unshift slice filter forEach some \" +\n    \"every map indexOf lastIndexOf reduce reduceRight sort reverse\").split(\" \");\n\nfor (var i = 0; i < methods.length; ++i) {\n    if (typeof Array.prototype[methods[i]] === \"function\") {\n        AggregateError.prototype[methods[i]] = Array.prototype[methods[i]];\n    }\n}\n\nAggregateError.prototype.length = 0;\nAggregateError.prototype[\"isOperational\"] = true;\nvar level = 0;\nAggregateError.prototype.toString = function() {\n    var indent = Array(level * 4 + 1).join(\" \");\n    var ret = \"\\n\" + indent + \"AggregateError of:\" + \"\\n\";\n    level++;\n    indent = Array(level * 4 + 1).join(\" \");\n    for (var i = 0; i < this.length; ++i) {\n        var str = this[i] === this ? \"[Circular AggregateError]\" : this[i] + \"\";\n        var lines = str.split(\"\\n\");\n        for (var j = 0; j < lines.length; ++j) {\n            lines[j] = indent + lines[j];\n        }\n        str = lines.join(\"\\n\");\n        ret += str + \"\\n\";\n    }\n    level--;\n    return ret;\n};\n\nfunction OperationalError(message) {\n    this.name = \"OperationalError\";\n    this.message = message;\n    this.cause = message;\n    this[\"isOperational\"] = true;\n\n    if (message instanceof Error) {\n        this.message = message.message;\n        this.stack = message.stack;\n    } else if (Error.captureStackTrace) {\n        Error.captureStackTrace(this, this.constructor);\n    }\n\n}\ninherits(OperationalError, Error);\n\nvar key = \"__BluebirdErrorTypes__\";\nvar errorTypes = Error[key];\nif (!errorTypes) {\n    errorTypes = Objectfreeze({\n        CancellationError: CancellationError,\n        TimeoutError: TimeoutError,\n        OperationalError: OperationalError,\n        RejectionError: OperationalError,\n        AggregateError: AggregateError\n    });\n    notEnumerableProp(Error, key, errorTypes);\n}\n\nmodule.exports = {\n    Error: Error,\n    TypeError: _TypeError,\n    RangeError: _RangeError,\n    CancellationError: errorTypes.CancellationError,\n    OperationalError: errorTypes.OperationalError,\n    TimeoutError: errorTypes.TimeoutError,\n    AggregateError: errorTypes.AggregateError,\n    originatesFromRejection: originatesFromRejection,\n    markAsOriginatingFromRejection: markAsOriginatingFromRejection,\n    canAttach: canAttach\n};\n","/**\n * The MIT License (MIT)\n * \n * Copyright (c) 2014 Petka Antonov\n * \n * Permission is hereby granted, free of charge, to any person obtaining a copy\n * of this software and associated documentation files (the \"Software\"), to deal\n * in the Software without restriction, including without limitation the rights\n * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell\n * copies of the Software, and to permit persons to whom the Software is\n * furnished to do so, subject to the following conditions:</p>\n * \n * The above copyright notice and this permission notice shall be included in\n * all copies or substantial portions of the Software.\n * \n * THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT.  IN NO EVENT SHALL THE\n * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\n * THE SOFTWARE.\n * \n */\n\"use strict\";\nmodule.exports = function(Promise, INTERNAL) {\nvar util = require(\"./util.js\");\nvar canAttach = require(\"./errors.js\").canAttach;\nvar errorObj = util.errorObj;\nvar isObject = util.isObject;\n\nfunction getThen(obj) {\n    try {\n        return obj.then;\n    }\n    catch(e) {\n        errorObj.e = e;\n        return errorObj;\n    }\n}\n\nfunction Promise$_Cast(obj, originalPromise) {\n    if (isObject(obj)) {\n        if (obj instanceof Promise) {\n            return obj;\n        }\n        else if (isAnyBluebirdPromise(obj)) {\n            var ret = new Promise(INTERNAL);\n            ret._setTrace(void 0);\n            obj._then(\n                ret._fulfillUnchecked,\n                ret._rejectUncheckedCheckError,\n                ret._progressUnchecked,\n                ret,\n                null\n            );\n            ret._setFollowing();\n            return ret;\n        }\n        var then = getThen(obj);\n        if (then === errorObj) {\n            if (originalPromise !== void 0 && canAttach(then.e)) {\n                originalPromise._attachExtraTrace(then.e);\n            }\n            return Promise.reject(then.e);\n        } else if (typeof then === \"function\") {\n            return Promise$_doThenable(obj, then, originalPromise);\n        }\n    }\n    return obj;\n}\n\nvar hasProp = {}.hasOwnProperty;\nfunction isAnyBluebirdPromise(obj) {\n    return hasProp.call(obj, \"_promise0\");\n}\n\nfunction Promise$_doThenable(x, then, originalPromise) {\n    var resolver = Promise.defer();\n    var called = false;\n    try {\n        then.call(\n            x,\n            Promise$_resolveFromThenable,\n            Promise$_rejectFromThenable,\n            Promise$_progressFromThenable\n        );\n    } catch(e) {\n        if (!called) {\n            called = true;\n            var trace = canAttach(e) ? e : new Error(e + \"\");\n            if (originalPromise !== void 0) {\n                originalPromise._attachExtraTrace(trace);\n            }\n            resolver.promise._reject(e, trace);\n        }\n    }\n    return resolver.promise;\n\n    function Promise$_resolveFromThenable(y) {\n        if (called) return;\n        called = true;\n\n        if (x === y) {\n            var e = Promise._makeSelfResolutionError();\n            if (originalPromise !== void 0) {\n                originalPromise._attachExtraTrace(e);\n            }\n            resolver.promise._reject(e, void 0);\n            return;\n        }\n        resolver.resolve(y);\n    }\n\n    function Promise$_rejectFromThenable(r) {\n        if (called) return;\n        called = true;\n        var trace = canAttach(r) ? r : new Error(r + \"\");\n        if (originalPromise !== void 0) {\n            originalPromise._attachExtraTrace(trace);\n        }\n        resolver.promise._reject(r, trace);\n    }\n\n    function Promise$_progressFromThenable(v) {\n        if (called) return;\n        var promise = resolver.promise;\n        if (typeof promise._progress === \"function\") {\n            promise._progress(v);\n        }\n    }\n}\n\nreturn Promise$_Cast;\n};\n","/**\n * The MIT License (MIT)\n * \n * Copyright (c) 2014 Petka Antonov\n * \n * Permission is hereby granted, free of charge, to any person obtaining a copy\n * of this software and associated documentation files (the \"Software\"), to deal\n * in the Software without restriction, including without limitation the rights\n * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell\n * copies of the Software, and to permit persons to whom the Software is\n * furnished to do so, subject to the following conditions:</p>\n * \n * The above copyright notice and this permission notice shall be included in\n * all copies or substantial portions of the Software.\n * \n * THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT.  IN NO EVENT SHALL THE\n * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\n * THE SOFTWARE.\n * \n */\n\"use strict\";\nmodule.exports = function(Promise, INTERNAL, cast) {\nvar canAttach = require(\"./errors.js\").canAttach;\nvar util = require(\"./util.js\");\nvar isArray = util.isArray;\n\nfunction toResolutionValue(val) {\n    switch(val) {\n    case -1: return void 0;\n    case -2: return [];\n    case -3: return {};\n    }\n}\n\nfunction PromiseArray(values) {\n    var promise = this._promise = new Promise(INTERNAL);\n    var parent = void 0;\n    if (values instanceof Promise) {\n        parent = values;\n        promise._propagateFrom(parent, 1 | 4);\n    }\n    promise._setTrace(parent);\n    this._values = values;\n    this._length = 0;\n    this._totalResolved = 0;\n    this._init(void 0, -2);\n}\nPromiseArray.prototype.length = function PromiseArray$length() {\n    return this._length;\n};\n\nPromiseArray.prototype.promise = function PromiseArray$promise() {\n    return this._promise;\n};\n\nPromiseArray.prototype._init =\nfunction PromiseArray$_init(_, resolveValueIfEmpty) {\n    var values = cast(this._values, void 0);\n    if (values instanceof Promise) {\n        this._values = values;\n        values._setBoundTo(this._promise._boundTo);\n        if (values.isFulfilled()) {\n            values = values._settledValue;\n            if (!isArray(values)) {\n                var err = new Promise.TypeError(\"expecting an array, a promise or a thenable\");\n                this.__hardReject__(err);\n                return;\n            }\n        } else if (values.isPending()) {\n            values._then(\n                PromiseArray$_init,\n                this._reject,\n                void 0,\n                this,\n                resolveValueIfEmpty\n           );\n            return;\n        } else {\n            values._unsetRejectionIsUnhandled();\n            this._reject(values._settledValue);\n            return;\n        }\n    } else if (!isArray(values)) {\n        var err = new Promise.TypeError(\"expecting an array, a promise or a thenable\");\n        this.__hardReject__(err);\n        return;\n    }\n\n    if (values.length === 0) {\n        if (resolveValueIfEmpty === -5) {\n            this._resolveEmptyArray();\n        }\n        else {\n            this._resolve(toResolutionValue(resolveValueIfEmpty));\n        }\n        return;\n    }\n    var len = this.getActualLength(values.length);\n    var newLen = len;\n    var newValues = this.shouldCopyValues() ? new Array(len) : this._values;\n    var isDirectScanNeeded = false;\n    for (var i = 0; i < len; ++i) {\n        var maybePromise = cast(values[i], void 0);\n        if (maybePromise instanceof Promise) {\n            if (maybePromise.isPending()) {\n                maybePromise._proxyPromiseArray(this, i);\n            } else {\n                maybePromise._unsetRejectionIsUnhandled();\n                isDirectScanNeeded = true;\n            }\n        } else {\n            isDirectScanNeeded = true;\n        }\n        newValues[i] = maybePromise;\n    }\n    this._values = newValues;\n    this._length = newLen;\n    if (isDirectScanNeeded) {\n        this._scanDirectValues(len);\n    }\n};\n\nPromiseArray.prototype._settlePromiseAt =\nfunction PromiseArray$_settlePromiseAt(index) {\n    var value = this._values[index];\n    if (!(value instanceof Promise)) {\n        this._promiseFulfilled(value, index);\n    } else if (value.isFulfilled()) {\n        this._promiseFulfilled(value._settledValue, index);\n    } else if (value.isRejected()) {\n        this._promiseRejected(value._settledValue, index);\n    }\n};\n\nPromiseArray.prototype._scanDirectValues =\nfunction PromiseArray$_scanDirectValues(len) {\n    for (var i = 0; i < len; ++i) {\n        if (this._isResolved()) {\n            break;\n        }\n        this._settlePromiseAt(i);\n    }\n};\n\nPromiseArray.prototype._isResolved = function PromiseArray$_isResolved() {\n    return this._values === null;\n};\n\nPromiseArray.prototype._resolve = function PromiseArray$_resolve(value) {\n    this._values = null;\n    this._promise._fulfill(value);\n};\n\nPromiseArray.prototype.__hardReject__ =\nPromiseArray.prototype._reject = function PromiseArray$_reject(reason) {\n    this._values = null;\n    var trace = canAttach(reason) ? reason : new Error(reason + \"\");\n    this._promise._attachExtraTrace(trace);\n    this._promise._reject(reason, trace);\n};\n\nPromiseArray.prototype._promiseProgressed =\nfunction PromiseArray$_promiseProgressed(progressValue, index) {\n    if (this._isResolved()) return;\n    this._promise._progress({\n        index: index,\n        value: progressValue\n    });\n};\n\n\nPromiseArray.prototype._promiseFulfilled =\nfunction PromiseArray$_promiseFulfilled(value, index) {\n    if (this._isResolved()) return;\n    this._values[index] = value;\n    var totalResolved = ++this._totalResolved;\n    if (totalResolved >= this._length) {\n        this._resolve(this._values);\n    }\n};\n\nPromiseArray.prototype._promiseRejected =\nfunction PromiseArray$_promiseRejected(reason, index) {\n    if (this._isResolved()) return;\n    this._totalResolved++;\n    this._reject(reason);\n};\n\nPromiseArray.prototype.shouldCopyValues =\nfunction PromiseArray$_shouldCopyValues() {\n    return true;\n};\n\nPromiseArray.prototype.getActualLength =\nfunction PromiseArray$getActualLength(len) {\n    return len;\n};\n\nreturn PromiseArray;\n};\n","/**\n * The MIT License (MIT)\n * \n * Copyright (c) 2014 Petka Antonov\n * \n * Permission is hereby granted, free of charge, to any person obtaining a copy\n * of this software and associated documentation files (the \"Software\"), to deal\n * in the Software without restriction, including without limitation the rights\n * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell\n * copies of the Software, and to permit persons to whom the Software is\n * furnished to do so, subject to the following conditions:</p>\n * \n * The above copyright notice and this permission notice shall be included in\n * all copies or substantial portions of the Software.\n * \n * THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT.  IN NO EVENT SHALL THE\n * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\n * THE SOFTWARE.\n * \n */\n\"use strict\";\nmodule.exports = function() {\nvar inherits = require(\"./util.js\").inherits;\nvar defineProperty = require(\"./es5.js\").defineProperty;\n\nvar rignore = new RegExp(\n    \"\\\\b(?:[a-zA-Z0-9.]+\\\\$_\\\\w+|\" +\n    \"tryCatch(?:1|2|3|4|Apply)|new \\\\w*PromiseArray|\" +\n    \"\\\\w*PromiseArray\\\\.\\\\w*PromiseArray|\" +\n    \"setTimeout|CatchFilter\\\\$_\\\\w+|makeNodePromisified|processImmediate|\" +\n    \"process._tickCallback|nextTick|Async\\\\$\\\\w+)\\\\b\"\n);\n\nvar rtraceline = null;\nvar formatStack = null;\n\nfunction formatNonError(obj) {\n    var str;\n    if (typeof obj === \"function\") {\n        str = \"[function \" +\n            (obj.name || \"anonymous\") +\n            \"]\";\n    } else {\n        str = obj.toString();\n        var ruselessToString = /\\[object [a-zA-Z0-9$_]+\\]/;\n        if (ruselessToString.test(str)) {\n            try {\n                var newStr = JSON.stringify(obj);\n                str = newStr;\n            }\n            catch(e) {\n\n            }\n        }\n        if (str.length === 0) {\n            str = \"(empty array)\";\n        }\n    }\n    return (\"(<\" + snip(str) + \">, no stack trace)\");\n}\n\nfunction snip(str) {\n    var maxChars = 41;\n    if (str.length < maxChars) {\n        return str;\n    }\n    return str.substr(0, maxChars - 3) + \"...\";\n}\n\nfunction CapturedTrace(ignoreUntil, isTopLevel) {\n    this.captureStackTrace(CapturedTrace, isTopLevel);\n\n}\ninherits(CapturedTrace, Error);\n\nCapturedTrace.prototype.captureStackTrace =\nfunction CapturedTrace$captureStackTrace(ignoreUntil, isTopLevel) {\n    captureStackTrace(this, ignoreUntil, isTopLevel);\n};\n\nCapturedTrace.possiblyUnhandledRejection =\nfunction CapturedTrace$PossiblyUnhandledRejection(reason) {\n    if (typeof console === \"object\") {\n        var message;\n        if (typeof reason === \"object\" || typeof reason === \"function\") {\n            var stack = reason.stack;\n            message = \"Possibly unhandled \" + formatStack(stack, reason);\n        } else {\n            message = \"Possibly unhandled \" + String(reason);\n        }\n        if (typeof console.error === \"function\" ||\n            typeof console.error === \"object\") {\n            console.error(message);\n        } else if (typeof console.log === \"function\" ||\n            typeof console.log === \"object\") {\n            console.log(message);\n        }\n    }\n};\n\nCapturedTrace.combine = function CapturedTrace$Combine(current, prev) {\n    var curLast = current.length - 1;\n    for (var i = prev.length - 1; i >= 0; --i) {\n        var line = prev[i];\n        if (current[curLast] === line) {\n            current.pop();\n            curLast--;\n        } else {\n            break;\n        }\n    }\n\n    current.push(\"From previous event:\");\n    var lines = current.concat(prev);\n\n    var ret = [];\n\n    for (var i = 0, len = lines.length; i < len; ++i) {\n\n        if (((rignore.test(lines[i]) && rtraceline.test(lines[i])) ||\n            (i > 0 && !rtraceline.test(lines[i])) &&\n            lines[i] !== \"From previous event:\")\n       ) {\n            continue;\n        }\n        ret.push(lines[i]);\n    }\n    return ret;\n};\n\nCapturedTrace.protectErrorMessageNewlines = function(stack) {\n    for (var i = 0; i < stack.length; ++i) {\n        if (rtraceline.test(stack[i])) {\n            break;\n        }\n    }\n\n    if (i <= 1) return;\n\n    var errorMessageLines = [];\n    for (var j = 0; j < i; ++j) {\n        errorMessageLines.push(stack.shift());\n    }\n    stack.unshift(errorMessageLines.join(\"\\u0002\\u0000\\u0001\"));\n};\n\nCapturedTrace.isSupported = function CapturedTrace$IsSupported() {\n    return typeof captureStackTrace === \"function\";\n};\n\nvar captureStackTrace = (function stackDetection() {\n    if (typeof Error.stackTraceLimit === \"number\" &&\n        typeof Error.captureStackTrace === \"function\") {\n        rtraceline = /^\\s*at\\s*/;\n        formatStack = function(stack, error) {\n            if (typeof stack === \"string\") return stack;\n\n            if (error.name !== void 0 &&\n                error.message !== void 0) {\n                return error.name + \". \" + error.message;\n            }\n            return formatNonError(error);\n\n\n        };\n        var captureStackTrace = Error.captureStackTrace;\n        return function CapturedTrace$_captureStackTrace(\n            receiver, ignoreUntil) {\n            captureStackTrace(receiver, ignoreUntil);\n        };\n    }\n    var err = new Error();\n\n    if (typeof err.stack === \"string\" &&\n        typeof \"\".startsWith === \"function\" &&\n        (err.stack.startsWith(\"stackDetection@\")) &&\n        stackDetection.name === \"stackDetection\") {\n\n        defineProperty(Error, \"stackTraceLimit\", {\n            writable: true,\n            enumerable: false,\n            configurable: false,\n            value: 25\n        });\n        rtraceline = /@/;\n        var rline = /[@\\n]/;\n\n        formatStack = function(stack, error) {\n            if (typeof stack === \"string\") {\n                return (error.name + \". \" + error.message + \"\\n\" + stack);\n            }\n\n            if (error.name !== void 0 &&\n                error.message !== void 0) {\n                return error.name + \". \" + error.message;\n            }\n            return formatNonError(error);\n        };\n\n        return function captureStackTrace(o) {\n            var stack = new Error().stack;\n            var split = stack.split(rline);\n            var len = split.length;\n            var ret = \"\";\n            for (var i = 0; i < len; i += 2) {\n                ret += split[i];\n                ret += \"@\";\n                ret += split[i + 1];\n                ret += \"\\n\";\n            }\n            o.stack = ret;\n        };\n    } else {\n        formatStack = function(stack, error) {\n            if (typeof stack === \"string\") return stack;\n\n            if ((typeof error === \"object\" ||\n                typeof error === \"function\") &&\n                error.name !== void 0 &&\n                error.message !== void 0) {\n                return error.name + \". \" + error.message;\n            }\n            return formatNonError(error);\n        };\n\n        return null;\n    }\n})();\n\nreturn CapturedTrace;\n};\n","/**\n * The MIT License (MIT)\n * \n * Copyright (c) 2014 Petka Antonov\n * \n * Permission is hereby granted, free of charge, to any person obtaining a copy\n * of this software and associated documentation files (the \"Software\"), to deal\n * in the Software without restriction, including without limitation the rights\n * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell\n * copies of the Software, and to permit persons to whom the Software is\n * furnished to do so, subject to the following conditions:</p>\n * \n * The above copyright notice and this permission notice shall be included in\n * all copies or substantial portions of the Software.\n * \n * THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT.  IN NO EVENT SHALL THE\n * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\n * THE SOFTWARE.\n * \n */\n\"use strict\";\nmodule.exports = function(NEXT_FILTER) {\nvar util = require(\"./util.js\");\nvar errors = require(\"./errors.js\");\nvar tryCatch1 = util.tryCatch1;\nvar errorObj = util.errorObj;\nvar keys = require(\"./es5.js\").keys;\nvar TypeError = errors.TypeError;\n\nfunction CatchFilter(instances, callback, promise) {\n    this._instances = instances;\n    this._callback = callback;\n    this._promise = promise;\n}\n\nfunction CatchFilter$_safePredicate(predicate, e) {\n    var safeObject = {};\n    var retfilter = tryCatch1(predicate, safeObject, e);\n\n    if (retfilter === errorObj) return retfilter;\n\n    var safeKeys = keys(safeObject);\n    if (safeKeys.length) {\n        errorObj.e = new TypeError(\n            \"Catch filter must inherit from Error \"\n          + \"or be a simple predicate function\");\n        return errorObj;\n    }\n    return retfilter;\n}\n\nCatchFilter.prototype.doFilter = function CatchFilter$_doFilter(e) {\n    var cb = this._callback;\n    var promise = this._promise;\n    var boundTo = promise._boundTo;\n    for (var i = 0, len = this._instances.length; i < len; ++i) {\n        var item = this._instances[i];\n        var itemIsErrorType = item === Error ||\n            (item != null && item.prototype instanceof Error);\n\n        if (itemIsErrorType && e instanceof item) {\n            var ret = tryCatch1(cb, boundTo, e);\n            if (ret === errorObj) {\n                NEXT_FILTER.e = ret.e;\n                return NEXT_FILTER;\n            }\n            return ret;\n        } else if (typeof item === \"function\" && !itemIsErrorType) {\n            var shouldHandle = CatchFilter$_safePredicate(item, e);\n            if (shouldHandle === errorObj) {\n                var trace = errors.canAttach(errorObj.e)\n                    ? errorObj.e\n                    : new Error(errorObj.e + \"\");\n                this._promise._attachExtraTrace(trace);\n                e = errorObj.e;\n                break;\n            } else if (shouldHandle) {\n                var ret = tryCatch1(cb, boundTo, e);\n                if (ret === errorObj) {\n                    NEXT_FILTER.e = ret.e;\n                    return NEXT_FILTER;\n                }\n                return ret;\n            }\n        }\n    }\n    NEXT_FILTER.e = e;\n    return NEXT_FILTER;\n};\n\nreturn CatchFilter;\n};\n","/**\n * The MIT License (MIT)\n * \n * Copyright (c) 2014 Petka Antonov\n * \n * Permission is hereby granted, free of charge, to any person obtaining a copy\n * of this software and associated documentation files (the \"Software\"), to deal\n * in the Software without restriction, including without limitation the rights\n * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell\n * copies of the Software, and to permit persons to whom the Software is\n * furnished to do so, subject to the following conditions:</p>\n * \n * The above copyright notice and this permission notice shall be included in\n * all copies or substantial portions of the Software.\n * \n * THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT.  IN NO EVENT SHALL THE\n * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\n * THE SOFTWARE.\n * \n */\n\"use strict\";\nvar util = require(\"./util.js\");\nvar maybeWrapAsError = util.maybeWrapAsError;\nvar errors = require(\"./errors.js\");\nvar TimeoutError = errors.TimeoutError;\nvar OperationalError = errors.OperationalError;\nvar async = require(\"./async.js\");\nvar haveGetters = util.haveGetters;\nvar es5 = require(\"./es5.js\");\n\nfunction isUntypedError(obj) {\n    return obj instanceof Error &&\n        es5.getPrototypeOf(obj) === Error.prototype;\n}\n\nfunction wrapAsOperationalError(obj) {\n    var ret;\n    if (isUntypedError(obj)) {\n        ret = new OperationalError(obj);\n    } else {\n        ret = obj;\n    }\n    errors.markAsOriginatingFromRejection(ret);\n    return ret;\n}\n\nfunction nodebackForPromise(promise) {\n    function PromiseResolver$_callback(err, value) {\n        if (promise === null) return;\n\n        if (err) {\n            var wrapped = wrapAsOperationalError(maybeWrapAsError(err));\n            promise._attachExtraTrace(wrapped);\n            promise._reject(wrapped);\n        } else if (arguments.length > 2) {\n            var $_len = arguments.length;var args = new Array($_len - 1); for(var $_i = 1; $_i < $_len; ++$_i) {args[$_i - 1] = arguments[$_i];}\n            promise._fulfill(args);\n        } else {\n            promise._fulfill(value);\n        }\n\n        promise = null;\n    }\n    return PromiseResolver$_callback;\n}\n\n\nvar PromiseResolver;\nif (!haveGetters) {\n    PromiseResolver = function PromiseResolver(promise) {\n        this.promise = promise;\n        this.asCallback = nodebackForPromise(promise);\n        this.callback = this.asCallback;\n    };\n}\nelse {\n    PromiseResolver = function PromiseResolver(promise) {\n        this.promise = promise;\n    };\n}\nif (haveGetters) {\n    var prop = {\n        get: function() {\n            return nodebackForPromise(this.promise);\n        }\n    };\n    es5.defineProperty(PromiseResolver.prototype, \"asCallback\", prop);\n    es5.defineProperty(PromiseResolver.prototype, \"callback\", prop);\n}\n\nPromiseResolver._nodebackForPromise = nodebackForPromise;\n\nPromiseResolver.prototype.toString = function PromiseResolver$toString() {\n    return \"[object PromiseResolver]\";\n};\n\nPromiseResolver.prototype.resolve =\nPromiseResolver.prototype.fulfill = function PromiseResolver$resolve(value) {\n    if (!(this instanceof PromiseResolver)) {\n        throw new TypeError(\"Illegal invocation, resolver resolve/reject must be called within a resolver context. Consider using the promise constructor instead.\");\n    }\n\n    var promise = this.promise;\n    if (promise._tryFollow(value)) {\n        return;\n    }\n    async.invoke(promise._fulfill, promise, value);\n};\n\nPromiseResolver.prototype.reject = function PromiseResolver$reject(reason) {\n    if (!(this instanceof PromiseResolver)) {\n        throw new TypeError(\"Illegal invocation, resolver resolve/reject must be called within a resolver context. Consider using the promise constructor instead.\");\n    }\n\n    var promise = this.promise;\n    errors.markAsOriginatingFromRejection(reason);\n    var trace = errors.canAttach(reason) ? reason : new Error(reason + \"\");\n    promise._attachExtraTrace(trace);\n    async.invoke(promise._reject, promise, reason);\n    if (trace !== reason) {\n        async.invoke(this._setCarriedStackTrace, this, trace);\n    }\n};\n\nPromiseResolver.prototype.progress =\nfunction PromiseResolver$progress(value) {\n    if (!(this instanceof PromiseResolver)) {\n        throw new TypeError(\"Illegal invocation, resolver resolve/reject must be called within a resolver context. Consider using the promise constructor instead.\");\n    }\n    async.invoke(this.promise._progress, this.promise, value);\n};\n\nPromiseResolver.prototype.cancel = function PromiseResolver$cancel() {\n    async.invoke(this.promise.cancel, this.promise, void 0);\n};\n\nPromiseResolver.prototype.timeout = function PromiseResolver$timeout() {\n    this.reject(new TimeoutError(\"timeout\"));\n};\n\nPromiseResolver.prototype.isResolved = function PromiseResolver$isResolved() {\n    return this.promise.isResolved();\n};\n\nPromiseResolver.prototype.toJSON = function PromiseResolver$toJSON() {\n    return this.promise.toJSON();\n};\n\nPromiseResolver.prototype._setCarriedStackTrace =\nfunction PromiseResolver$_setCarriedStackTrace(trace) {\n    if (this.promise.isRejected()) {\n        this.promise._setCarriedStackTrace(trace);\n    }\n};\n\nmodule.exports = PromiseResolver;\n","/**\n * The MIT License (MIT)\n * \n * Copyright (c) 2014 Petka Antonov\n * \n * Permission is hereby granted, free of charge, to any person obtaining a copy\n * of this software and associated documentation files (the \"Software\"), to deal\n * in the Software without restriction, including without limitation the rights\n * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell\n * copies of the Software, and to permit persons to whom the Software is\n * furnished to do so, subject to the following conditions:</p>\n * \n * The above copyright notice and this permission notice shall be included in\n * all copies or substantial portions of the Software.\n * \n * THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT.  IN NO EVENT SHALL THE\n * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\n * THE SOFTWARE.\n * \n */\n\"use strict\";\nmodule.exports = function(Promise, NEXT_FILTER, cast) {\nvar util = require(\"./util.js\");\nvar wrapsPrimitiveReceiver = util.wrapsPrimitiveReceiver;\nvar isPrimitive = util.isPrimitive;\nvar thrower = util.thrower;\n\nfunction returnThis() {\n    return this;\n}\nfunction throwThis() {\n    throw this;\n}\nfunction return$(r) {\n    return function Promise$_returner() {\n        return r;\n    };\n}\nfunction throw$(r) {\n    return function Promise$_thrower() {\n        throw r;\n    };\n}\nfunction promisedFinally(ret, reasonOrValue, isFulfilled) {\n    var then;\n    if (wrapsPrimitiveReceiver && isPrimitive(reasonOrValue)) {\n        then = isFulfilled ? return$(reasonOrValue) : throw$(reasonOrValue);\n    } else {\n        then = isFulfilled ? returnThis : throwThis;\n    }\n    return ret._then(then, thrower, void 0, reasonOrValue, void 0);\n}\n\nfunction finallyHandler(reasonOrValue) {\n    var promise = this.promise;\n    var handler = this.handler;\n\n    var ret = promise._isBound()\n                    ? handler.call(promise._boundTo)\n                    : handler();\n\n    if (ret !== void 0) {\n        var maybePromise = cast(ret, void 0);\n        if (maybePromise instanceof Promise) {\n            return promisedFinally(maybePromise, reasonOrValue,\n                                    promise.isFulfilled());\n        }\n    }\n\n    if (promise.isRejected()) {\n        NEXT_FILTER.e = reasonOrValue;\n        return NEXT_FILTER;\n    } else {\n        return reasonOrValue;\n    }\n}\n\nfunction tapHandler(value) {\n    var promise = this.promise;\n    var handler = this.handler;\n\n    var ret = promise._isBound()\n                    ? handler.call(promise._boundTo, value)\n                    : handler(value);\n\n    if (ret !== void 0) {\n        var maybePromise = cast(ret, void 0);\n        if (maybePromise instanceof Promise) {\n            return promisedFinally(maybePromise, value, true);\n        }\n    }\n    return value;\n}\n\nPromise.prototype._passThroughHandler =\nfunction Promise$_passThroughHandler(handler, isFinally) {\n    if (typeof handler !== \"function\") return this.then();\n\n    var promiseAndHandler = {\n        promise: this,\n        handler: handler\n    };\n\n    return this._then(\n            isFinally ? finallyHandler : tapHandler,\n            isFinally ? finallyHandler : void 0, void 0,\n            promiseAndHandler, void 0);\n};\n\nPromise.prototype.lastly =\nPromise.prototype[\"finally\"] = function Promise$finally(handler) {\n    return this._passThroughHandler(handler, true);\n};\n\nPromise.prototype.tap = function Promise$tap(handler) {\n    return this._passThroughHandler(handler, false);\n};\n};\n","/**\n * The MIT License (MIT)\n * \n * Copyright (c) 2014 Petka Antonov\n * \n * Permission is hereby granted, free of charge, to any person obtaining a copy\n * of this software and associated documentation files (the \"Software\"), to deal\n * in the Software without restriction, including without limitation the rights\n * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell\n * copies of the Software, and to permit persons to whom the Software is\n * furnished to do so, subject to the following conditions:</p>\n * \n * The above copyright notice and this permission notice shall be included in\n * all copies or substantial portions of the Software.\n * \n * THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT.  IN NO EVENT SHALL THE\n * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\n * THE SOFTWARE.\n * \n */\n\"use strict\";\nvar util = require(\"./util.js\");\nvar isPrimitive = util.isPrimitive;\nvar wrapsPrimitiveReceiver = util.wrapsPrimitiveReceiver;\n\nmodule.exports = function(Promise) {\nvar returner = function Promise$_returner() {\n    return this;\n};\nvar thrower = function Promise$_thrower() {\n    throw this;\n};\n\nvar wrapper = function Promise$_wrapper(value, action) {\n    if (action === 1) {\n        return function Promise$_thrower() {\n            throw value;\n        };\n    } else if (action === 2) {\n        return function Promise$_returner() {\n            return value;\n        };\n    }\n};\n\n\nPromise.prototype[\"return\"] =\nPromise.prototype.thenReturn =\nfunction Promise$thenReturn(value) {\n    if (wrapsPrimitiveReceiver && isPrimitive(value)) {\n        return this._then(\n            wrapper(value, 2),\n            void 0,\n            void 0,\n            void 0,\n            void 0\n       );\n    }\n    return this._then(returner, void 0, void 0, value, void 0);\n};\n\nPromise.prototype[\"throw\"] =\nPromise.prototype.thenThrow =\nfunction Promise$thenThrow(reason) {\n    if (wrapsPrimitiveReceiver && isPrimitive(reason)) {\n        return this._then(\n            wrapper(reason, 1),\n            void 0,\n            void 0,\n            void 0,\n            void 0\n       );\n    }\n    return this._then(thrower, void 0, void 0, reason, void 0);\n};\n};\n","/**\n * The MIT License (MIT)\n * \n * Copyright (c) 2014 Petka Antonov\n * \n * Permission is hereby granted, free of charge, to any person obtaining a copy\n * of this software and associated documentation files (the \"Software\"), to deal\n * in the Software without restriction, including without limitation the rights\n * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell\n * copies of the Software, and to permit persons to whom the Software is\n * furnished to do so, subject to the following conditions:</p>\n * \n * The above copyright notice and this permission notice shall be included in\n * all copies or substantial portions of the Software.\n * \n * THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT.  IN NO EVENT SHALL THE\n * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\n * THE SOFTWARE.\n * \n */\n\"use strict\";\nmodule.exports = function(Promise) {\nfunction PromiseInspection(promise) {\n    if (promise !== void 0) {\n        this._bitField = promise._bitField;\n        this._settledValue = promise.isResolved()\n            ? promise._settledValue\n            : void 0;\n    }\n    else {\n        this._bitField = 0;\n        this._settledValue = void 0;\n    }\n}\n\nPromiseInspection.prototype.isFulfilled =\nPromise.prototype.isFulfilled = function Promise$isFulfilled() {\n    return (this._bitField & 268435456) > 0;\n};\n\nPromiseInspection.prototype.isRejected =\nPromise.prototype.isRejected = function Promise$isRejected() {\n    return (this._bitField & 134217728) > 0;\n};\n\nPromiseInspection.prototype.isPending =\nPromise.prototype.isPending = function Promise$isPending() {\n    return (this._bitField & 402653184) === 0;\n};\n\nPromiseInspection.prototype.value =\nPromise.prototype.value = function Promise$value() {\n    if (!this.isFulfilled()) {\n        throw new TypeError(\"cannot get fulfillment value of a non-fulfilled promise\");\n    }\n    return this._settledValue;\n};\n\nPromiseInspection.prototype.error =\nPromiseInspection.prototype.reason =\nPromise.prototype.reason = function Promise$reason() {\n    if (!this.isRejected()) {\n        throw new TypeError(\"cannot get rejection reason of a non-rejected promise\");\n    }\n    return this._settledValue;\n};\n\nPromiseInspection.prototype.isResolved =\nPromise.prototype.isResolved = function Promise$isResolved() {\n    return (this._bitField & 402653184) > 0;\n};\n\nPromise.PromiseInspection = PromiseInspection;\n};\n","/**\n * The MIT License (MIT)\n * \n * Copyright (c) 2014 Petka Antonov\n * \n * Permission is hereby granted, free of charge, to any person obtaining a copy\n * of this software and associated documentation files (the \"Software\"), to deal\n * in the Software without restriction, including without limitation the rights\n * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell\n * copies of the Software, and to permit persons to whom the Software is\n * furnished to do so, subject to the following conditions:</p>\n * \n * The above copyright notice and this permission notice shall be included in\n * all copies or substantial portions of the Software.\n * \n * THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT.  IN NO EVENT SHALL THE\n * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\n * THE SOFTWARE.\n * \n */\n\"use strict\";\nmodule.exports =\nfunction(Promise, PromiseArray, cast, INTERNAL) {\nvar util = require(\"./util.js\");\nvar canEvaluate = util.canEvaluate;\nvar tryCatch1 = util.tryCatch1;\nvar errorObj = util.errorObj;\n\n\nif (canEvaluate) {\n    var thenCallback = function(i) {\n        return new Function(\"value\", \"holder\", \"                             \\n\\\n            'use strict';                                                    \\n\\\n            holder.pIndex = value;                                           \\n\\\n            holder.checkFulfillment(this);                                   \\n\\\n            \".replace(/Index/g, i));\n    };\n\n    var caller = function(count) {\n        var values = [];\n        for (var i = 1; i <= count; ++i) values.push(\"holder.p\" + i);\n        return new Function(\"holder\", \"                                      \\n\\\n            'use strict';                                                    \\n\\\n            var callback = holder.fn;                                        \\n\\\n            return callback(values);                                         \\n\\\n            \".replace(/values/g, values.join(\", \")));\n    };\n    var thenCallbacks = [];\n    var callers = [void 0];\n    for (var i = 1; i <= 5; ++i) {\n        thenCallbacks.push(thenCallback(i));\n        callers.push(caller(i));\n    }\n\n    var Holder = function(total, fn) {\n        this.p1 = this.p2 = this.p3 = this.p4 = this.p5 = null;\n        this.fn = fn;\n        this.total = total;\n        this.now = 0;\n    };\n\n    Holder.prototype.callers = callers;\n    Holder.prototype.checkFulfillment = function(promise) {\n        var now = this.now;\n        now++;\n        var total = this.total;\n        if (now >= total) {\n            var handler = this.callers[total];\n            var ret = tryCatch1(handler, void 0, this);\n            if (ret === errorObj) {\n                promise._rejectUnchecked(ret.e);\n            } else if (!promise._tryFollow(ret)) {\n                promise._fulfillUnchecked(ret);\n            }\n        } else {\n            this.now = now;\n        }\n    };\n}\n\n\n\n\nPromise.join = function Promise$Join() {\n    var last = arguments.length - 1;\n    var fn;\n    if (last > 0 && typeof arguments[last] === \"function\") {\n        fn = arguments[last];\n        if (last < 6 && canEvaluate) {\n            var ret = new Promise(INTERNAL);\n            ret._setTrace(void 0);\n            var holder = new Holder(last, fn);\n            var reject = ret._reject;\n            var callbacks = thenCallbacks;\n            for (var i = 0; i < last; ++i) {\n                var maybePromise = cast(arguments[i], void 0);\n                if (maybePromise instanceof Promise) {\n                    if (maybePromise.isPending()) {\n                        maybePromise._then(callbacks[i], reject,\n                                           void 0, ret, holder);\n                    } else if (maybePromise.isFulfilled()) {\n                        callbacks[i].call(ret,\n                                          maybePromise._settledValue, holder);\n                    } else {\n                        ret._reject(maybePromise._settledValue);\n                        maybePromise._unsetRejectionIsUnhandled();\n                    }\n                } else {\n                    callbacks[i].call(ret, maybePromise, holder);\n                }\n            }\n            return ret;\n        }\n    }\n    var $_len = arguments.length;var args = new Array($_len); for(var $_i = 0; $_i < $_len; ++$_i) {args[$_i] = arguments[$_i];}\n    var ret = new PromiseArray(args).promise();\n    return fn !== void 0 ? ret.spread(fn) : ret;\n};\n\n};\n","/**\n * The MIT License (MIT)\n * \n * Copyright (c) 2014 Petka Antonov\n * \n * Permission is hereby granted, free of charge, to any person obtaining a copy\n * of this software and associated documentation files (the \"Software\"), to deal\n * in the Software without restriction, including without limitation the rights\n * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell\n * copies of the Software, and to permit persons to whom the Software is\n * furnished to do so, subject to the following conditions:</p>\n * \n * The above copyright notice and this permission notice shall be included in\n * all copies or substantial portions of the Software.\n * \n * THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT.  IN NO EVENT SHALL THE\n * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\n * THE SOFTWARE.\n * \n */\n\"use strict\";\nvar _setTimeout = function(fn, ms) {\n    var len = arguments.length;\n    var arg0 = arguments[2];\n    var arg1 = arguments[3];\n    var arg2 = len >= 5 ? arguments[4] : void 0;\n    setTimeout(function() {\n        fn(arg0, arg1, arg2);\n    }, ms|0);\n};\n\nmodule.exports = function(Promise, INTERNAL, cast) {\nvar util = require(\"./util.js\");\nvar errors = require(\"./errors.js\");\nvar apiRejection = require(\"./errors_api_rejection\")(Promise);\nvar TimeoutError = Promise.TimeoutError;\n\nvar afterTimeout = function Promise$_afterTimeout(promise, message, ms) {\n    if (!promise.isPending()) return;\n    if (typeof message !== \"string\") {\n        message = \"operation timed out after\" + \" \" + ms + \" ms\"\n    }\n    var err = new TimeoutError(message);\n    errors.markAsOriginatingFromRejection(err);\n    promise._attachExtraTrace(err);\n    promise._cancel(err);\n};\n\nvar afterDelay = function Promise$_afterDelay(value, promise) {\n    promise._fulfill(value);\n};\n\nvar delay = Promise.delay = function Promise$Delay(value, ms) {\n    if (ms === void 0) {\n        ms = value;\n        value = void 0;\n    }\n    ms = +ms;\n    var maybePromise = cast(value, void 0);\n    var promise = new Promise(INTERNAL);\n\n    if (maybePromise instanceof Promise) {\n        promise._propagateFrom(maybePromise, 7);\n        promise._follow(maybePromise);\n        return promise.then(function(value) {\n            return Promise.delay(value, ms);\n        });\n    } else {\n        promise._setTrace(void 0);\n        _setTimeout(afterDelay, ms, value, promise);\n    }\n    return promise;\n};\n\nPromise.prototype.delay = function Promise$delay(ms) {\n    return delay(this, ms);\n};\n\nPromise.prototype.timeout = function Promise$timeout(ms, message) {\n    ms = +ms;\n\n    var ret = new Promise(INTERNAL);\n    ret._propagateFrom(this, 7);\n    ret._follow(this);\n    _setTimeout(afterTimeout, ms, ret, message, ms);\n    return ret.cancellable();\n};\n\n};\n","/**\n * The MIT License (MIT)\n * \n * Copyright (c) 2014 Petka Antonov\n * \n * Permission is hereby granted, free of charge, to any person obtaining a copy\n * of this software and associated documentation files (the \"Software\"), to deal\n * in the Software without restriction, including without limitation the rights\n * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell\n * copies of the Software, and to permit persons to whom the Software is\n * furnished to do so, subject to the following conditions:</p>\n * \n * The above copyright notice and this permission notice shall be included in\n * all copies or substantial portions of the Software.\n * \n * THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT.  IN NO EVENT SHALL THE\n * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\n * THE SOFTWARE.\n * \n */\n\"use strict\";\nmodule.exports = function(Promise, INTERNAL, cast) {\nvar apiRejection = require(\"./errors_api_rejection.js\")(Promise);\nvar isArray = require(\"./util.js\").isArray;\n\nvar raceLater = function Promise$_raceLater(promise) {\n    return promise.then(function(array) {\n        return Promise$_Race(array, promise);\n    });\n};\n\nvar hasOwn = {}.hasOwnProperty;\nfunction Promise$_Race(promises, parent) {\n    var maybePromise = cast(promises, void 0);\n\n    if (maybePromise instanceof Promise) {\n        return raceLater(maybePromise);\n    } else if (!isArray(promises)) {\n        return apiRejection(\"expecting an array, a promise or a thenable\");\n    }\n\n    var ret = new Promise(INTERNAL);\n    if (parent !== void 0) {\n        ret._propagateFrom(parent, 7);\n    } else {\n        ret._setTrace(void 0);\n    }\n    var fulfill = ret._fulfill;\n    var reject = ret._reject;\n    for (var i = 0, len = promises.length; i < len; ++i) {\n        var val = promises[i];\n\n        if (val === void 0 && !(hasOwn.call(promises, i))) {\n            continue;\n        }\n\n        Promise.cast(val)._then(fulfill, reject, void 0, ret, null);\n    }\n    return ret;\n}\n\nPromise.race = function Promise$Race(promises) {\n    return Promise$_Race(promises, void 0);\n};\n\nPromise.prototype.race = function Promise$race() {\n    return Promise$_Race(this, void 0);\n};\n\n};\n","/**\n * The MIT License (MIT)\n * \n * Copyright (c) 2014 Petka Antonov\n * \n * Permission is hereby granted, free of charge, to any person obtaining a copy\n * of this software and associated documentation files (the \"Software\"), to deal\n * in the Software without restriction, including without limitation the rights\n * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell\n * copies of the Software, and to permit persons to whom the Software is\n * furnished to do so, subject to the following conditions:</p>\n * \n * The above copyright notice and this permission notice shall be included in\n * all copies or substantial portions of the Software.\n * \n * THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT.  IN NO EVENT SHALL THE\n * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\n * THE SOFTWARE.\n * \n */\n\"use strict\";\nvar cr = Object.create;\nif (cr) {\n    var callerCache = cr(null);\n    var getterCache = cr(null);\n    callerCache[\" size\"] = getterCache[\" size\"] = 0;\n}\n\nmodule.exports = function(Promise) {\nvar util = require(\"./util.js\");\nvar canEvaluate = util.canEvaluate;\nvar isIdentifier = util.isIdentifier;\n\nfunction makeMethodCaller (methodName) {\n    return new Function(\"obj\", \"                                             \\n\\\n        'use strict'                                                         \\n\\\n        var len = this.length;                                               \\n\\\n        switch(len) {                                                        \\n\\\n            case 1: return obj.methodName(this[0]);                          \\n\\\n            case 2: return obj.methodName(this[0], this[1]);                 \\n\\\n            case 3: return obj.methodName(this[0], this[1], this[2]);        \\n\\\n            case 0: return obj.methodName();                                 \\n\\\n            default: return obj.methodName.apply(obj, this);                 \\n\\\n        }                                                                    \\n\\\n        \".replace(/methodName/g, methodName));\n}\n\nfunction makeGetter (propertyName) {\n    return new Function(\"obj\", \"                                             \\n\\\n        'use strict';                                                        \\n\\\n        return obj.propertyName;                                             \\n\\\n        \".replace(\"propertyName\", propertyName));\n}\n\nfunction getCompiled(name, compiler, cache) {\n    var ret = cache[name];\n    if (typeof ret !== \"function\") {\n        if (!isIdentifier(name)) {\n            return null;\n        }\n        ret = compiler(name);\n        cache[name] = ret;\n        cache[\" size\"]++;\n        if (cache[\" size\"] > 512) {\n            var keys = Object.keys(cache);\n            for (var i = 0; i < 256; ++i) delete cache[keys[i]];\n            cache[\" size\"] = keys.length - 256;\n        }\n    }\n    return ret;\n}\n\nfunction getMethodCaller(name) {\n    return getCompiled(name, makeMethodCaller, callerCache);\n}\n\nfunction getGetter(name) {\n    return getCompiled(name, makeGetter, getterCache);\n}\n\nfunction caller(obj) {\n    return obj[this.pop()].apply(obj, this);\n}\nPromise.prototype.call = function Promise$call(methodName) {\n    var $_len = arguments.length;var args = new Array($_len - 1); for(var $_i = 1; $_i < $_len; ++$_i) {args[$_i - 1] = arguments[$_i];}\n    if (canEvaluate) {\n        var maybeCaller = getMethodCaller(methodName);\n        if (maybeCaller !== null) {\n            return this._then(maybeCaller, void 0, void 0, args, void 0);\n        }\n    }\n    args.push(methodName);\n    return this._then(caller, void 0, void 0, args, void 0);\n};\n\nfunction namedGetter(obj) {\n    return obj[this];\n}\nfunction indexedGetter(obj) {\n    return obj[this];\n}\nPromise.prototype.get = function Promise$get(propertyName) {\n    var isIndex = (typeof propertyName === \"number\");\n    var getter;\n    if (!isIndex) {\n        if (canEvaluate) {\n            var maybeGetter = getGetter(propertyName);\n            getter = maybeGetter !== null ? maybeGetter : namedGetter;\n        } else {\n            getter = namedGetter;\n        }\n    } else {\n        getter = indexedGetter;\n    }\n    return this._then(getter, void 0, void 0, propertyName, void 0);\n};\n};\n","/**\n * The MIT License (MIT)\n * \n * Copyright (c) 2014 Petka Antonov\n * \n * Permission is hereby granted, free of charge, to any person obtaining a copy\n * of this software and associated documentation files (the \"Software\"), to deal\n * in the Software without restriction, including without limitation the rights\n * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell\n * copies of the Software, and to permit persons to whom the Software is\n * furnished to do so, subject to the following conditions:</p>\n * \n * The above copyright notice and this permission notice shall be included in\n * all copies or substantial portions of the Software.\n * \n * THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT.  IN NO EVENT SHALL THE\n * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\n * THE SOFTWARE.\n * \n */\n\"use strict\";\nmodule.exports = function(Promise, apiRejection, INTERNAL, cast) {\nvar errors = require(\"./errors.js\");\nvar TypeError = errors.TypeError;\nvar deprecated = require(\"./util.js\").deprecated;\nvar util = require(\"./util.js\");\nvar errorObj = util.errorObj;\nvar tryCatch1 = util.tryCatch1;\nvar yieldHandlers = [];\n\nfunction promiseFromYieldHandler(value, yieldHandlers) {\n    var _errorObj = errorObj;\n    var _Promise = Promise;\n    var len = yieldHandlers.length;\n    for (var i = 0; i < len; ++i) {\n        var result = tryCatch1(yieldHandlers[i], void 0, value);\n        if (result === _errorObj) {\n            return _Promise.reject(_errorObj.e);\n        }\n        var maybePromise = cast(result, promiseFromYieldHandler);\n        if (maybePromise instanceof _Promise) return maybePromise;\n    }\n    return null;\n}\n\nfunction PromiseSpawn(generatorFunction, receiver, yieldHandler) {\n    var promise = this._promise = new Promise(INTERNAL);\n    promise._setTrace(void 0);\n    this._generatorFunction = generatorFunction;\n    this._receiver = receiver;\n    this._generator = void 0;\n    this._yieldHandlers = typeof yieldHandler === \"function\"\n        ? [yieldHandler].concat(yieldHandlers)\n        : yieldHandlers;\n}\n\nPromiseSpawn.prototype.promise = function PromiseSpawn$promise() {\n    return this._promise;\n};\n\nPromiseSpawn.prototype._run = function PromiseSpawn$_run() {\n    this._generator = this._generatorFunction.call(this._receiver);\n    this._receiver =\n        this._generatorFunction = void 0;\n    this._next(void 0);\n};\n\nPromiseSpawn.prototype._continue = function PromiseSpawn$_continue(result) {\n    if (result === errorObj) {\n        this._generator = void 0;\n        var trace = errors.canAttach(result.e)\n            ? result.e : new Error(result.e + \"\");\n        this._promise._attachExtraTrace(trace);\n        this._promise._reject(result.e, trace);\n        return;\n    }\n\n    var value = result.value;\n    if (result.done === true) {\n        this._generator = void 0;\n        if (!this._promise._tryFollow(value)) {\n            this._promise._fulfill(value);\n        }\n    } else {\n        var maybePromise = cast(value, void 0);\n        if (!(maybePromise instanceof Promise)) {\n            maybePromise =\n                promiseFromYieldHandler(maybePromise, this._yieldHandlers);\n            if (maybePromise === null) {\n                this._throw(new TypeError(\"A value was yielded that could not be treated as a promise\"));\n                return;\n            }\n        }\n        maybePromise._then(\n            this._next,\n            this._throw,\n            void 0,\n            this,\n            null\n       );\n    }\n};\n\nPromiseSpawn.prototype._throw = function PromiseSpawn$_throw(reason) {\n    if (errors.canAttach(reason))\n        this._promise._attachExtraTrace(reason);\n    this._continue(\n        tryCatch1(this._generator[\"throw\"], this._generator, reason)\n   );\n};\n\nPromiseSpawn.prototype._next = function PromiseSpawn$_next(value) {\n    this._continue(\n        tryCatch1(this._generator.next, this._generator, value)\n   );\n};\n\nPromise.coroutine =\nfunction Promise$Coroutine(generatorFunction, options) {\n    if (typeof generatorFunction !== \"function\") {\n        throw new TypeError(\"generatorFunction must be a function\");\n    }\n    var yieldHandler = Object(options).yieldHandler;\n    var PromiseSpawn$ = PromiseSpawn;\n    return function () {\n        var generator = generatorFunction.apply(this, arguments);\n        var spawn = new PromiseSpawn$(void 0, void 0, yieldHandler);\n        spawn._generator = generator;\n        spawn._next(void 0);\n        return spawn.promise();\n    };\n};\n\nPromise.coroutine.addYieldHandler = function(fn) {\n    if (typeof fn !== \"function\") throw new TypeError(\"fn must be a function\");\n    yieldHandlers.push(fn);\n};\n\nPromise.spawn = function Promise$Spawn(generatorFunction) {\n    deprecated(\"Promise.spawn is deprecated. Use Promise.coroutine instead.\");\n    if (typeof generatorFunction !== \"function\") {\n        return apiRejection(\"generatorFunction must be a function\");\n    }\n    var spawn = new PromiseSpawn(generatorFunction, this);\n    var ret = spawn.promise();\n    spawn._run(Promise.spawn);\n    return ret;\n};\n};\n","/**\n * The MIT License (MIT)\n * \n * Copyright (c) 2014 Petka Antonov\n * \n * Permission is hereby granted, free of charge, to any person obtaining a copy\n * of this software and associated documentation files (the \"Software\"), to deal\n * in the Software without restriction, including without limitation the rights\n * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell\n * copies of the Software, and to permit persons to whom the Software is\n * furnished to do so, subject to the following conditions:</p>\n * \n * The above copyright notice and this permission notice shall be included in\n * all copies or substantial portions of the Software.\n * \n * THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT.  IN NO EVENT SHALL THE\n * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\n * THE SOFTWARE.\n * \n */\n\"use strict\";\nmodule.exports = function(Promise, PromiseArray, apiRejection, cast, INTERNAL) {\nvar util = require(\"./util.js\");\nvar tryCatch3 = util.tryCatch3;\nvar errorObj = util.errorObj;\nvar PENDING = {};\nvar EMPTY_ARRAY = [];\n\nfunction MappingPromiseArray(promises, fn, limit, _filter) {\n    this.constructor$(promises);\n    this._callback = fn;\n    this._preservedValues = _filter === INTERNAL\n        ? new Array(this.length())\n        : null;\n    this._limit = limit;\n    this._inFlight = 0;\n    this._queue = limit >= 1 ? [] : EMPTY_ARRAY;\n    this._init$(void 0, -2);\n}\nutil.inherits(MappingPromiseArray, PromiseArray);\n\nMappingPromiseArray.prototype._init = function MappingPromiseArray$_init() {};\n\nMappingPromiseArray.prototype._promiseFulfilled =\nfunction MappingPromiseArray$_promiseFulfilled(value, index) {\n    var values = this._values;\n    if (values === null) return;\n\n    var length = this.length();\n    var preservedValues = this._preservedValues;\n    var limit = this._limit;\n    if (values[index] === PENDING) {\n        values[index] = value;\n        if (limit >= 1) {\n            this._inFlight--;\n            this._drainQueue();\n            if (this._isResolved()) return;\n        }\n    } else {\n        if (limit >= 1 && this._inFlight >= limit) {\n            values[index] = value;\n            this._queue.push(index);\n            return;\n        }\n        if (preservedValues !== null) preservedValues[index] = value;\n\n        var callback = this._callback;\n        var receiver = this._promise._boundTo;\n        var ret = tryCatch3(callback, receiver, value, index, length);\n        if (ret === errorObj) return this._reject(ret.e);\n\n        var maybePromise = cast(ret, void 0);\n        if (maybePromise instanceof Promise) {\n            if (maybePromise.isPending()) {\n                if (limit >= 1) this._inFlight++;\n                values[index] = PENDING;\n                return maybePromise._proxyPromiseArray(this, index);\n            } else if (maybePromise.isFulfilled()) {\n                ret = maybePromise.value();\n            } else {\n                maybePromise._unsetRejectionIsUnhandled();\n                return this._reject(maybePromise.reason());\n            }\n        }\n        values[index] = ret;\n    }\n    var totalResolved = ++this._totalResolved;\n    if (totalResolved >= length) {\n        if (preservedValues !== null) {\n            this._filter(values, preservedValues);\n        } else {\n            this._resolve(values);\n        }\n\n    }\n};\n\nMappingPromiseArray.prototype._drainQueue =\nfunction MappingPromiseArray$_drainQueue() {\n    var queue = this._queue;\n    var limit = this._limit;\n    var values = this._values;\n    while (queue.length > 0 && this._inFlight < limit) {\n        var index = queue.pop();\n        this._promiseFulfilled(values[index], index);\n    }\n};\n\nMappingPromiseArray.prototype._filter =\nfunction MappingPromiseArray$_filter(booleans, values) {\n    var len = values.length;\n    var ret = new Array(len);\n    var j = 0;\n    for (var i = 0; i < len; ++i) {\n        if (booleans[i]) ret[j++] = values[i];\n    }\n    ret.length = j;\n    this._resolve(ret);\n};\n\nMappingPromiseArray.prototype.preservedValues =\nfunction MappingPromiseArray$preserveValues() {\n    return this._preservedValues;\n};\n\nfunction map(promises, fn, options, _filter) {\n    var limit = typeof options === \"object\" && options !== null\n        ? options.concurrency\n        : 0;\n    limit = typeof limit === \"number\" &&\n        isFinite(limit) && limit >= 1 ? limit : 0;\n    return new MappingPromiseArray(promises, fn, limit, _filter);\n}\n\nPromise.prototype.map = function Promise$map(fn, options) {\n    if (typeof fn !== \"function\") return apiRejection(\"fn must be a function\");\n\n    return map(this, fn, options, null).promise();\n};\n\nPromise.map = function Promise$Map(promises, fn, options, _filter) {\n    if (typeof fn !== \"function\") return apiRejection(\"fn must be a function\");\n    return map(promises, fn, options, _filter).promise();\n};\n\n\n};\n","/**\n * The MIT License (MIT)\n * \n * Copyright (c) 2014 Petka Antonov\n * \n * Permission is hereby granted, free of charge, to any person obtaining a copy\n * of this software and associated documentation files (the \"Software\"), to deal\n * in the Software without restriction, including without limitation the rights\n * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell\n * copies of the Software, and to permit persons to whom the Software is\n * furnished to do so, subject to the following conditions:</p>\n * \n * The above copyright notice and this permission notice shall be included in\n * all copies or substantial portions of the Software.\n * \n * THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT.  IN NO EVENT SHALL THE\n * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\n * THE SOFTWARE.\n * \n */\n\"use strict\";\nmodule.exports = function(Promise) {\nvar util = require(\"./util.js\");\nvar async = require(\"./async.js\");\nvar tryCatch2 = util.tryCatch2;\nvar tryCatch1 = util.tryCatch1;\nvar errorObj = util.errorObj;\n\nfunction thrower(r) {\n    throw r;\n}\n\nfunction Promise$_spreadAdapter(val, receiver) {\n    if (!util.isArray(val)) return Promise$_successAdapter(val, receiver);\n    var ret = util.tryCatchApply(this, [null].concat(val), receiver);\n    if (ret === errorObj) {\n        async.invokeLater(thrower, void 0, ret.e);\n    }\n}\n\nfunction Promise$_successAdapter(val, receiver) {\n    var nodeback = this;\n    var ret = val === void 0\n        ? tryCatch1(nodeback, receiver, null)\n        : tryCatch2(nodeback, receiver, null, val);\n    if (ret === errorObj) {\n        async.invokeLater(thrower, void 0, ret.e);\n    }\n}\nfunction Promise$_errorAdapter(reason, receiver) {\n    var nodeback = this;\n    var ret = tryCatch1(nodeback, receiver, reason);\n    if (ret === errorObj) {\n        async.invokeLater(thrower, void 0, ret.e);\n    }\n}\n\nPromise.prototype.nodeify = function Promise$nodeify(nodeback, options) {\n    if (typeof nodeback == \"function\") {\n        var adapter = Promise$_successAdapter;\n        if (options !== void 0 && Object(options).spread) {\n            adapter = Promise$_spreadAdapter;\n        }\n        this._then(\n            adapter,\n            Promise$_errorAdapter,\n            void 0,\n            nodeback,\n            this._boundTo\n        );\n    }\n    return this;\n};\n};\n","/**\n * The MIT License (MIT)\n * \n * Copyright (c) 2014 Petka Antonov\n * \n * Permission is hereby granted, free of charge, to any person obtaining a copy\n * of this software and associated documentation files (the \"Software\"), to deal\n * in the Software without restriction, including without limitation the rights\n * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell\n * copies of the Software, and to permit persons to whom the Software is\n * furnished to do so, subject to the following conditions:</p>\n * \n * The above copyright notice and this permission notice shall be included in\n * all copies or substantial portions of the Software.\n * \n * THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT.  IN NO EVENT SHALL THE\n * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\n * THE SOFTWARE.\n * \n */\n\"use strict\";\nmodule.exports = function(Promise, INTERNAL) {\nvar THIS = {};\nvar util = require(\"./util.js\");\nvar nodebackForPromise = require(\"./promise_resolver.js\")\n    ._nodebackForPromise;\nvar withAppended = util.withAppended;\nvar maybeWrapAsError = util.maybeWrapAsError;\nvar canEvaluate = util.canEvaluate;\nvar TypeError = require(\"./errors\").TypeError;\nvar defaultSuffix = \"Async\";\nvar defaultFilter = function(name, func) {\n    return util.isIdentifier(name) &&\n        name.charAt(0) !== \"_\" &&\n        !util.isClass(func);\n};\nvar defaultPromisified = {__isPromisified__: true};\n\n\nfunction escapeIdentRegex(str) {\n    return str.replace(/([$])/, \"\\\\$\");\n}\n\nfunction isPromisified(fn) {\n    try {\n        return fn.__isPromisified__ === true;\n    }\n    catch (e) {\n        return false;\n    }\n}\n\nfunction hasPromisified(obj, key, suffix) {\n    var val = util.getDataPropertyOrDefault(obj, key + suffix,\n                                            defaultPromisified);\n    return val ? isPromisified(val) : false;\n}\nfunction checkValid(ret, suffix, suffixRegexp) {\n    for (var i = 0; i < ret.length; i += 2) {\n        var key = ret[i];\n        if (suffixRegexp.test(key)) {\n            var keyWithoutAsyncSuffix = key.replace(suffixRegexp, \"\");\n            for (var j = 0; j < ret.length; j += 2) {\n                if (ret[j] === keyWithoutAsyncSuffix) {\n                    throw new TypeError(\"Cannot promisify an API \" +\n                        \"that has normal methods with '\"+suffix+\"'-suffix\");\n                }\n            }\n        }\n    }\n}\n\nfunction promisifiableMethods(obj, suffix, suffixRegexp, filter) {\n    var keys = util.inheritedDataKeys(obj);\n    var ret = [];\n    for (var i = 0; i < keys.length; ++i) {\n        var key = keys[i];\n        var value = obj[key];\n        if (typeof value === \"function\" &&\n            !isPromisified(value) &&\n            !hasPromisified(obj, key, suffix) &&\n            filter(key, value, obj)) {\n            ret.push(key, value);\n        }\n    }\n    checkValid(ret, suffix, suffixRegexp);\n    return ret;\n}\n\nfunction switchCaseArgumentOrder(likelyArgumentCount) {\n    var ret = [likelyArgumentCount];\n    var min = Math.max(0, likelyArgumentCount - 1 - 5);\n    for(var i = likelyArgumentCount - 1; i >= min; --i) {\n        if (i === likelyArgumentCount) continue;\n        ret.push(i);\n    }\n    for(var i = likelyArgumentCount + 1; i <= 5; ++i) {\n        ret.push(i);\n    }\n    return ret;\n}\n\nfunction argumentSequence(argumentCount) {\n    return util.filledRange(argumentCount, \"arguments[\", \"]\");\n}\n\nfunction parameterDeclaration(parameterCount) {\n    return util.filledRange(parameterCount, \"_arg\", \"\");\n}\n\nfunction parameterCount(fn) {\n    if (typeof fn.length === \"number\") {\n        return Math.max(Math.min(fn.length, 1023 + 1), 0);\n    }\n    return 0;\n}\n\nfunction generatePropertyAccess(key) {\n    if (util.isIdentifier(key)) {\n        return \".\" + key;\n    }\n    else return \"['\" + key.replace(/(['\\\\])/g, \"\\\\$1\") + \"']\";\n}\n\nfunction makeNodePromisifiedEval(callback, receiver, originalName, fn, suffix) {\n    var newParameterCount = Math.max(0, parameterCount(fn) - 1);\n    var argumentOrder = switchCaseArgumentOrder(newParameterCount);\n    var callbackName =\n        (typeof originalName === \"string\" && util.isIdentifier(originalName)\n            ? originalName + suffix\n            : \"promisified\");\n\n    function generateCallForArgumentCount(count) {\n        var args = argumentSequence(count).join(\", \");\n        var comma = count > 0 ? \", \" : \"\";\n        var ret;\n        if (typeof callback === \"string\") {\n            ret = \"                                                          \\n\\\n                this.method({{args}}, fn);                                   \\n\\\n                break;                                                       \\n\\\n            \".replace(\".method\", generatePropertyAccess(callback));\n        } else if (receiver === THIS) {\n            ret =  \"                                                         \\n\\\n                callback.call(this, {{args}}, fn);                           \\n\\\n                break;                                                       \\n\\\n            \";\n        } else if (receiver !== void 0) {\n            ret =  \"                                                         \\n\\\n                callback.call(receiver, {{args}}, fn);                       \\n\\\n                break;                                                       \\n\\\n            \";\n        } else {\n            ret =  \"                                                         \\n\\\n                callback({{args}}, fn);                                      \\n\\\n                break;                                                       \\n\\\n            \";\n        }\n        return ret.replace(\"{{args}}\", args).replace(\", \", comma);\n    }\n\n    function generateArgumentSwitchCase() {\n        var ret = \"\";\n        for(var i = 0; i < argumentOrder.length; ++i) {\n            ret += \"case \" + argumentOrder[i] +\":\" +\n                generateCallForArgumentCount(argumentOrder[i]);\n        }\n        var codeForCall;\n        if (typeof callback === \"string\") {\n            codeForCall = \"                                                  \\n\\\n                this.property.apply(this, args);                             \\n\\\n            \"\n                .replace(\".property\", generatePropertyAccess(callback));\n        } else if (receiver === THIS) {\n            codeForCall = \"                                                  \\n\\\n                callback.apply(this, args);                                  \\n\\\n            \";\n        } else {\n            codeForCall = \"                                                  \\n\\\n                callback.apply(receiver, args);                              \\n\\\n            \";\n        }\n\n        ret += \"                                                             \\n\\\n        default:                                                             \\n\\\n            var args = new Array(len + 1);                                   \\n\\\n            var i = 0;                                                       \\n\\\n            for (var i = 0; i < len; ++i) {                                  \\n\\\n               args[i] = arguments[i];                                       \\n\\\n            }                                                                \\n\\\n            args[i] = fn;                                                    \\n\\\n            [CodeForCall]                                                    \\n\\\n            break;                                                           \\n\\\n        \".replace(\"[CodeForCall]\", codeForCall);\n        return ret;\n    }\n\n    return new Function(\"Promise\",\n                        \"callback\",\n                        \"receiver\",\n                        \"withAppended\",\n                        \"maybeWrapAsError\",\n                        \"nodebackForPromise\",\n                        \"INTERNAL\",\"                                         \\n\\\n        var ret = function FunctionName(Parameters) {                        \\n\\\n            'use strict';                                                    \\n\\\n            var len = arguments.length;                                      \\n\\\n            var promise = new Promise(INTERNAL);                             \\n\\\n            promise._setTrace(void 0);                                       \\n\\\n            var fn = nodebackForPromise(promise);                            \\n\\\n            try {                                                            \\n\\\n                switch(len) {                                                \\n\\\n                    [CodeForSwitchCase]                                      \\n\\\n                }                                                            \\n\\\n            } catch (e) {                                                    \\n\\\n                var wrapped = maybeWrapAsError(e);                           \\n\\\n                promise._attachExtraTrace(wrapped);                          \\n\\\n                promise._reject(wrapped);                                    \\n\\\n            }                                                                \\n\\\n            return promise;                                                  \\n\\\n        };                                                                   \\n\\\n        ret.__isPromisified__ = true;                                        \\n\\\n        return ret;                                                          \\n\\\n        \"\n        .replace(\"FunctionName\", callbackName)\n        .replace(\"Parameters\", parameterDeclaration(newParameterCount))\n        .replace(\"[CodeForSwitchCase]\", generateArgumentSwitchCase()))(\n            Promise,\n            callback,\n            receiver,\n            withAppended,\n            maybeWrapAsError,\n            nodebackForPromise,\n            INTERNAL\n        );\n}\n\nfunction makeNodePromisifiedClosure(callback, receiver) {\n    function promisified() {\n        var _receiver = receiver;\n        if (receiver === THIS) _receiver = this;\n        if (typeof callback === \"string\") {\n            callback = _receiver[callback];\n        }\n        var promise = new Promise(INTERNAL);\n        promise._setTrace(void 0);\n        var fn = nodebackForPromise(promise);\n        try {\n            callback.apply(_receiver, withAppended(arguments, fn));\n        } catch(e) {\n            var wrapped = maybeWrapAsError(e);\n            promise._attachExtraTrace(wrapped);\n            promise._reject(wrapped);\n        }\n        return promise;\n    }\n    promisified.__isPromisified__ = true;\n    return promisified;\n}\n\nvar makeNodePromisified = canEvaluate\n    ? makeNodePromisifiedEval\n    : makeNodePromisifiedClosure;\n\nfunction promisifyAll(obj, suffix, filter, promisifier) {\n    var suffixRegexp = new RegExp(escapeIdentRegex(suffix) + \"$\");\n    var methods =\n        promisifiableMethods(obj, suffix, suffixRegexp, filter);\n\n    for (var i = 0, len = methods.length; i < len; i+= 2) {\n        var key = methods[i];\n        var fn = methods[i+1];\n        var promisifiedKey = key + suffix;\n        obj[promisifiedKey] = promisifier === makeNodePromisified\n                ? makeNodePromisified(key, THIS, key, fn, suffix)\n                : promisifier(fn);\n    }\n    util.toFastProperties(obj);\n    return obj;\n}\n\nfunction promisify(callback, receiver) {\n    return makeNodePromisified(callback, receiver, void 0, callback);\n}\n\nPromise.promisify = function Promise$Promisify(fn, receiver) {\n    if (typeof fn !== \"function\") {\n        throw new TypeError(\"fn must be a function\");\n    }\n    if (isPromisified(fn)) {\n        return fn;\n    }\n    return promisify(fn, arguments.length < 2 ? THIS : receiver);\n};\n\nPromise.promisifyAll = function Promise$PromisifyAll(target, options) {\n    if (typeof target !== \"function\" && typeof target !== \"object\") {\n        throw new TypeError(\"the target of promisifyAll must be an object or a function\");\n    }\n    options = Object(options);\n    var suffix = options.suffix;\n    if (typeof suffix !== \"string\") suffix = defaultSuffix;\n    var filter = options.filter;\n    if (typeof filter !== \"function\") filter = defaultFilter;\n    var promisifier = options.promisifier;\n    if (typeof promisifier !== \"function\") promisifier = makeNodePromisified;\n\n    if (!util.isIdentifier(suffix)) {\n        throw new RangeError(\"suffix must be a valid identifier\");\n    }\n\n    var keys = util.inheritedDataKeys(target, {includeHidden: true});\n    for (var i = 0; i < keys.length; ++i) {\n        var value = target[keys[i]];\n        if (keys[i] !== \"constructor\" &&\n            util.isClass(value)) {\n            promisifyAll(value.prototype, suffix, filter, promisifier);\n            promisifyAll(value, suffix, filter, promisifier);\n        }\n    }\n\n    return promisifyAll(target, suffix, filter, promisifier);\n};\n};\n\n","/**\n * The MIT License (MIT)\n * \n * Copyright (c) 2014 Petka Antonov\n * \n * Permission is hereby granted, free of charge, to any person obtaining a copy\n * of this software and associated documentation files (the \"Software\"), to deal\n * in the Software without restriction, including without limitation the rights\n * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell\n * copies of the Software, and to permit persons to whom the Software is\n * furnished to do so, subject to the following conditions:</p>\n * \n * The above copyright notice and this permission notice shall be included in\n * all copies or substantial portions of the Software.\n * \n * THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT.  IN NO EVENT SHALL THE\n * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\n * THE SOFTWARE.\n * \n */\n\"use strict\";\nmodule.exports = function(Promise, PromiseArray, cast) {\nvar util = require(\"./util.js\");\nvar apiRejection = require(\"./errors_api_rejection\")(Promise);\nvar isObject = util.isObject;\nvar es5 = require(\"./es5.js\");\n\nfunction PropertiesPromiseArray(obj) {\n    var keys = es5.keys(obj);\n    var len = keys.length;\n    var values = new Array(len * 2);\n    for (var i = 0; i < len; ++i) {\n        var key = keys[i];\n        values[i] = obj[key];\n        values[i + len] = key;\n    }\n    this.constructor$(values);\n}\nutil.inherits(PropertiesPromiseArray, PromiseArray);\n\nPropertiesPromiseArray.prototype._init =\nfunction PropertiesPromiseArray$_init() {\n    this._init$(void 0, -3) ;\n};\n\nPropertiesPromiseArray.prototype._promiseFulfilled =\nfunction PropertiesPromiseArray$_promiseFulfilled(value, index) {\n    if (this._isResolved()) return;\n    this._values[index] = value;\n    var totalResolved = ++this._totalResolved;\n    if (totalResolved >= this._length) {\n        var val = {};\n        var keyOffset = this.length();\n        for (var i = 0, len = this.length(); i < len; ++i) {\n            val[this._values[i + keyOffset]] = this._values[i];\n        }\n        this._resolve(val);\n    }\n};\n\nPropertiesPromiseArray.prototype._promiseProgressed =\nfunction PropertiesPromiseArray$_promiseProgressed(value, index) {\n    if (this._isResolved()) return;\n\n    this._promise._progress({\n        key: this._values[index + this.length()],\n        value: value\n    });\n};\n\nPropertiesPromiseArray.prototype.shouldCopyValues =\nfunction PropertiesPromiseArray$_shouldCopyValues() {\n    return false;\n};\n\nPropertiesPromiseArray.prototype.getActualLength =\nfunction PropertiesPromiseArray$getActualLength(len) {\n    return len >> 1;\n};\n\nfunction Promise$_Props(promises) {\n    var ret;\n    var castValue = cast(promises, void 0);\n\n    if (!isObject(castValue)) {\n        return apiRejection(\"cannot await properties of a non-object\");\n    } else if (castValue instanceof Promise) {\n        ret = castValue._then(Promise.props, void 0, void 0, void 0, void 0);\n    } else {\n        ret = new PropertiesPromiseArray(castValue).promise();\n    }\n\n    if (castValue instanceof Promise) {\n        ret._propagateFrom(castValue, 4);\n    }\n    return ret;\n}\n\nPromise.prototype.props = function Promise$props() {\n    return Promise$_Props(this);\n};\n\nPromise.props = function Promise$Props(promises) {\n    return Promise$_Props(promises);\n};\n};\n","/**\n * The MIT License (MIT)\n * \n * Copyright (c) 2014 Petka Antonov\n * \n * Permission is hereby granted, free of charge, to any person obtaining a copy\n * of this software and associated documentation files (the \"Software\"), to deal\n * in the Software without restriction, including without limitation the rights\n * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell\n * copies of the Software, and to permit persons to whom the Software is\n * furnished to do so, subject to the following conditions:</p>\n * \n * The above copyright notice and this permission notice shall be included in\n * all copies or substantial portions of the Software.\n * \n * THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT.  IN NO EVENT SHALL THE\n * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\n * THE SOFTWARE.\n * \n */\n\"use strict\";\nmodule.exports = function(Promise, PromiseArray, apiRejection, cast, INTERNAL) {\nvar util = require(\"./util.js\");\nvar tryCatch4 = util.tryCatch4;\nvar tryCatch3 = util.tryCatch3;\nvar errorObj = util.errorObj;\nfunction ReductionPromiseArray(promises, fn, accum, _each) {\n    this.constructor$(promises);\n    this._preservedValues = _each === INTERNAL ? [] : null;\n    this._zerothIsAccum = (accum === void 0);\n    this._gotAccum = false;\n    this._reducingIndex = (this._zerothIsAccum ? 1 : 0);\n    this._valuesPhase = undefined;\n\n    var maybePromise = cast(accum, void 0);\n    var rejected = false;\n    var isPromise = maybePromise instanceof Promise;\n    if (isPromise) {\n        if (maybePromise.isPending()) {\n            maybePromise._proxyPromiseArray(this, -1);\n        } else if (maybePromise.isFulfilled()) {\n            accum = maybePromise.value();\n            this._gotAccum = true;\n        } else {\n            maybePromise._unsetRejectionIsUnhandled();\n            this._reject(maybePromise.reason());\n            rejected = true;\n        }\n    }\n    if (!(isPromise || this._zerothIsAccum)) this._gotAccum = true;\n    this._callback = fn;\n    this._accum = accum;\n    if (!rejected) this._init$(void 0, -5);\n}\nutil.inherits(ReductionPromiseArray, PromiseArray);\n\nReductionPromiseArray.prototype._init =\nfunction ReductionPromiseArray$_init() {};\n\nReductionPromiseArray.prototype._resolveEmptyArray =\nfunction ReductionPromiseArray$_resolveEmptyArray() {\n    if (this._gotAccum || this._zerothIsAccum) {\n        this._resolve(this._preservedValues !== null\n                        ? [] : this._accum);\n    }\n};\n\nReductionPromiseArray.prototype._promiseFulfilled =\nfunction ReductionPromiseArray$_promiseFulfilled(value, index) {\n    var values = this._values;\n    if (values === null) return;\n    var length = this.length();\n    var preservedValues = this._preservedValues;\n    var isEach = preservedValues !== null;\n    var gotAccum = this._gotAccum;\n    var valuesPhase = this._valuesPhase;\n    var valuesPhaseIndex;\n    if (!valuesPhase) {\n        valuesPhase = this._valuesPhase = Array(length);\n        for (valuesPhaseIndex=0; valuesPhaseIndex<length; ++valuesPhaseIndex) {\n            valuesPhase[valuesPhaseIndex] = 0;\n        }\n    }\n    valuesPhaseIndex = valuesPhase[index];\n\n    if (index === 0 && this._zerothIsAccum) {\n        if (!gotAccum) {\n            this._accum = value;\n            this._gotAccum = gotAccum = true;\n        }\n        valuesPhase[index] = ((valuesPhaseIndex === 0)\n            ? 1 : 2);\n    } else if (index === -1) {\n        if (!gotAccum) {\n            this._accum = value;\n            this._gotAccum = gotAccum = true;\n        }\n    } else {\n        if (valuesPhaseIndex === 0) {\n            valuesPhase[index] = 1;\n        }\n        else {\n            valuesPhase[index] = 2;\n            if (gotAccum) {\n                this._accum = value;\n            }\n        }\n    }\n    if (!gotAccum) return;\n\n    var callback = this._callback;\n    var receiver = this._promise._boundTo;\n    var ret;\n\n    for (var i = this._reducingIndex; i < length; ++i) {\n        valuesPhaseIndex = valuesPhase[i];\n        if (valuesPhaseIndex === 2) {\n            this._reducingIndex = i + 1;\n            continue;\n        }\n        if (valuesPhaseIndex !== 1) return;\n\n        value = values[i];\n        if (value instanceof Promise) {\n            if (value.isFulfilled()) {\n                value = value._settledValue;\n            } else if (value.isPending()) {\n                return;\n            } else {\n                value._unsetRejectionIsUnhandled();\n                return this._reject(value.reason());\n            }\n        }\n\n        if (isEach) {\n            preservedValues.push(value);\n            ret = tryCatch3(callback, receiver, value, i, length);\n        }\n        else {\n            ret = tryCatch4(callback, receiver, this._accum, value, i, length);\n        }\n\n        if (ret === errorObj) return this._reject(ret.e);\n\n        var maybePromise = cast(ret, void 0);\n        if (maybePromise instanceof Promise) {\n            if (maybePromise.isPending()) {\n                valuesPhase[i] = 4;\n                return maybePromise._proxyPromiseArray(this, i);\n            } else if (maybePromise.isFulfilled()) {\n                ret = maybePromise.value();\n            } else {\n                maybePromise._unsetRejectionIsUnhandled();\n                return this._reject(maybePromise.reason());\n            }\n        }\n\n        this._reducingIndex = i + 1;\n        this._accum = ret;\n    }\n\n    if (this._reducingIndex < length) return;\n    this._resolve(isEach ? preservedValues : this._accum);\n};\n\nfunction reduce(promises, fn, initialValue, _each) {\n    if (typeof fn !== \"function\") return apiRejection(\"fn must be a function\");\n    var array = new ReductionPromiseArray(promises, fn, initialValue, _each);\n    return array.promise();\n}\n\nPromise.prototype.reduce = function Promise$reduce(fn, initialValue) {\n    return reduce(this, fn, initialValue, null);\n};\n\nPromise.reduce = function Promise$Reduce(promises, fn, initialValue, _each) {\n    return reduce(promises, fn, initialValue, _each);\n};\n};\n","/**\n * The MIT License (MIT)\n * \n * Copyright (c) 2014 Petka Antonov\n * \n * Permission is hereby granted, free of charge, to any person obtaining a copy\n * of this software and associated documentation files (the \"Software\"), to deal\n * in the Software without restriction, including without limitation the rights\n * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell\n * copies of the Software, and to permit persons to whom the Software is\n * furnished to do so, subject to the following conditions:</p>\n * \n * The above copyright notice and this permission notice shall be included in\n * all copies or substantial portions of the Software.\n * \n * THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT.  IN NO EVENT SHALL THE\n * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\n * THE SOFTWARE.\n * \n */\n\"use strict\";\nmodule.exports =\n    function(Promise, PromiseArray) {\nvar PromiseInspection = Promise.PromiseInspection;\nvar util = require(\"./util.js\");\n\nfunction SettledPromiseArray(values) {\n    this.constructor$(values);\n}\nutil.inherits(SettledPromiseArray, PromiseArray);\n\nSettledPromiseArray.prototype._promiseResolved =\nfunction SettledPromiseArray$_promiseResolved(index, inspection) {\n    this._values[index] = inspection;\n    var totalResolved = ++this._totalResolved;\n    if (totalResolved >= this._length) {\n        this._resolve(this._values);\n    }\n};\n\nSettledPromiseArray.prototype._promiseFulfilled =\nfunction SettledPromiseArray$_promiseFulfilled(value, index) {\n    if (this._isResolved()) return;\n    var ret = new PromiseInspection();\n    ret._bitField = 268435456;\n    ret._settledValue = value;\n    this._promiseResolved(index, ret);\n};\nSettledPromiseArray.prototype._promiseRejected =\nfunction SettledPromiseArray$_promiseRejected(reason, index) {\n    if (this._isResolved()) return;\n    var ret = new PromiseInspection();\n    ret._bitField = 134217728;\n    ret._settledValue = reason;\n    this._promiseResolved(index, ret);\n};\n\nPromise.settle = function Promise$Settle(promises) {\n    return new SettledPromiseArray(promises).promise();\n};\n\nPromise.prototype.settle = function Promise$settle() {\n    return new SettledPromiseArray(this).promise();\n};\n};\n","/**\n * The MIT License (MIT)\n * \n * Copyright (c) 2014 Petka Antonov\n * \n * Permission is hereby granted, free of charge, to any person obtaining a copy\n * of this software and associated documentation files (the \"Software\"), to deal\n * in the Software without restriction, including without limitation the rights\n * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell\n * copies of the Software, and to permit persons to whom the Software is\n * furnished to do so, subject to the following conditions:</p>\n * \n * The above copyright notice and this permission notice shall be included in\n * all copies or substantial portions of the Software.\n * \n * THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT.  IN NO EVENT SHALL THE\n * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\n * THE SOFTWARE.\n * \n */\n\"use strict\";\nmodule.exports =\nfunction(Promise, PromiseArray, apiRejection) {\nvar util = require(\"./util.js\");\nvar RangeError = require(\"./errors.js\").RangeError;\nvar AggregateError = require(\"./errors.js\").AggregateError;\nvar isArray = util.isArray;\n\n\nfunction SomePromiseArray(values) {\n    this.constructor$(values);\n    this._howMany = 0;\n    this._unwrap = false;\n    this._initialized = false;\n}\nutil.inherits(SomePromiseArray, PromiseArray);\n\nSomePromiseArray.prototype._init = function SomePromiseArray$_init() {\n    if (!this._initialized) {\n        return;\n    }\n    if (this._howMany === 0) {\n        this._resolve([]);\n        return;\n    }\n    this._init$(void 0, -5);\n    var isArrayResolved = isArray(this._values);\n    if (!this._isResolved() &&\n        isArrayResolved &&\n        this._howMany > this._canPossiblyFulfill()) {\n        this._reject(this._getRangeError(this.length()));\n    }\n};\n\nSomePromiseArray.prototype.init = function SomePromiseArray$init() {\n    this._initialized = true;\n    this._init();\n};\n\nSomePromiseArray.prototype.setUnwrap = function SomePromiseArray$setUnwrap() {\n    this._unwrap = true;\n};\n\nSomePromiseArray.prototype.howMany = function SomePromiseArray$howMany() {\n    return this._howMany;\n};\n\nSomePromiseArray.prototype.setHowMany =\nfunction SomePromiseArray$setHowMany(count) {\n    if (this._isResolved()) return;\n    this._howMany = count;\n};\n\nSomePromiseArray.prototype._promiseFulfilled =\nfunction SomePromiseArray$_promiseFulfilled(value) {\n    if (this._isResolved()) return;\n    this._addFulfilled(value);\n    if (this._fulfilled() === this.howMany()) {\n        this._values.length = this.howMany();\n        if (this.howMany() === 1 && this._unwrap) {\n            this._resolve(this._values[0]);\n        } else {\n            this._resolve(this._values);\n        }\n    }\n\n};\nSomePromiseArray.prototype._promiseRejected =\nfunction SomePromiseArray$_promiseRejected(reason) {\n    if (this._isResolved()) return;\n    this._addRejected(reason);\n    if (this.howMany() > this._canPossiblyFulfill()) {\n        var e = new AggregateError();\n        for (var i = this.length(); i < this._values.length; ++i) {\n            e.push(this._values[i]);\n        }\n        this._reject(e);\n    }\n};\n\nSomePromiseArray.prototype._fulfilled = function SomePromiseArray$_fulfilled() {\n    return this._totalResolved;\n};\n\nSomePromiseArray.prototype._rejected = function SomePromiseArray$_rejected() {\n    return this._values.length - this.length();\n};\n\nSomePromiseArray.prototype._addRejected =\nfunction SomePromiseArray$_addRejected(reason) {\n    this._values.push(reason);\n};\n\nSomePromiseArray.prototype._addFulfilled =\nfunction SomePromiseArray$_addFulfilled(value) {\n    this._values[this._totalResolved++] = value;\n};\n\nSomePromiseArray.prototype._canPossiblyFulfill =\nfunction SomePromiseArray$_canPossiblyFulfill() {\n    return this.length() - this._rejected();\n};\n\nSomePromiseArray.prototype._getRangeError =\nfunction SomePromiseArray$_getRangeError(count) {\n    var message = \"Input array must contain at least \" +\n            this._howMany + \" items but contains only \" + count + \" items\";\n    return new RangeError(message);\n};\n\nSomePromiseArray.prototype._resolveEmptyArray =\nfunction SomePromiseArray$_resolveEmptyArray() {\n    this._reject(this._getRangeError(0));\n};\n\nfunction Promise$_Some(promises, howMany) {\n    if ((howMany | 0) !== howMany || howMany < 0) {\n        return apiRejection(\"expecting a positive integer\");\n    }\n    var ret = new SomePromiseArray(promises);\n    var promise = ret.promise();\n    if (promise.isRejected()) {\n        return promise;\n    }\n    ret.setHowMany(howMany);\n    ret.init();\n    return promise;\n}\n\nPromise.some = function Promise$Some(promises, howMany) {\n    return Promise$_Some(promises, howMany);\n};\n\nPromise.prototype.some = function Promise$some(howMany) {\n    return Promise$_Some(this, howMany);\n};\n\nPromise._SomePromiseArray = SomePromiseArray;\n};\n","/**\n * The MIT License (MIT)\n * \n * Copyright (c) 2014 Petka Antonov\n * \n * Permission is hereby granted, free of charge, to any person obtaining a copy\n * of this software and associated documentation files (the \"Software\"), to deal\n * in the Software without restriction, including without limitation the rights\n * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell\n * copies of the Software, and to permit persons to whom the Software is\n * furnished to do so, subject to the following conditions:</p>\n * \n * The above copyright notice and this permission notice shall be included in\n * all copies or substantial portions of the Software.\n * \n * THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT.  IN NO EVENT SHALL THE\n * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\n * THE SOFTWARE.\n * \n */\n\"use strict\";\nmodule.exports = function(Promise, PromiseArray) {\nvar util = require(\"./util.js\");\nvar async = require(\"./async.js\");\nvar errors = require(\"./errors.js\");\nvar tryCatch1 = util.tryCatch1;\nvar errorObj = util.errorObj;\n\nPromise.prototype.progressed = function Promise$progressed(handler) {\n    return this._then(void 0, void 0, handler, void 0, void 0);\n};\n\nPromise.prototype._progress = function Promise$_progress(progressValue) {\n    if (this._isFollowingOrFulfilledOrRejected()) return;\n    this._progressUnchecked(progressValue);\n\n};\n\nPromise.prototype._clearFirstHandlerData$Base =\nPromise.prototype._clearFirstHandlerData;\nPromise.prototype._clearFirstHandlerData =\nfunction Promise$_clearFirstHandlerData() {\n    this._clearFirstHandlerData$Base();\n    this._progressHandler0 = void 0;\n};\n\nPromise.prototype._progressHandlerAt =\nfunction Promise$_progressHandlerAt(index) {\n    return index === 0\n        ? this._progressHandler0\n        : this[(index << 2) + index - 5 + 2];\n};\n\nPromise.prototype._doProgressWith =\nfunction Promise$_doProgressWith(progression) {\n    var progressValue = progression.value;\n    var handler = progression.handler;\n    var promise = progression.promise;\n    var receiver = progression.receiver;\n\n    var ret = tryCatch1(handler, receiver, progressValue);\n    if (ret === errorObj) {\n        if (ret.e != null &&\n            ret.e.name !== \"StopProgressPropagation\") {\n            var trace = errors.canAttach(ret.e)\n                ? ret.e : new Error(ret.e + \"\");\n            promise._attachExtraTrace(trace);\n            promise._progress(ret.e);\n        }\n    } else if (ret instanceof Promise) {\n        ret._then(promise._progress, null, null, promise, void 0);\n    } else {\n        promise._progress(ret);\n    }\n};\n\n\nPromise.prototype._progressUnchecked =\nfunction Promise$_progressUnchecked(progressValue) {\n    if (!this.isPending()) return;\n    var len = this._length();\n    var progress = this._progress;\n    for (var i = 0; i < len; i++) {\n        var handler = this._progressHandlerAt(i);\n        var promise = this._promiseAt(i);\n        if (!(promise instanceof Promise)) {\n            var receiver = this._receiverAt(i);\n            if (typeof handler === \"function\") {\n                handler.call(receiver, progressValue, promise);\n            } else if (receiver instanceof Promise && receiver._isProxied()) {\n                receiver._progressUnchecked(progressValue);\n            } else if (receiver instanceof PromiseArray) {\n                receiver._promiseProgressed(progressValue, promise);\n            }\n            continue;\n        }\n\n        if (typeof handler === \"function\") {\n            async.invoke(this._doProgressWith, this, {\n                handler: handler,\n                promise: promise,\n                receiver: this._receiverAt(i),\n                value: progressValue\n            });\n        } else {\n            async.invoke(progress, promise, progressValue);\n        }\n    }\n};\n};\n","/**\n * The MIT License (MIT)\n * \n * Copyright (c) 2014 Petka Antonov\n * \n * Permission is hereby granted, free of charge, to any person obtaining a copy\n * of this software and associated documentation files (the \"Software\"), to deal\n * in the Software without restriction, including without limitation the rights\n * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell\n * copies of the Software, and to permit persons to whom the Software is\n * furnished to do so, subject to the following conditions:</p>\n * \n * The above copyright notice and this permission notice shall be included in\n * all copies or substantial portions of the Software.\n * \n * THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT.  IN NO EVENT SHALL THE\n * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\n * THE SOFTWARE.\n * \n */\n\"use strict\";\nmodule.exports = function(Promise, INTERNAL) {\nvar errors = require(\"./errors.js\");\nvar canAttach = errors.canAttach;\nvar async = require(\"./async.js\");\nvar CancellationError = errors.CancellationError;\n\nPromise.prototype._cancel = function Promise$_cancel(reason) {\n    if (!this.isCancellable()) return this;\n    var parent;\n    var promiseToReject = this;\n    while ((parent = promiseToReject._cancellationParent) !== void 0 &&\n        parent.isCancellable()) {\n        promiseToReject = parent;\n    }\n    promiseToReject._attachExtraTrace(reason);\n    promiseToReject._rejectUnchecked(reason);\n};\n\nPromise.prototype.cancel = function Promise$cancel(reason) {\n    if (!this.isCancellable()) return this;\n    reason = reason !== void 0\n        ? (canAttach(reason) ? reason : new Error(reason + \"\"))\n        : new CancellationError();\n    async.invokeLater(this._cancel, this, reason);\n    return this;\n};\n\nPromise.prototype.cancellable = function Promise$cancellable() {\n    if (this._cancellable()) return this;\n    this._setCancellable();\n    this._cancellationParent = void 0;\n    return this;\n};\n\nPromise.prototype.uncancellable = function Promise$uncancellable() {\n    var ret = new Promise(INTERNAL);\n    ret._propagateFrom(this, 2 | 4);\n    ret._follow(this);\n    ret._unsetCancellable();\n    return ret;\n};\n\nPromise.prototype.fork =\nfunction Promise$fork(didFulfill, didReject, didProgress) {\n    var ret = this._then(didFulfill, didReject, didProgress,\n                         void 0, void 0);\n\n    ret._setCancellable();\n    ret._cancellationParent = void 0;\n    return ret;\n};\n};\n","/**\n * The MIT License (MIT)\n * \n * Copyright (c) 2014 Petka Antonov\n * \n * Permission is hereby granted, free of charge, to any person obtaining a copy\n * of this software and associated documentation files (the \"Software\"), to deal\n * in the Software without restriction, including without limitation the rights\n * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell\n * copies of the Software, and to permit persons to whom the Software is\n * furnished to do so, subject to the following conditions:</p>\n * \n * The above copyright notice and this permission notice shall be included in\n * all copies or substantial portions of the Software.\n * \n * THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT.  IN NO EVENT SHALL THE\n * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\n * THE SOFTWARE.\n * \n */\n\"use strict\";\nmodule.exports = function(Promise, INTERNAL) {\nvar PromiseMap = Promise.map;\n\nPromise.prototype.filter = function Promise$filter(fn, options) {\n    return PromiseMap(this, fn, options, INTERNAL);\n};\n\nPromise.filter = function Promise$Filter(promises, fn, options) {\n    return PromiseMap(promises, fn, options, INTERNAL);\n};\n};\n","/**\n * The MIT License (MIT)\n * \n * Copyright (c) 2014 Petka Antonov\n * \n * Permission is hereby granted, free of charge, to any person obtaining a copy\n * of this software and associated documentation files (the \"Software\"), to deal\n * in the Software without restriction, including without limitation the rights\n * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell\n * copies of the Software, and to permit persons to whom the Software is\n * furnished to do so, subject to the following conditions:</p>\n * \n * The above copyright notice and this permission notice shall be included in\n * all copies or substantial portions of the Software.\n * \n * THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT.  IN NO EVENT SHALL THE\n * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\n * THE SOFTWARE.\n * \n */\n\"use strict\";\nmodule.exports = function(Promise) {\nvar SomePromiseArray = Promise._SomePromiseArray;\nfunction Promise$_Any(promises) {\n    var ret = new SomePromiseArray(promises);\n    var promise = ret.promise();\n    if (promise.isRejected()) {\n        return promise;\n    }\n    ret.setHowMany(1);\n    ret.setUnwrap();\n    ret.init();\n    return promise;\n}\n\nPromise.any = function Promise$Any(promises) {\n    return Promise$_Any(promises);\n};\n\nPromise.prototype.any = function Promise$any() {\n    return Promise$_Any(this);\n};\n\n};\n","/**\n * The MIT License (MIT)\n * \n * Copyright (c) 2014 Petka Antonov\n * \n * Permission is hereby granted, free of charge, to any person obtaining a copy\n * of this software and associated documentation files (the \"Software\"), to deal\n * in the Software without restriction, including without limitation the rights\n * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell\n * copies of the Software, and to permit persons to whom the Software is\n * furnished to do so, subject to the following conditions:</p>\n * \n * The above copyright notice and this permission notice shall be included in\n * all copies or substantial portions of the Software.\n * \n * THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT.  IN NO EVENT SHALL THE\n * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\n * THE SOFTWARE.\n * \n */\n\"use strict\";\nmodule.exports = function(Promise, INTERNAL) {\nvar PromiseReduce = Promise.reduce;\n\nPromise.prototype.each = function Promise$each(fn) {\n    return PromiseReduce(this, fn, null, INTERNAL);\n};\n\nPromise.each = function Promise$Each(promises, fn) {\n    return PromiseReduce(promises, fn, null, INTERNAL);\n};\n};\n","/**\n * The MIT License (MIT)\n * \n * Copyright (c) 2014 Petka Antonov\n * \n * Permission is hereby granted, free of charge, to any person obtaining a copy\n * of this software and associated documentation files (the \"Software\"), to deal\n * in the Software without restriction, including without limitation the rights\n * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell\n * copies of the Software, and to permit persons to whom the Software is\n * furnished to do so, subject to the following conditions:</p>\n * \n * The above copyright notice and this permission notice shall be included in\n * all copies or substantial portions of the Software.\n * \n * THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT.  IN NO EVENT SHALL THE\n * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\n * THE SOFTWARE.\n * \n */\n\"use strict\";\nmodule.exports = function (Promise, apiRejection, cast) {\n    var TypeError = require(\"./errors.js\").TypeError;\n    var inherits = require(\"./util.js\").inherits;\n    var PromiseInspection = Promise.PromiseInspection;\n\n    function inspectionMapper(inspections) {\n        var len = inspections.length;\n        for (var i = 0; i < len; ++i) {\n            var inspection = inspections[i];\n            if (inspection.isRejected()) {\n                return Promise.reject(inspection.error());\n            }\n            inspections[i] = inspection.value();\n        }\n        return inspections;\n    }\n\n    function thrower(e) {\n        setTimeout(function(){throw e;}, 0);\n    }\n\n    function castPreservingDisposable(thenable) {\n        var maybePromise = cast(thenable, void 0);\n        if (maybePromise !== thenable &&\n            typeof thenable._isDisposable === \"function\" &&\n            typeof thenable._getDisposer === \"function\" &&\n            thenable._isDisposable()) {\n            maybePromise._setDisposable(thenable._getDisposer());\n        }\n        return maybePromise;\n    }\n    function dispose(resources, inspection) {\n        var i = 0;\n        var len = resources.length;\n        var ret = Promise.defer();\n        function iterator() {\n            if (i >= len) return ret.resolve();\n            var maybePromise = castPreservingDisposable(resources[i++]);\n            if (maybePromise instanceof Promise &&\n                maybePromise._isDisposable()) {\n                try {\n                    maybePromise = cast(maybePromise._getDisposer()\n                                        .tryDispose(inspection), void 0);\n                } catch (e) {\n                    return thrower(e);\n                }\n                if (maybePromise instanceof Promise) {\n                    return maybePromise._then(iterator, thrower,\n                                              null, null, null);\n                }\n            }\n            iterator();\n        }\n        iterator();\n        return ret.promise;\n    }\n\n    function disposerSuccess(value) {\n        var inspection = new PromiseInspection();\n        inspection._settledValue = value;\n        inspection._bitField = 268435456;\n        return dispose(this, inspection).thenReturn(value);\n    }\n\n    function disposerFail(reason) {\n        var inspection = new PromiseInspection();\n        inspection._settledValue = reason;\n        inspection._bitField = 134217728;\n        return dispose(this, inspection).thenThrow(reason);\n    }\n\n    function Disposer(data, promise) {\n        this._data = data;\n        this._promise = promise;\n    }\n\n    Disposer.prototype.data = function Disposer$data() {\n        return this._data;\n    };\n\n    Disposer.prototype.promise = function Disposer$promise() {\n        return this._promise;\n    };\n\n    Disposer.prototype.resource = function Disposer$resource() {\n        if (this.promise().isFulfilled()) {\n            return this.promise().value();\n        }\n        return null;\n    };\n\n    Disposer.prototype.tryDispose = function(inspection) {\n        var resource = this.resource();\n        var ret = resource !== null\n            ? this.doDispose(resource, inspection) : null;\n        this._promise._unsetDisposable();\n        this._data = this._promise = null;\n        return ret;\n    };\n\n    Disposer.isDisposer = function Disposer$isDisposer(d) {\n        return (d != null &&\n                typeof d.resource === \"function\" &&\n                typeof d.tryDispose === \"function\");\n    };\n\n    function FunctionDisposer(fn, promise) {\n        this.constructor$(fn, promise);\n    }\n    inherits(FunctionDisposer, Disposer);\n\n    FunctionDisposer.prototype.doDispose = function (resource, inspection) {\n        var fn = this.data();\n        return fn.call(resource, resource, inspection);\n    };\n\n    Promise.using = function Promise$using() {\n        var len = arguments.length;\n        if (len < 2) return apiRejection(\n                        \"you must pass at least 2 arguments to Promise.using\");\n        var fn = arguments[len - 1];\n        if (typeof fn !== \"function\") return apiRejection(\"fn must be a function\");\n        len--;\n        var resources = new Array(len);\n        for (var i = 0; i < len; ++i) {\n            var resource = arguments[i];\n            if (Disposer.isDisposer(resource)) {\n                var disposer = resource;\n                resource = resource.promise();\n                resource._setDisposable(disposer);\n            }\n            resources[i] = resource;\n        }\n\n        return Promise.settle(resources)\n            .then(inspectionMapper)\n            .spread(fn)\n            ._then(disposerSuccess, disposerFail, void 0, resources, void 0);\n    };\n\n    Promise.prototype._setDisposable =\n    function Promise$_setDisposable(disposer) {\n        this._bitField = this._bitField | 262144;\n        this._disposer = disposer;\n    };\n\n    Promise.prototype._isDisposable = function Promise$_isDisposable() {\n        return (this._bitField & 262144) > 0;\n    };\n\n    Promise.prototype._getDisposer = function Promise$_getDisposer() {\n        return this._disposer;\n    };\n\n    Promise.prototype._unsetDisposable = function Promise$_unsetDisposable() {\n        this._bitField = this._bitField & (~262144);\n        this._disposer = void 0;\n    };\n\n    Promise.prototype.disposer = function Promise$disposer(fn) {\n        if (typeof fn === \"function\") {\n            return new FunctionDisposer(fn, this);\n        }\n        throw new TypeError();\n    };\n\n};\n","var Stream = require('stream'); // hack to fix a circular dependency issue when used with browserify\nexports = module.exports = require('./lib/_stream_readable.js');\nexports.Stream = Stream;\nexports.Readable = exports;\nexports.Writable = require('./lib/_stream_writable.js');\nexports.Duplex = require('./lib/_stream_duplex.js');\nexports.Transform = require('./lib/_stream_transform.js');\nexports.PassThrough = require('./lib/_stream_passthrough.js');\n","module.exports = require(\"./lib/_stream_duplex.js\")\n","module.exports = require(\"./lib/_stream_writable.js\")\n","module.exports = require(\"./lib/_stream_transform.js\")\n","module.exports = require(\"./lib/_stream_passthrough.js\")\n","/**\n * The MIT License (MIT)\n * \n * Copyright (c) 2014 Petka Antonov\n * \n * Permission is hereby granted, free of charge, to any person obtaining a copy\n * of this software and associated documentation files (the \"Software\"), to deal\n * in the Software without restriction, including without limitation the rights\n * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell\n * copies of the Software, and to permit persons to whom the Software is\n * furnished to do so, subject to the following conditions:</p>\n * \n * The above copyright notice and this permission notice shall be included in\n * all copies or substantial portions of the Software.\n * \n * THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT.  IN NO EVENT SHALL THE\n * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\n * THE SOFTWARE.\n * \n */\n\"use strict\";\nmodule.exports = function(Promise) {\nvar TypeError = require('./errors.js').TypeError;\n\nfunction apiRejection(msg) {\n    var error = new TypeError(msg);\n    var ret = Promise.rejected(error);\n    var parent = ret._peekContext();\n    if (parent != null) {\n        parent._attachExtraTrace(error);\n    }\n    return ret;\n}\n\nreturn apiRejection;\n};\n","// Copyright Joyent, Inc. and other Node contributors.\n//\n// Permission is hereby granted, free of charge, to any person obtaining a\n// copy of this software and associated documentation files (the\n// \"Software\"), to deal in the Software without restriction, including\n// without limitation the rights to use, copy, modify, merge, publish,\n// distribute, sublicense, and/or sell copies of the Software, and to permit\n// persons to whom the Software is furnished to do so, subject to the\n// following conditions:\n//\n// The above copyright notice and this permission notice shall be included\n// in all copies or substantial portions of the Software.\n//\n// THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS\n// OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF\n// MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN\n// NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM,\n// DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR\n// OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE\n// USE OR OTHER DEALINGS IN THE SOFTWARE.\n\nmodule.exports = Readable;\n\n/*<replacement>*/\nvar isArray = require('isarray');\n/*</replacement>*/\n\n\n/*<replacement>*/\nvar Buffer = require('buffer').Buffer;\n/*</replacement>*/\n\nReadable.ReadableState = ReadableState;\n\nvar EE = require('events').EventEmitter;\n\n/*<replacement>*/\nif (!EE.listenerCount) EE.listenerCount = function(emitter, type) {\n  return emitter.listeners(type).length;\n};\n/*</replacement>*/\n\nvar Stream = require('stream');\n\n/*<replacement>*/\nvar util = require('core-util-is');\nutil.inherits = require('inherits');\n/*</replacement>*/\n\nvar StringDecoder;\n\nutil.inherits(Readable, Stream);\n\nfunction ReadableState(options, stream) {\n  options = options || {};\n\n  // the point at which it stops calling _read() to fill the buffer\n  // Note: 0 is a valid value, means \"don't call _read preemptively ever\"\n  var hwm = options.highWaterMark;\n  this.highWaterMark = (hwm || hwm === 0) ? hwm : 16 * 1024;\n\n  // cast to ints.\n  this.highWaterMark = ~~this.highWaterMark;\n\n  this.buffer = [];\n  this.length = 0;\n  this.pipes = null;\n  this.pipesCount = 0;\n  this.flowing = false;\n  this.ended = false;\n  this.endEmitted = false;\n  this.reading = false;\n\n  // In streams that never have any data, and do push(null) right away,\n  // the consumer can miss the 'end' event if they do some I/O before\n  // consuming the stream.  So, we don't emit('end') until some reading\n  // happens.\n  this.calledRead = false;\n\n  // a flag to be able to tell if the onwrite cb is called immediately,\n  // or on a later tick.  We set this to true at first, becuase any\n  // actions that shouldn't happen until \"later\" should generally also\n  // not happen before the first write call.\n  this.sync = true;\n\n  // whenever we return null, then we set a flag to say\n  // that we're awaiting a 'readable' event emission.\n  this.needReadable = false;\n  this.emittedReadable = false;\n  this.readableListening = false;\n\n\n  // object stream flag. Used to make read(n) ignore n and to\n  // make all the buffer merging and length checks go away\n  this.objectMode = !!options.objectMode;\n\n  // Crypto is kind of old and crusty.  Historically, its default string\n  // encoding is 'binary' so we have to make this configurable.\n  // Everything else in the universe uses 'utf8', though.\n  this.defaultEncoding = options.defaultEncoding || 'utf8';\n\n  // when piping, we only care about 'readable' events that happen\n  // after read()ing all the bytes and not getting any pushback.\n  this.ranOut = false;\n\n  // the number of writers that are awaiting a drain event in .pipe()s\n  this.awaitDrain = 0;\n\n  // if true, a maybeReadMore has been scheduled\n  this.readingMore = false;\n\n  this.decoder = null;\n  this.encoding = null;\n  if (options.encoding) {\n    if (!StringDecoder)\n      StringDecoder = require('string_decoder/').StringDecoder;\n    this.decoder = new StringDecoder(options.encoding);\n    this.encoding = options.encoding;\n  }\n}\n\nfunction Readable(options) {\n  if (!(this instanceof Readable))\n    return new Readable(options);\n\n  this._readableState = new ReadableState(options, this);\n\n  // legacy\n  this.readable = true;\n\n  Stream.call(this);\n}\n\n// Manually shove something into the read() buffer.\n// This returns true if the highWaterMark has not been hit yet,\n// similar to how Writable.write() returns true if you should\n// write() some more.\nReadable.prototype.push = function(chunk, encoding) {\n  var state = this._readableState;\n\n  if (typeof chunk === 'string' && !state.objectMode) {\n    encoding = encoding || state.defaultEncoding;\n    if (encoding !== state.encoding) {\n      chunk = new Buffer(chunk, encoding);\n      encoding = '';\n    }\n  }\n\n  return readableAddChunk(this, state, chunk, encoding, false);\n};\n\n// Unshift should *always* be something directly out of read()\nReadable.prototype.unshift = function(chunk) {\n  var state = this._readableState;\n  return readableAddChunk(this, state, chunk, '', true);\n};\n\nfunction readableAddChunk(stream, state, chunk, encoding, addToFront) {\n  var er = chunkInvalid(state, chunk);\n  if (er) {\n    stream.emit('error', er);\n  } else if (chunk === null || chunk === undefined) {\n    state.reading = false;\n    if (!state.ended)\n      onEofChunk(stream, state);\n  } else if (state.objectMode || chunk && chunk.length > 0) {\n    if (state.ended && !addToFront) {\n      var e = new Error('stream.push() after EOF');\n      stream.emit('error', e);\n    } else if (state.endEmitted && addToFront) {\n      var e = new Error('stream.unshift() after end event');\n      stream.emit('error', e);\n    } else {\n      if (state.decoder && !addToFront && !encoding)\n        chunk = state.decoder.write(chunk);\n\n      // update the buffer info.\n      state.length += state.objectMode ? 1 : chunk.length;\n      if (addToFront) {\n        state.buffer.unshift(chunk);\n      } else {\n        state.reading = false;\n        state.buffer.push(chunk);\n      }\n\n      if (state.needReadable)\n        emitReadable(stream);\n\n      maybeReadMore(stream, state);\n    }\n  } else if (!addToFront) {\n    state.reading = false;\n  }\n\n  return needMoreData(state);\n}\n\n\n\n// if it's past the high water mark, we can push in some more.\n// Also, if we have no data yet, we can stand some\n// more bytes.  This is to work around cases where hwm=0,\n// such as the repl.  Also, if the push() triggered a\n// readable event, and the user called read(largeNumber) such that\n// needReadable was set, then we ought to push more, so that another\n// 'readable' event will be triggered.\nfunction needMoreData(state) {\n  return !state.ended &&\n         (state.needReadable ||\n          state.length < state.highWaterMark ||\n          state.length === 0);\n}\n\n// backwards compatibility.\nReadable.prototype.setEncoding = function(enc) {\n  if (!StringDecoder)\n    StringDecoder = require('string_decoder/').StringDecoder;\n  this._readableState.decoder = new StringDecoder(enc);\n  this._readableState.encoding = enc;\n};\n\n// Don't raise the hwm > 128MB\nvar MAX_HWM = 0x800000;\nfunction roundUpToNextPowerOf2(n) {\n  if (n >= MAX_HWM) {\n    n = MAX_HWM;\n  } else {\n    // Get the next highest power of 2\n    n--;\n    for (var p = 1; p < 32; p <<= 1) n |= n >> p;\n    n++;\n  }\n  return n;\n}\n\nfunction howMuchToRead(n, state) {\n  if (state.length === 0 && state.ended)\n    return 0;\n\n  if (state.objectMode)\n    return n === 0 ? 0 : 1;\n\n  if (n === null || isNaN(n)) {\n    // only flow one buffer at a time\n    if (state.flowing && state.buffer.length)\n      return state.buffer[0].length;\n    else\n      return state.length;\n  }\n\n  if (n <= 0)\n    return 0;\n\n  // If we're asking for more than the target buffer level,\n  // then raise the water mark.  Bump up to the next highest\n  // power of 2, to prevent increasing it excessively in tiny\n  // amounts.\n  if (n > state.highWaterMark)\n    state.highWaterMark = roundUpToNextPowerOf2(n);\n\n  // don't have that much.  return null, unless we've ended.\n  if (n > state.length) {\n    if (!state.ended) {\n      state.needReadable = true;\n      return 0;\n    } else\n      return state.length;\n  }\n\n  return n;\n}\n\n// you can override either this method, or the async _read(n) below.\nReadable.prototype.read = function(n) {\n  var state = this._readableState;\n  state.calledRead = true;\n  var nOrig = n;\n  var ret;\n\n  if (typeof n !== 'number' || n > 0)\n    state.emittedReadable = false;\n\n  // if we're doing read(0) to trigger a readable event, but we\n  // already have a bunch of data in the buffer, then just trigger\n  // the 'readable' event and move on.\n  if (n === 0 &&\n      state.needReadable &&\n      (state.length >= state.highWaterMark || state.ended)) {\n    emitReadable(this);\n    return null;\n  }\n\n  n = howMuchToRead(n, state);\n\n  // if we've ended, and we're now clear, then finish it up.\n  if (n === 0 && state.ended) {\n    ret = null;\n\n    // In cases where the decoder did not receive enough data\n    // to produce a full chunk, then immediately received an\n    // EOF, state.buffer will contain [<Buffer >, <Buffer 00 ...>].\n    // howMuchToRead will see this and coerce the amount to\n    // read to zero (because it's looking at the length of the\n    // first <Buffer > in state.buffer), and we'll end up here.\n    //\n    // This can only happen via state.decoder -- no other venue\n    // exists for pushing a zero-length chunk into state.buffer\n    // and triggering this behavior. In this case, we return our\n    // remaining data and end the stream, if appropriate.\n    if (state.length > 0 && state.decoder) {\n      ret = fromList(n, state);\n      state.length -= ret.length;\n    }\n\n    if (state.length === 0)\n      endReadable(this);\n\n    return ret;\n  }\n\n  // All the actual chunk generation logic needs to be\n  // *below* the call to _read.  The reason is that in certain\n  // synthetic stream cases, such as passthrough streams, _read\n  // may be a completely synchronous operation which may change\n  // the state of the read buffer, providing enough data when\n  // before there was *not* enough.\n  //\n  // So, the steps are:\n  // 1. Figure out what the state of things will be after we do\n  // a read from the buffer.\n  //\n  // 2. If that resulting state will trigger a _read, then call _read.\n  // Note that this may be asynchronous, or synchronous.  Yes, it is\n  // deeply ugly to write APIs this way, but that still doesn't mean\n  // that the Readable class should behave improperly, as streams are\n  // designed to be sync/async agnostic.\n  // Take note if the _read call is sync or async (ie, if the read call\n  // has returned yet), so that we know whether or not it's safe to emit\n  // 'readable' etc.\n  //\n  // 3. Actually pull the requested chunks out of the buffer and return.\n\n  // if we need a readable event, then we need to do some reading.\n  var doRead = state.needReadable;\n\n  // if we currently have less than the highWaterMark, then also read some\n  if (state.length - n <= state.highWaterMark)\n    doRead = true;\n\n  // however, if we've ended, then there's no point, and if we're already\n  // reading, then it's unnecessary.\n  if (state.ended || state.reading)\n    doRead = false;\n\n  if (doRead) {\n    state.reading = true;\n    state.sync = true;\n    // if the length is currently zero, then we *need* a readable event.\n    if (state.length === 0)\n      state.needReadable = true;\n    // call internal read method\n    this._read(state.highWaterMark);\n    state.sync = false;\n  }\n\n  // If _read called its callback synchronously, then `reading`\n  // will be false, and we need to re-evaluate how much data we\n  // can return to the user.\n  if (doRead && !state.reading)\n    n = howMuchToRead(nOrig, state);\n\n  if (n > 0)\n    ret = fromList(n, state);\n  else\n    ret = null;\n\n  if (ret === null) {\n    state.needReadable = true;\n    n = 0;\n  }\n\n  state.length -= n;\n\n  // If we have nothing in the buffer, then we want to know\n  // as soon as we *do* get something into the buffer.\n  if (state.length === 0 && !state.ended)\n    state.needReadable = true;\n\n  // If we happened to read() exactly the remaining amount in the\n  // buffer, and the EOF has been seen at this point, then make sure\n  // that we emit 'end' on the very next tick.\n  if (state.ended && !state.endEmitted && state.length === 0)\n    endReadable(this);\n\n  return ret;\n};\n\nfunction chunkInvalid(state, chunk) {\n  var er = null;\n  if (!Buffer.isBuffer(chunk) &&\n      'string' !== typeof chunk &&\n      chunk !== null &&\n      chunk !== undefined &&\n      !state.objectMode) {\n    er = new TypeError('Invalid non-string/buffer chunk');\n  }\n  return er;\n}\n\n\nfunction onEofChunk(stream, state) {\n  if (state.decoder && !state.ended) {\n    var chunk = state.decoder.end();\n    if (chunk && chunk.length) {\n      state.buffer.push(chunk);\n      state.length += state.objectMode ? 1 : chunk.length;\n    }\n  }\n  state.ended = true;\n\n  // if we've ended and we have some data left, then emit\n  // 'readable' now to make sure it gets picked up.\n  if (state.length > 0)\n    emitReadable(stream);\n  else\n    endReadable(stream);\n}\n\n// Don't emit readable right away in sync mode, because this can trigger\n// another read() call => stack overflow.  This way, it might trigger\n// a nextTick recursion warning, but that's not so bad.\nfunction emitReadable(stream) {\n  var state = stream._readableState;\n  state.needReadable = false;\n  if (state.emittedReadable)\n    return;\n\n  state.emittedReadable = true;\n  if (state.sync)\n    process.nextTick(function() {\n      emitReadable_(stream);\n    });\n  else\n    emitReadable_(stream);\n}\n\nfunction emitReadable_(stream) {\n  stream.emit('readable');\n}\n\n\n// at this point, the user has presumably seen the 'readable' event,\n// and called read() to consume some data.  that may have triggered\n// in turn another _read(n) call, in which case reading = true if\n// it's in progress.\n// However, if we're not ended, or reading, and the length < hwm,\n// then go ahead and try to read some more preemptively.\nfunction maybeReadMore(stream, state) {\n  if (!state.readingMore) {\n    state.readingMore = true;\n    process.nextTick(function() {\n      maybeReadMore_(stream, state);\n    });\n  }\n}\n\nfunction maybeReadMore_(stream, state) {\n  var len = state.length;\n  while (!state.reading && !state.flowing && !state.ended &&\n         state.length < state.highWaterMark) {\n    stream.read(0);\n    if (len === state.length)\n      // didn't get any data, stop spinning.\n      break;\n    else\n      len = state.length;\n  }\n  state.readingMore = false;\n}\n\n// abstract method.  to be overridden in specific implementation classes.\n// call cb(er, data) where data is <= n in length.\n// for virtual (non-string, non-buffer) streams, \"length\" is somewhat\n// arbitrary, and perhaps not very meaningful.\nReadable.prototype._read = function(n) {\n  this.emit('error', new Error('not implemented'));\n};\n\nReadable.prototype.pipe = function(dest, pipeOpts) {\n  var src = this;\n  var state = this._readableState;\n\n  switch (state.pipesCount) {\n    case 0:\n      state.pipes = dest;\n      break;\n    case 1:\n      state.pipes = [state.pipes, dest];\n      break;\n    default:\n      state.pipes.push(dest);\n      break;\n  }\n  state.pipesCount += 1;\n\n  var doEnd = (!pipeOpts || pipeOpts.end !== false) &&\n              dest !== process.stdout &&\n              dest !== process.stderr;\n\n  var endFn = doEnd ? onend : cleanup;\n  if (state.endEmitted)\n    process.nextTick(endFn);\n  else\n    src.once('end', endFn);\n\n  dest.on('unpipe', onunpipe);\n  function onunpipe(readable) {\n    if (readable !== src) return;\n    cleanup();\n  }\n\n  function onend() {\n    dest.end();\n  }\n\n  // when the dest drains, it reduces the awaitDrain counter\n  // on the source.  This would be more elegant with a .once()\n  // handler in flow(), but adding and removing repeatedly is\n  // too slow.\n  var ondrain = pipeOnDrain(src);\n  dest.on('drain', ondrain);\n\n  function cleanup() {\n    // cleanup event handlers once the pipe is broken\n    dest.removeListener('close', onclose);\n    dest.removeListener('finish', onfinish);\n    dest.removeListener('drain', ondrain);\n    dest.removeListener('error', onerror);\n    dest.removeListener('unpipe', onunpipe);\n    src.removeListener('end', onend);\n    src.removeListener('end', cleanup);\n\n    // if the reader is waiting for a drain event from this\n    // specific writer, then it would cause it to never start\n    // flowing again.\n    // So, if this is awaiting a drain, then we just call it now.\n    // If we don't know, then assume that we are waiting for one.\n    if (!dest._writableState || dest._writableState.needDrain)\n      ondrain();\n  }\n\n  // if the dest has an error, then stop piping into it.\n  // however, don't suppress the throwing behavior for this.\n  function onerror(er) {\n    unpipe();\n    dest.removeListener('error', onerror);\n    if (EE.listenerCount(dest, 'error') === 0)\n      dest.emit('error', er);\n  }\n  // This is a brutally ugly hack to make sure that our error handler\n  // is attached before any userland ones.  NEVER DO THIS.\n  if (!dest._events || !dest._events.error)\n    dest.on('error', onerror);\n  else if (isArray(dest._events.error))\n    dest._events.error.unshift(onerror);\n  else\n    dest._events.error = [onerror, dest._events.error];\n\n\n\n  // Both close and finish should trigger unpipe, but only once.\n  function onclose() {\n    dest.removeListener('finish', onfinish);\n    unpipe();\n  }\n  dest.once('close', onclose);\n  function onfinish() {\n    dest.removeListener('close', onclose);\n    unpipe();\n  }\n  dest.once('finish', onfinish);\n\n  function unpipe() {\n    src.unpipe(dest);\n  }\n\n  // tell the dest that it's being piped to\n  dest.emit('pipe', src);\n\n  // start the flow if it hasn't been started already.\n  if (!state.flowing) {\n    // the handler that waits for readable events after all\n    // the data gets sucked out in flow.\n    // This would be easier to follow with a .once() handler\n    // in flow(), but that is too slow.\n    this.on('readable', pipeOnReadable);\n\n    state.flowing = true;\n    process.nextTick(function() {\n      flow(src);\n    });\n  }\n\n  return dest;\n};\n\nfunction pipeOnDrain(src) {\n  return function() {\n    var dest = this;\n    var state = src._readableState;\n    state.awaitDrain--;\n    if (state.awaitDrain === 0)\n      flow(src);\n  };\n}\n\nfunction flow(src) {\n  var state = src._readableState;\n  var chunk;\n  state.awaitDrain = 0;\n\n  function write(dest, i, list) {\n    var written = dest.write(chunk);\n    if (false === written) {\n      state.awaitDrain++;\n    }\n  }\n\n  while (state.pipesCount && null !== (chunk = src.read())) {\n\n    if (state.pipesCount === 1)\n      write(state.pipes, 0, null);\n    else\n      forEach(state.pipes, write);\n\n    src.emit('data', chunk);\n\n    // if anyone needs a drain, then we have to wait for that.\n    if (state.awaitDrain > 0)\n      return;\n  }\n\n  // if every destination was unpiped, either before entering this\n  // function, or in the while loop, then stop flowing.\n  //\n  // NB: This is a pretty rare edge case.\n  if (state.pipesCount === 0) {\n    state.flowing = false;\n\n    // if there were data event listeners added, then switch to old mode.\n    if (EE.listenerCount(src, 'data') > 0)\n      emitDataEvents(src);\n    return;\n  }\n\n  // at this point, no one needed a drain, so we just ran out of data\n  // on the next readable event, start it over again.\n  state.ranOut = true;\n}\n\nfunction pipeOnReadable() {\n  if (this._readableState.ranOut) {\n    this._readableState.ranOut = false;\n    flow(this);\n  }\n}\n\n\nReadable.prototype.unpipe = function(dest) {\n  var state = this._readableState;\n\n  // if we're not piping anywhere, then do nothing.\n  if (state.pipesCount === 0)\n    return this;\n\n  // just one destination.  most common case.\n  if (state.pipesCount === 1) {\n    // passed in one, but it's not the right one.\n    if (dest && dest !== state.pipes)\n      return this;\n\n    if (!dest)\n      dest = state.pipes;\n\n    // got a match.\n    state.pipes = null;\n    state.pipesCount = 0;\n    this.removeListener('readable', pipeOnReadable);\n    state.flowing = false;\n    if (dest)\n      dest.emit('unpipe', this);\n    return this;\n  }\n\n  // slow case. multiple pipe destinations.\n\n  if (!dest) {\n    // remove all.\n    var dests = state.pipes;\n    var len = state.pipesCount;\n    state.pipes = null;\n    state.pipesCount = 0;\n    this.removeListener('readable', pipeOnReadable);\n    state.flowing = false;\n\n    for (var i = 0; i < len; i++)\n      dests[i].emit('unpipe', this);\n    return this;\n  }\n\n  // try to find the right one.\n  var i = indexOf(state.pipes, dest);\n  if (i === -1)\n    return this;\n\n  state.pipes.splice(i, 1);\n  state.pipesCount -= 1;\n  if (state.pipesCount === 1)\n    state.pipes = state.pipes[0];\n\n  dest.emit('unpipe', this);\n\n  return this;\n};\n\n// set up data events if they are asked for\n// Ensure readable listeners eventually get something\nReadable.prototype.on = function(ev, fn) {\n  var res = Stream.prototype.on.call(this, ev, fn);\n\n  if (ev === 'data' && !this._readableState.flowing)\n    emitDataEvents(this);\n\n  if (ev === 'readable' && this.readable) {\n    var state = this._readableState;\n    if (!state.readableListening) {\n      state.readableListening = true;\n      state.emittedReadable = false;\n      state.needReadable = true;\n      if (!state.reading) {\n        this.read(0);\n      } else if (state.length) {\n        emitReadable(this, state);\n      }\n    }\n  }\n\n  return res;\n};\nReadable.prototype.addListener = Readable.prototype.on;\n\n// pause() and resume() are remnants of the legacy readable stream API\n// If the user uses them, then switch into old mode.\nReadable.prototype.resume = function() {\n  emitDataEvents(this);\n  this.read(0);\n  this.emit('resume');\n};\n\nReadable.prototype.pause = function() {\n  emitDataEvents(this, true);\n  this.emit('pause');\n};\n\nfunction emitDataEvents(stream, startPaused) {\n  var state = stream._readableState;\n\n  if (state.flowing) {\n    // https://github.com/isaacs/readable-stream/issues/16\n    throw new Error('Cannot switch to old mode now.');\n  }\n\n  var paused = startPaused || false;\n  var readable = false;\n\n  // convert to an old-style stream.\n  stream.readable = true;\n  stream.pipe = Stream.prototype.pipe;\n  stream.on = stream.addListener = Stream.prototype.on;\n\n  stream.on('readable', function() {\n    readable = true;\n\n    var c;\n    while (!paused && (null !== (c = stream.read())))\n      stream.emit('data', c);\n\n    if (c === null) {\n      readable = false;\n      stream._readableState.needReadable = true;\n    }\n  });\n\n  stream.pause = function() {\n    paused = true;\n    this.emit('pause');\n  };\n\n  stream.resume = function() {\n    paused = false;\n    if (readable)\n      process.nextTick(function() {\n        stream.emit('readable');\n      });\n    else\n      this.read(0);\n    this.emit('resume');\n  };\n\n  // now make it start, just in case it hadn't already.\n  stream.emit('readable');\n}\n\n// wrap an old-style stream as the async data source.\n// This is *not* part of the readable stream interface.\n// It is an ugly unfortunate mess of history.\nReadable.prototype.wrap = function(stream) {\n  var state = this._readableState;\n  var paused = false;\n\n  var self = this;\n  stream.on('end', function() {\n    if (state.decoder && !state.ended) {\n      var chunk = state.decoder.end();\n      if (chunk && chunk.length)\n        self.push(chunk);\n    }\n\n    self.push(null);\n  });\n\n  stream.on('data', function(chunk) {\n    if (state.decoder)\n      chunk = state.decoder.write(chunk);\n\n    // don't skip over falsy values in objectMode\n    //if (state.objectMode && util.isNullOrUndefined(chunk))\n    if (state.objectMode && (chunk === null || chunk === undefined))\n      return;\n    else if (!state.objectMode && (!chunk || !chunk.length))\n      return;\n\n    var ret = self.push(chunk);\n    if (!ret) {\n      paused = true;\n      stream.pause();\n    }\n  });\n\n  // proxy all the other methods.\n  // important when wrapping filters and duplexes.\n  for (var i in stream) {\n    if (typeof stream[i] === 'function' &&\n        typeof this[i] === 'undefined') {\n      this[i] = function(method) { return function() {\n        return stream[method].apply(stream, arguments);\n      }}(i);\n    }\n  }\n\n  // proxy certain important events.\n  var events = ['error', 'close', 'destroy', 'pause', 'resume'];\n  forEach(events, function(ev) {\n    stream.on(ev, self.emit.bind(self, ev));\n  });\n\n  // when we try to consume some more bytes, simply unpause the\n  // underlying stream.\n  self._read = function(n) {\n    if (paused) {\n      paused = false;\n      stream.resume();\n    }\n  };\n\n  return self;\n};\n\n\n\n// exposed for testing purposes only.\nReadable._fromList = fromList;\n\n// Pluck off n bytes from an array of buffers.\n// Length is the combined lengths of all the buffers in the list.\nfunction fromList(n, state) {\n  var list = state.buffer;\n  var length = state.length;\n  var stringMode = !!state.decoder;\n  var objectMode = !!state.objectMode;\n  var ret;\n\n  // nothing in the list, definitely empty.\n  if (list.length === 0)\n    return null;\n\n  if (length === 0)\n    ret = null;\n  else if (objectMode)\n    ret = list.shift();\n  else if (!n || n >= length) {\n    // read it all, truncate the array.\n    if (stringMode)\n      ret = list.join('');\n    else\n      ret = Buffer.concat(list, length);\n    list.length = 0;\n  } else {\n    // read just some of it.\n    if (n < list[0].length) {\n      // just take a part of the first list item.\n      // slice is the same for buffers and strings.\n      var buf = list[0];\n      ret = buf.slice(0, n);\n      list[0] = buf.slice(n);\n    } else if (n === list[0].length) {\n      // first list is a perfect match\n      ret = list.shift();\n    } else {\n      // complex case.\n      // we have enough to cover it, but it spans past the first buffer.\n      if (stringMode)\n        ret = '';\n      else\n        ret = new Buffer(n);\n\n      var c = 0;\n      for (var i = 0, l = list.length; i < l && c < n; i++) {\n        var buf = list[0];\n        var cpy = Math.min(n - c, buf.length);\n\n        if (stringMode)\n          ret += buf.slice(0, cpy);\n        else\n          buf.copy(ret, c, 0, cpy);\n\n        if (cpy < buf.length)\n          list[0] = buf.slice(cpy);\n        else\n          list.shift();\n\n        c += cpy;\n      }\n    }\n  }\n\n  return ret;\n}\n\nfunction endReadable(stream) {\n  var state = stream._readableState;\n\n  // If we get here before consuming all the bytes, then that is a\n  // bug in node.  Should never happen.\n  if (state.length > 0)\n    throw new Error('endReadable called on non-empty stream');\n\n  if (!state.endEmitted && state.calledRead) {\n    state.ended = true;\n    process.nextTick(function() {\n      // Check that we didn't get one last unshift.\n      if (!state.endEmitted && state.length === 0) {\n        state.endEmitted = true;\n        stream.readable = false;\n        stream.emit('end');\n      }\n    });\n  }\n}\n\nfunction forEach (xs, f) {\n  for (var i = 0, l = xs.length; i < l; i++) {\n    f(xs[i], i);\n  }\n}\n\nfunction indexOf (xs, x) {\n  for (var i = 0, l = xs.length; i < l; i++) {\n    if (xs[i] === x) return i;\n  }\n  return -1;\n}\n","// Copyright Joyent, Inc. and other Node contributors.\n//\n// Permission is hereby granted, free of charge, to any person obtaining a\n// copy of this software and associated documentation files (the\n// \"Software\"), to deal in the Software without restriction, including\n// without limitation the rights to use, copy, modify, merge, publish,\n// distribute, sublicense, and/or sell copies of the Software, and to permit\n// persons to whom the Software is furnished to do so, subject to the\n// following conditions:\n//\n// The above copyright notice and this permission notice shall be included\n// in all copies or substantial portions of the Software.\n//\n// THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS\n// OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF\n// MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN\n// NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM,\n// DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR\n// OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE\n// USE OR OTHER DEALINGS IN THE SOFTWARE.\n\n// A bit simpler than readable streams.\n// Implement an async ._write(chunk, cb), and it'll handle all\n// the drain event emission and buffering.\n\nmodule.exports = Writable;\n\n/*<replacement>*/\nvar Buffer = require('buffer').Buffer;\n/*</replacement>*/\n\nWritable.WritableState = WritableState;\n\n\n/*<replacement>*/\nvar util = require('core-util-is');\nutil.inherits = require('inherits');\n/*</replacement>*/\n\nvar Stream = require('stream');\n\nutil.inherits(Writable, Stream);\n\nfunction WriteReq(chunk, encoding, cb) {\n  this.chunk = chunk;\n  this.encoding = encoding;\n  this.callback = cb;\n}\n\nfunction WritableState(options, stream) {\n  options = options || {};\n\n  // the point at which write() starts returning false\n  // Note: 0 is a valid value, means that we always return false if\n  // the entire buffer is not flushed immediately on write()\n  var hwm = options.highWaterMark;\n  this.highWaterMark = (hwm || hwm === 0) ? hwm : 16 * 1024;\n\n  // object stream flag to indicate whether or not this stream\n  // contains buffers or objects.\n  this.objectMode = !!options.objectMode;\n\n  // cast to ints.\n  this.highWaterMark = ~~this.highWaterMark;\n\n  this.needDrain = false;\n  // at the start of calling end()\n  this.ending = false;\n  // when end() has been called, and returned\n  this.ended = false;\n  // when 'finish' is emitted\n  this.finished = false;\n\n  // should we decode strings into buffers before passing to _write?\n  // this is here so that some node-core streams can optimize string\n  // handling at a lower level.\n  var noDecode = options.decodeStrings === false;\n  this.decodeStrings = !noDecode;\n\n  // Crypto is kind of old and crusty.  Historically, its default string\n  // encoding is 'binary' so we have to make this configurable.\n  // Everything else in the universe uses 'utf8', though.\n  this.defaultEncoding = options.defaultEncoding || 'utf8';\n\n  // not an actual buffer we keep track of, but a measurement\n  // of how much we're waiting to get pushed to some underlying\n  // socket or file.\n  this.length = 0;\n\n  // a flag to see when we're in the middle of a write.\n  this.writing = false;\n\n  // a flag to be able to tell if the onwrite cb is called immediately,\n  // or on a later tick.  We set this to true at first, becuase any\n  // actions that shouldn't happen until \"later\" should generally also\n  // not happen before the first write call.\n  this.sync = true;\n\n  // a flag to know if we're processing previously buffered items, which\n  // may call the _write() callback in the same tick, so that we don't\n  // end up in an overlapped onwrite situation.\n  this.bufferProcessing = false;\n\n  // the callback that's passed to _write(chunk,cb)\n  this.onwrite = function(er) {\n    onwrite(stream, er);\n  };\n\n  // the callback that the user supplies to write(chunk,encoding,cb)\n  this.writecb = null;\n\n  // the amount that is being written when _write is called.\n  this.writelen = 0;\n\n  this.buffer = [];\n\n  // True if the error was already emitted and should not be thrown again\n  this.errorEmitted = false;\n}\n\nfunction Writable(options) {\n  var Duplex = require('./_stream_duplex');\n\n  // Writable ctor is applied to Duplexes, though they're not\n  // instanceof Writable, they're instanceof Readable.\n  if (!(this instanceof Writable) && !(this instanceof Duplex))\n    return new Writable(options);\n\n  this._writableState = new WritableState(options, this);\n\n  // legacy.\n  this.writable = true;\n\n  Stream.call(this);\n}\n\n// Otherwise people can pipe Writable streams, which is just wrong.\nWritable.prototype.pipe = function() {\n  this.emit('error', new Error('Cannot pipe. Not readable.'));\n};\n\n\nfunction writeAfterEnd(stream, state, cb) {\n  var er = new Error('write after end');\n  // TODO: defer error events consistently everywhere, not just the cb\n  stream.emit('error', er);\n  process.nextTick(function() {\n    cb(er);\n  });\n}\n\n// If we get something that is not a buffer, string, null, or undefined,\n// and we're not in objectMode, then that's an error.\n// Otherwise stream chunks are all considered to be of length=1, and the\n// watermarks determine how many objects to keep in the buffer, rather than\n// how many bytes or characters.\nfunction validChunk(stream, state, chunk, cb) {\n  var valid = true;\n  if (!Buffer.isBuffer(chunk) &&\n      'string' !== typeof chunk &&\n      chunk !== null &&\n      chunk !== undefined &&\n      !state.objectMode) {\n    var er = new TypeError('Invalid non-string/buffer chunk');\n    stream.emit('error', er);\n    process.nextTick(function() {\n      cb(er);\n    });\n    valid = false;\n  }\n  return valid;\n}\n\nWritable.prototype.write = function(chunk, encoding, cb) {\n  var state = this._writableState;\n  var ret = false;\n\n  if (typeof encoding === 'function') {\n    cb = encoding;\n    encoding = null;\n  }\n\n  if (Buffer.isBuffer(chunk))\n    encoding = 'buffer';\n  else if (!encoding)\n    encoding = state.defaultEncoding;\n\n  if (typeof cb !== 'function')\n    cb = function() {};\n\n  if (state.ended)\n    writeAfterEnd(this, state, cb);\n  else if (validChunk(this, state, chunk, cb))\n    ret = writeOrBuffer(this, state, chunk, encoding, cb);\n\n  return ret;\n};\n\nfunction decodeChunk(state, chunk, encoding) {\n  if (!state.objectMode &&\n      state.decodeStrings !== false &&\n      typeof chunk === 'string') {\n    chunk = new Buffer(chunk, encoding);\n  }\n  return chunk;\n}\n\n// if we're already writing something, then just put this\n// in the queue, and wait our turn.  Otherwise, call _write\n// If we return false, then we need a drain event, so set that flag.\nfunction writeOrBuffer(stream, state, chunk, encoding, cb) {\n  chunk = decodeChunk(state, chunk, encoding);\n  if (Buffer.isBuffer(chunk))\n    encoding = 'buffer';\n  var len = state.objectMode ? 1 : chunk.length;\n\n  state.length += len;\n\n  var ret = state.length < state.highWaterMark;\n  // we must ensure that previous needDrain will not be reset to false.\n  if (!ret)\n    state.needDrain = true;\n\n  if (state.writing)\n    state.buffer.push(new WriteReq(chunk, encoding, cb));\n  else\n    doWrite(stream, state, len, chunk, encoding, cb);\n\n  return ret;\n}\n\nfunction doWrite(stream, state, len, chunk, encoding, cb) {\n  state.writelen = len;\n  state.writecb = cb;\n  state.writing = true;\n  state.sync = true;\n  stream._write(chunk, encoding, state.onwrite);\n  state.sync = false;\n}\n\nfunction onwriteError(stream, state, sync, er, cb) {\n  if (sync)\n    process.nextTick(function() {\n      cb(er);\n    });\n  else\n    cb(er);\n\n  stream._writableState.errorEmitted = true;\n  stream.emit('error', er);\n}\n\nfunction onwriteStateUpdate(state) {\n  state.writing = false;\n  state.writecb = null;\n  state.length -= state.writelen;\n  state.writelen = 0;\n}\n\nfunction onwrite(stream, er) {\n  var state = stream._writableState;\n  var sync = state.sync;\n  var cb = state.writecb;\n\n  onwriteStateUpdate(state);\n\n  if (er)\n    onwriteError(stream, state, sync, er, cb);\n  else {\n    // Check if we're actually ready to finish, but don't emit yet\n    var finished = needFinish(stream, state);\n\n    if (!finished && !state.bufferProcessing && state.buffer.length)\n      clearBuffer(stream, state);\n\n    if (sync) {\n      process.nextTick(function() {\n        afterWrite(stream, state, finished, cb);\n      });\n    } else {\n      afterWrite(stream, state, finished, cb);\n    }\n  }\n}\n\nfunction afterWrite(stream, state, finished, cb) {\n  if (!finished)\n    onwriteDrain(stream, state);\n  cb();\n  if (finished)\n    finishMaybe(stream, state);\n}\n\n// Must force callback to be called on nextTick, so that we don't\n// emit 'drain' before the write() consumer gets the 'false' return\n// value, and has a chance to attach a 'drain' listener.\nfunction onwriteDrain(stream, state) {\n  if (state.length === 0 && state.needDrain) {\n    state.needDrain = false;\n    stream.emit('drain');\n  }\n}\n\n\n// if there's something in the buffer waiting, then process it\nfunction clearBuffer(stream, state) {\n  state.bufferProcessing = true;\n\n  for (var c = 0; c < state.buffer.length; c++) {\n    var entry = state.buffer[c];\n    var chunk = entry.chunk;\n    var encoding = entry.encoding;\n    var cb = entry.callback;\n    var len = state.objectMode ? 1 : chunk.length;\n\n    doWrite(stream, state, len, chunk, encoding, cb);\n\n    // if we didn't call the onwrite immediately, then\n    // it means that we need to wait until it does.\n    // also, that means that the chunk and cb are currently\n    // being processed, so move the buffer counter past them.\n    if (state.writing) {\n      c++;\n      break;\n    }\n  }\n\n  state.bufferProcessing = false;\n  if (c < state.buffer.length)\n    state.buffer = state.buffer.slice(c);\n  else\n    state.buffer.length = 0;\n}\n\nWritable.prototype._write = function(chunk, encoding, cb) {\n  cb(new Error('not implemented'));\n};\n\nWritable.prototype.end = function(chunk, encoding, cb) {\n  var state = this._writableState;\n\n  if (typeof chunk === 'function') {\n    cb = chunk;\n    chunk = null;\n    encoding = null;\n  } else if (typeof encoding === 'function') {\n    cb = encoding;\n    encoding = null;\n  }\n\n  if (typeof chunk !== 'undefined' && chunk !== null)\n    this.write(chunk, encoding);\n\n  // ignore unnecessary end() calls.\n  if (!state.ending && !state.finished)\n    endWritable(this, state, cb);\n};\n\n\nfunction needFinish(stream, state) {\n  return (state.ending &&\n          state.length === 0 &&\n          !state.finished &&\n          !state.writing);\n}\n\nfunction finishMaybe(stream, state) {\n  var need = needFinish(stream, state);\n  if (need) {\n    state.finished = true;\n    stream.emit('finish');\n  }\n  return need;\n}\n\nfunction endWritable(stream, state, cb) {\n  state.ending = true;\n  finishMaybe(stream, state);\n  if (cb) {\n    if (state.finished)\n      process.nextTick(cb);\n    else\n      stream.once('finish', cb);\n  }\n  state.ended = true;\n}\n","// Copyright Joyent, Inc. and other Node contributors.\n//\n// Permission is hereby granted, free of charge, to any person obtaining a\n// copy of this software and associated documentation files (the\n// \"Software\"), to deal in the Software without restriction, including\n// without limitation the rights to use, copy, modify, merge, publish,\n// distribute, sublicense, and/or sell copies of the Software, and to permit\n// persons to whom the Software is furnished to do so, subject to the\n// following conditions:\n//\n// The above copyright notice and this permission notice shall be included\n// in all copies or substantial portions of the Software.\n//\n// THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS\n// OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF\n// MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN\n// NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM,\n// DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR\n// OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE\n// USE OR OTHER DEALINGS IN THE SOFTWARE.\n\n// a duplex stream is just a stream that is both readable and writable.\n// Since JS doesn't have multiple prototypal inheritance, this class\n// prototypally inherits from Readable, and then parasitically from\n// Writable.\n\nmodule.exports = Duplex;\n\n/*<replacement>*/\nvar objectKeys = Object.keys || function (obj) {\n  var keys = [];\n  for (var key in obj) keys.push(key);\n  return keys;\n}\n/*</replacement>*/\n\n\n/*<replacement>*/\nvar util = require('core-util-is');\nutil.inherits = require('inherits');\n/*</replacement>*/\n\nvar Readable = require('./_stream_readable');\nvar Writable = require('./_stream_writable');\n\nutil.inherits(Duplex, Readable);\n\nforEach(objectKeys(Writable.prototype), function(method) {\n  if (!Duplex.prototype[method])\n    Duplex.prototype[method] = Writable.prototype[method];\n});\n\nfunction Duplex(options) {\n  if (!(this instanceof Duplex))\n    return new Duplex(options);\n\n  Readable.call(this, options);\n  Writable.call(this, options);\n\n  if (options && options.readable === false)\n    this.readable = false;\n\n  if (options && options.writable === false)\n    this.writable = false;\n\n  this.allowHalfOpen = true;\n  if (options && options.allowHalfOpen === false)\n    this.allowHalfOpen = false;\n\n  this.once('end', onend);\n}\n\n// the no-half-open enforcer\nfunction onend() {\n  // if we allow half-open state, or if the writable side ended,\n  // then we're ok.\n  if (this.allowHalfOpen || this._writableState.ended)\n    return;\n\n  // no more data can be written.\n  // But allow more writes to happen in this tick.\n  process.nextTick(this.end.bind(this));\n}\n\nfunction forEach (xs, f) {\n  for (var i = 0, l = xs.length; i < l; i++) {\n    f(xs[i], i);\n  }\n}\n","// Copyright Joyent, Inc. and other Node contributors.\n//\n// Permission is hereby granted, free of charge, to any person obtaining a\n// copy of this software and associated documentation files (the\n// \"Software\"), to deal in the Software without restriction, including\n// without limitation the rights to use, copy, modify, merge, publish,\n// distribute, sublicense, and/or sell copies of the Software, and to permit\n// persons to whom the Software is furnished to do so, subject to the\n// following conditions:\n//\n// The above copyright notice and this permission notice shall be included\n// in all copies or substantial portions of the Software.\n//\n// THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS\n// OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF\n// MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN\n// NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM,\n// DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR\n// OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE\n// USE OR OTHER DEALINGS IN THE SOFTWARE.\n\n\n// a transform stream is a readable/writable stream where you do\n// something with the data.  Sometimes it's called a \"filter\",\n// but that's not a great name for it, since that implies a thing where\n// some bits pass through, and others are simply ignored.  (That would\n// be a valid example of a transform, of course.)\n//\n// While the output is causally related to the input, it's not a\n// necessarily symmetric or synchronous transformation.  For example,\n// a zlib stream might take multiple plain-text writes(), and then\n// emit a single compressed chunk some time in the future.\n//\n// Here's how this works:\n//\n// The Transform stream has all the aspects of the readable and writable\n// stream classes.  When you write(chunk), that calls _write(chunk,cb)\n// internally, and returns false if there's a lot of pending writes\n// buffered up.  When you call read(), that calls _read(n) until\n// there's enough pending readable data buffered up.\n//\n// In a transform stream, the written data is placed in a buffer.  When\n// _read(n) is called, it transforms the queued up data, calling the\n// buffered _write cb's as it consumes chunks.  If consuming a single\n// written chunk would result in multiple output chunks, then the first\n// outputted bit calls the readcb, and subsequent chunks just go into\n// the read buffer, and will cause it to emit 'readable' if necessary.\n//\n// This way, back-pressure is actually determined by the reading side,\n// since _read has to be called to start processing a new chunk.  However,\n// a pathological inflate type of transform can cause excessive buffering\n// here.  For example, imagine a stream where every byte of input is\n// interpreted as an integer from 0-255, and then results in that many\n// bytes of output.  Writing the 4 bytes {ff,ff,ff,ff} would result in\n// 1kb of data being output.  In this case, you could write a very small\n// amount of input, and end up with a very large amount of output.  In\n// such a pathological inflating mechanism, there'd be no way to tell\n// the system to stop doing the transform.  A single 4MB write could\n// cause the system to run out of memory.\n//\n// However, even in such a pathological case, only a single written chunk\n// would be consumed, and then the rest would wait (un-transformed) until\n// the results of the previous transformed chunk were consumed.\n\nmodule.exports = Transform;\n\nvar Duplex = require('./_stream_duplex');\n\n/*<replacement>*/\nvar util = require('core-util-is');\nutil.inherits = require('inherits');\n/*</replacement>*/\n\nutil.inherits(Transform, Duplex);\n\n\nfunction TransformState(options, stream) {\n  this.afterTransform = function(er, data) {\n    return afterTransform(stream, er, data);\n  };\n\n  this.needTransform = false;\n  this.transforming = false;\n  this.writecb = null;\n  this.writechunk = null;\n}\n\nfunction afterTransform(stream, er, data) {\n  var ts = stream._transformState;\n  ts.transforming = false;\n\n  var cb = ts.writecb;\n\n  if (!cb)\n    return stream.emit('error', new Error('no writecb in Transform class'));\n\n  ts.writechunk = null;\n  ts.writecb = null;\n\n  if (data !== null && data !== undefined)\n    stream.push(data);\n\n  if (cb)\n    cb(er);\n\n  var rs = stream._readableState;\n  rs.reading = false;\n  if (rs.needReadable || rs.length < rs.highWaterMark) {\n    stream._read(rs.highWaterMark);\n  }\n}\n\n\nfunction Transform(options) {\n  if (!(this instanceof Transform))\n    return new Transform(options);\n\n  Duplex.call(this, options);\n\n  var ts = this._transformState = new TransformState(options, this);\n\n  // when the writable side finishes, then flush out anything remaining.\n  var stream = this;\n\n  // start out asking for a readable event once data is transformed.\n  this._readableState.needReadable = true;\n\n  // we have implemented the _read method, and done the other things\n  // that Readable wants before the first _read call, so unset the\n  // sync guard flag.\n  this._readableState.sync = false;\n\n  this.once('finish', function() {\n    if ('function' === typeof this._flush)\n      this._flush(function(er) {\n        done(stream, er);\n      });\n    else\n      done(stream);\n  });\n}\n\nTransform.prototype.push = function(chunk, encoding) {\n  this._transformState.needTransform = false;\n  return Duplex.prototype.push.call(this, chunk, encoding);\n};\n\n// This is the part where you do stuff!\n// override this function in implementation classes.\n// 'chunk' is an input chunk.\n//\n// Call `push(newChunk)` to pass along transformed output\n// to the readable side.  You may call 'push' zero or more times.\n//\n// Call `cb(err)` when you are done with this chunk.  If you pass\n// an error, then that'll put the hurt on the whole operation.  If you\n// never call cb(), then you'll never get another chunk.\nTransform.prototype._transform = function(chunk, encoding, cb) {\n  throw new Error('not implemented');\n};\n\nTransform.prototype._write = function(chunk, encoding, cb) {\n  var ts = this._transformState;\n  ts.writecb = cb;\n  ts.writechunk = chunk;\n  ts.writeencoding = encoding;\n  if (!ts.transforming) {\n    var rs = this._readableState;\n    if (ts.needTransform ||\n        rs.needReadable ||\n        rs.length < rs.highWaterMark)\n      this._read(rs.highWaterMark);\n  }\n};\n\n// Doesn't matter what the args are here.\n// _transform does all the work.\n// That we got here means that the readable side wants more data.\nTransform.prototype._read = function(n) {\n  var ts = this._transformState;\n\n  if (ts.writechunk !== null && ts.writecb && !ts.transforming) {\n    ts.transforming = true;\n    this._transform(ts.writechunk, ts.writeencoding, ts.afterTransform);\n  } else {\n    // mark that we need a transform, so that any data that comes in\n    // will get processed, now that we've asked for it.\n    ts.needTransform = true;\n  }\n};\n\n\nfunction done(stream, er) {\n  if (er)\n    return stream.emit('error', er);\n\n  // if there's nothing in the write buffer, then that means\n  // that nothing more will ever be provided\n  var ws = stream._writableState;\n  var rs = stream._readableState;\n  var ts = stream._transformState;\n\n  if (ws.length)\n    throw new Error('calling transform done when ws.length != 0');\n\n  if (ts.transforming)\n    throw new Error('calling transform done when still transforming');\n\n  return stream.push(null);\n}\n","// Copyright Joyent, Inc. and other Node contributors.\n//\n// Permission is hereby granted, free of charge, to any person obtaining a\n// copy of this software and associated documentation files (the\n// \"Software\"), to deal in the Software without restriction, including\n// without limitation the rights to use, copy, modify, merge, publish,\n// distribute, sublicense, and/or sell copies of the Software, and to permit\n// persons to whom the Software is furnished to do so, subject to the\n// following conditions:\n//\n// The above copyright notice and this permission notice shall be included\n// in all copies or substantial portions of the Software.\n//\n// THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS\n// OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF\n// MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN\n// NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM,\n// DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR\n// OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE\n// USE OR OTHER DEALINGS IN THE SOFTWARE.\n\n// a passthrough stream.\n// basically just the most minimal sort of Transform stream.\n// Every written chunk gets output as-is.\n\nmodule.exports = PassThrough;\n\nvar Transform = require('./_stream_transform');\n\n/*<replacement>*/\nvar util = require('core-util-is');\nutil.inherits = require('inherits');\n/*</replacement>*/\n\nutil.inherits(PassThrough, Transform);\n\nfunction PassThrough(options) {\n  if (!(this instanceof PassThrough))\n    return new PassThrough(options);\n\n  Transform.call(this, options);\n}\n\nPassThrough.prototype._transform = function(chunk, encoding, cb) {\n  cb(null, chunk);\n};\n","/**\n * The MIT License (MIT)\n * \n * Copyright (c) 2014 Petka Antonov\n * \n * Permission is hereby granted, free of charge, to any person obtaining a copy\n * of this software and associated documentation files (the \"Software\"), to deal\n * in the Software without restriction, including without limitation the rights\n * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell\n * copies of the Software, and to permit persons to whom the Software is\n * furnished to do so, subject to the following conditions:</p>\n * \n * The above copyright notice and this permission notice shall be included in\n * all copies or substantial portions of the Software.\n * \n * THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT.  IN NO EVENT SHALL THE\n * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\n * THE SOFTWARE.\n * \n */\n\"use strict\";\nvar schedule;\nvar _MutationObserver;\nif (typeof process === \"object\" && typeof process.version === \"string\") {\n    schedule = function Promise$_Scheduler(fn) {\n        process.nextTick(fn);\n    };\n}\nelse if ((typeof MutationObserver !== \"undefined\" &&\n         (_MutationObserver = MutationObserver)) ||\n         (typeof WebKitMutationObserver !== \"undefined\" &&\n         (_MutationObserver = WebKitMutationObserver))) {\n    schedule = (function() {\n        var div = document.createElement(\"div\");\n        var queuedFn = void 0;\n        var observer = new _MutationObserver(\n            function Promise$_Scheduler() {\n                var fn = queuedFn;\n                queuedFn = void 0;\n                fn();\n            }\n       );\n        observer.observe(div, {\n            attributes: true\n        });\n        return function Promise$_Scheduler(fn) {\n            queuedFn = fn;\n            div.classList.toggle(\"foo\");\n        };\n\n    })();\n}\nelse if (typeof setTimeout !== \"undefined\") {\n    schedule = function Promise$_Scheduler(fn) {\n        setTimeout(fn, 0);\n    };\n}\nelse throw new Error(\"no async scheduler available\");\nmodule.exports = schedule;\n","/**\n * The MIT License (MIT)\n * \n * Copyright (c) 2014 Petka Antonov\n * \n * Permission is hereby granted, free of charge, to any person obtaining a copy\n * of this software and associated documentation files (the \"Software\"), to deal\n * in the Software without restriction, including without limitation the rights\n * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell\n * copies of the Software, and to permit persons to whom the Software is\n * furnished to do so, subject to the following conditions:</p>\n * \n * The above copyright notice and this permission notice shall be included in\n * all copies or substantial portions of the Software.\n * \n * THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT.  IN NO EVENT SHALL THE\n * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\n * THE SOFTWARE.\n * \n */\nvar isES5 = (function(){\n    \"use strict\";\n    return this === void 0;\n})();\n\nif (isES5) {\n    module.exports = {\n        freeze: Object.freeze,\n        defineProperty: Object.defineProperty,\n        keys: Object.keys,\n        getPrototypeOf: Object.getPrototypeOf,\n        isArray: Array.isArray,\n        isES5: isES5\n    };\n} else {\n    var has = {}.hasOwnProperty;\n    var str = {}.toString;\n    var proto = {}.constructor.prototype;\n\n    var ObjectKeys = function ObjectKeys(o) {\n        var ret = [];\n        for (var key in o) {\n            if (has.call(o, key)) {\n                ret.push(key);\n            }\n        }\n        return ret;\n    }\n\n    var ObjectDefineProperty = function ObjectDefineProperty(o, key, desc) {\n        o[key] = desc.value;\n        return o;\n    }\n\n    var ObjectFreeze = function ObjectFreeze(obj) {\n        return obj;\n    }\n\n    var ObjectGetPrototypeOf = function ObjectGetPrototypeOf(obj) {\n        try {\n            return Object(obj).constructor.prototype;\n        }\n        catch (e) {\n            return proto;\n        }\n    }\n\n    var ArrayIsArray = function ArrayIsArray(obj) {\n        try {\n            return str.call(obj) === \"[object Array]\";\n        }\n        catch(e) {\n            return false;\n        }\n    }\n\n    module.exports = {\n        isArray: ArrayIsArray,\n        keys: ObjectKeys,\n        defineProperty: ObjectDefineProperty,\n        freeze: ObjectFreeze,\n        getPrototypeOf: ObjectGetPrototypeOf,\n        isES5: isES5\n    };\n}\n","/**\n * The MIT License (MIT)\n * \n * Copyright (c) 2014 Petka Antonov\n * \n * Permission is hereby granted, free of charge, to any person obtaining a copy\n * of this software and associated documentation files (the \"Software\"), to deal\n * in the Software without restriction, including without limitation the rights\n * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell\n * copies of the Software, and to permit persons to whom the Software is\n * furnished to do so, subject to the following conditions:</p>\n * \n * The above copyright notice and this permission notice shall be included in\n * all copies or substantial portions of the Software.\n * \n * THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT.  IN NO EVENT SHALL THE\n * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\n * THE SOFTWARE.\n * \n */\n\"use strict\";\nfunction arrayCopy(src, srcIndex, dst, dstIndex, len) {\n    for (var j = 0; j < len; ++j) {\n        dst[j + dstIndex] = src[j + srcIndex];\n    }\n}\n\nfunction Queue(capacity) {\n    this._capacity = capacity;\n    this._length = 0;\n    this._front = 0;\n    this._makeCapacity();\n}\n\nQueue.prototype._willBeOverCapacity =\nfunction Queue$_willBeOverCapacity(size) {\n    return this._capacity < size;\n};\n\nQueue.prototype._pushOne = function Queue$_pushOne(arg) {\n    var length = this.length();\n    this._checkCapacity(length + 1);\n    var i = (this._front + length) & (this._capacity - 1);\n    this[i] = arg;\n    this._length = length + 1;\n};\n\nQueue.prototype.push = function Queue$push(fn, receiver, arg) {\n    var length = this.length() + 3;\n    if (this._willBeOverCapacity(length)) {\n        this._pushOne(fn);\n        this._pushOne(receiver);\n        this._pushOne(arg);\n        return;\n    }\n    var j = this._front + length - 3;\n    this._checkCapacity(length);\n    var wrapMask = this._capacity - 1;\n    this[(j + 0) & wrapMask] = fn;\n    this[(j + 1) & wrapMask] = receiver;\n    this[(j + 2) & wrapMask] = arg;\n    this._length = length;\n};\n\nQueue.prototype.shift = function Queue$shift() {\n    var front = this._front,\n        ret = this[front];\n\n    this[front] = void 0;\n    this._front = (front + 1) & (this._capacity - 1);\n    this._length--;\n    return ret;\n};\n\nQueue.prototype.length = function Queue$length() {\n    return this._length;\n};\n\nQueue.prototype._makeCapacity = function Queue$_makeCapacity() {\n    var len = this._capacity;\n    for (var i = 0; i < len; ++i) {\n        this[i] = void 0;\n    }\n};\n\nQueue.prototype._checkCapacity = function Queue$_checkCapacity(size) {\n    if (this._capacity < size) {\n        this._resizeTo(this._capacity << 3);\n    }\n};\n\nQueue.prototype._resizeTo = function Queue$_resizeTo(capacity) {\n    var oldFront = this._front;\n    var oldCapacity = this._capacity;\n    var oldQueue = new Array(oldCapacity);\n    var length = this.length();\n\n    arrayCopy(this, 0, oldQueue, 0, oldCapacity);\n    this._capacity = capacity;\n    this._makeCapacity();\n    this._front = 0;\n    if (oldFront + length <= oldCapacity) {\n        arrayCopy(oldQueue, oldFront, this, 0, length);\n    } else {        var lengthBeforeWrapping =\n            length - ((oldFront + length) & (oldCapacity - 1));\n\n        arrayCopy(oldQueue, oldFront, this, 0, lengthBeforeWrapping);\n        arrayCopy(oldQueue, 0, this, lengthBeforeWrapping,\n                    length - lengthBeforeWrapping);\n    }\n};\n\nmodule.exports = Queue;\n","/*!\n * The buffer module from node.js, for the browser.\n *\n * @author   Feross Aboukhadijeh <feross@feross.org> <http://feross.org>\n * @license  MIT\n */\n\nvar base64 = require('base64-js')\nvar ieee754 = require('ieee754')\nvar isArray = require('is-array')\n\nexports.Buffer = Buffer\nexports.SlowBuffer = Buffer\nexports.INSPECT_MAX_BYTES = 50\nBuffer.poolSize = 8192 // not used by this implementation\n\nvar kMaxLength = 0x3fffffff\n\n/**\n * If `Buffer.TYPED_ARRAY_SUPPORT`:\n *   === true    Use Uint8Array implementation (fastest)\n *   === false   Use Object implementation (most compatible, even IE6)\n *\n * Browsers that support typed arrays are IE 10+, Firefox 4+, Chrome 7+, Safari 5.1+,\n * Opera 11.6+, iOS 4.2+.\n *\n * Note:\n *\n * - Implementation must support adding new properties to `Uint8Array` instances.\n *   Firefox 4-29 lacked support, fixed in Firefox 30+.\n *   See: https://bugzilla.mozilla.org/show_bug.cgi?id=695438.\n *\n *  - Chrome 9-10 is missing the `TypedArray.prototype.subarray` function.\n *\n *  - IE10 has a broken `TypedArray.prototype.subarray` function which returns arrays of\n *    incorrect length in some situations.\n *\n * We detect these buggy browsers and set `Buffer.TYPED_ARRAY_SUPPORT` to `false` so they will\n * get the Object implementation, which is slower but will work correctly.\n */\nBuffer.TYPED_ARRAY_SUPPORT = (function () {\n  try {\n    var buf = new ArrayBuffer(0)\n    var arr = new Uint8Array(buf)\n    arr.foo = function () { return 42 }\n    return 42 === arr.foo() && // typed array instances can be augmented\n        typeof arr.subarray === 'function' && // chrome 9-10 lack `subarray`\n        new Uint8Array(1).subarray(1, 1).byteLength === 0 // ie10 has broken `subarray`\n  } catch (e) {\n    return false\n  }\n})()\n\n/**\n * Class: Buffer\n * =============\n *\n * The Buffer constructor returns instances of `Uint8Array` that are augmented\n * with function properties for all the node `Buffer` API functions. We use\n * `Uint8Array` so that square bracket notation works as expected -- it returns\n * a single octet.\n *\n * By augmenting the instances, we can avoid modifying the `Uint8Array`\n * prototype.\n */\nfunction Buffer (subject, encoding, noZero) {\n  if (!(this instanceof Buffer))\n    return new Buffer(subject, encoding, noZero)\n\n  var type = typeof subject\n\n  // Find the length\n  var length\n  if (type === 'number')\n    length = subject > 0 ? subject >>> 0 : 0\n  else if (type === 'string') {\n    if (encoding === 'base64')\n      subject = base64clean(subject)\n    length = Buffer.byteLength(subject, encoding)\n  } else if (type === 'object' && subject !== null) { // assume object is array-like\n    if (subject.type === 'Buffer' && isArray(subject.data))\n      subject = subject.data\n    length = +subject.length > 0 ? Math.floor(+subject.length) : 0\n  } else\n    throw new TypeError('must start with number, buffer, array or string')\n\n  if (this.length > kMaxLength)\n    throw new RangeError('Attempt to allocate Buffer larger than maximum ' +\n      'size: 0x' + kMaxLength.toString(16) + ' bytes')\n\n  var buf\n  if (Buffer.TYPED_ARRAY_SUPPORT) {\n    // Preferred: Return an augmented `Uint8Array` instance for best performance\n    buf = Buffer._augment(new Uint8Array(length))\n  } else {\n    // Fallback: Return THIS instance of Buffer (created by `new`)\n    buf = this\n    buf.length = length\n    buf._isBuffer = true\n  }\n\n  var i\n  if (Buffer.TYPED_ARRAY_SUPPORT && typeof subject.byteLength === 'number') {\n    // Speed optimization -- use set if we're copying from a typed array\n    buf._set(subject)\n  } else if (isArrayish(subject)) {\n    // Treat array-ish objects as a byte array\n    if (Buffer.isBuffer(subject)) {\n      for (i = 0; i < length; i++)\n        buf[i] = subject.readUInt8(i)\n    } else {\n      for (i = 0; i < length; i++)\n        buf[i] = ((subject[i] % 256) + 256) % 256\n    }\n  } else if (type === 'string') {\n    buf.write(subject, 0, encoding)\n  } else if (type === 'number' && !Buffer.TYPED_ARRAY_SUPPORT && !noZero) {\n    for (i = 0; i < length; i++) {\n      buf[i] = 0\n    }\n  }\n\n  return buf\n}\n\nBuffer.isBuffer = function (b) {\n  return !!(b != null && b._isBuffer)\n}\n\nBuffer.compare = function (a, b) {\n  if (!Buffer.isBuffer(a) || !Buffer.isBuffer(b))\n    throw new TypeError('Arguments must be Buffers')\n\n  var x = a.length\n  var y = b.length\n  for (var i = 0, len = Math.min(x, y); i < len && a[i] === b[i]; i++) {}\n  if (i !== len) {\n    x = a[i]\n    y = b[i]\n  }\n  if (x < y) return -1\n  if (y < x) return 1\n  return 0\n}\n\nBuffer.isEncoding = function (encoding) {\n  switch (String(encoding).toLowerCase()) {\n    case 'hex':\n    case 'utf8':\n    case 'utf-8':\n    case 'ascii':\n    case 'binary':\n    case 'base64':\n    case 'raw':\n    case 'ucs2':\n    case 'ucs-2':\n    case 'utf16le':\n    case 'utf-16le':\n      return true\n    default:\n      return false\n  }\n}\n\nBuffer.concat = function (list, totalLength) {\n  if (!isArray(list)) throw new TypeError('Usage: Buffer.concat(list[, length])')\n\n  if (list.length === 0) {\n    return new Buffer(0)\n  } else if (list.length === 1) {\n    return list[0]\n  }\n\n  var i\n  if (totalLength === undefined) {\n    totalLength = 0\n    for (i = 0; i < list.length; i++) {\n      totalLength += list[i].length\n    }\n  }\n\n  var buf = new Buffer(totalLength)\n  var pos = 0\n  for (i = 0; i < list.length; i++) {\n    var item = list[i]\n    item.copy(buf, pos)\n    pos += item.length\n  }\n  return buf\n}\n\nBuffer.byteLength = function (str, encoding) {\n  var ret\n  str = str + ''\n  switch (encoding || 'utf8') {\n    case 'ascii':\n    case 'binary':\n    case 'raw':\n      ret = str.length\n      break\n    case 'ucs2':\n    case 'ucs-2':\n    case 'utf16le':\n    case 'utf-16le':\n      ret = str.length * 2\n      break\n    case 'hex':\n      ret = str.length >>> 1\n      break\n    case 'utf8':\n    case 'utf-8':\n      ret = utf8ToBytes(str).length\n      break\n    case 'base64':\n      ret = base64ToBytes(str).length\n      break\n    default:\n      ret = str.length\n  }\n  return ret\n}\n\n// pre-set for values that may exist in the future\nBuffer.prototype.length = undefined\nBuffer.prototype.parent = undefined\n\n// toString(encoding, start=0, end=buffer.length)\nBuffer.prototype.toString = function (encoding, start, end) {\n  var loweredCase = false\n\n  start = start >>> 0\n  end = end === undefined || end === Infinity ? this.length : end >>> 0\n\n  if (!encoding) encoding = 'utf8'\n  if (start < 0) start = 0\n  if (end > this.length) end = this.length\n  if (end <= start) return ''\n\n  while (true) {\n    switch (encoding) {\n      case 'hex':\n        return hexSlice(this, start, end)\n\n      case 'utf8':\n      case 'utf-8':\n        return utf8Slice(this, start, end)\n\n      case 'ascii':\n        return asciiSlice(this, start, end)\n\n      case 'binary':\n        return binarySlice(this, start, end)\n\n      case 'base64':\n        return base64Slice(this, start, end)\n\n      case 'ucs2':\n      case 'ucs-2':\n      case 'utf16le':\n      case 'utf-16le':\n        return utf16leSlice(this, start, end)\n\n      default:\n        if (loweredCase)\n          throw new TypeError('Unknown encoding: ' + encoding)\n        encoding = (encoding + '').toLowerCase()\n        loweredCase = true\n    }\n  }\n}\n\nBuffer.prototype.equals = function (b) {\n  if(!Buffer.isBuffer(b)) throw new TypeError('Argument must be a Buffer')\n  return Buffer.compare(this, b) === 0\n}\n\nBuffer.prototype.inspect = function () {\n  var str = ''\n  var max = exports.INSPECT_MAX_BYTES\n  if (this.length > 0) {\n    str = this.toString('hex', 0, max).match(/.{2}/g).join(' ')\n    if (this.length > max)\n      str += ' ... '\n  }\n  return '<Buffer ' + str + '>'\n}\n\nBuffer.prototype.compare = function (b) {\n  if (!Buffer.isBuffer(b)) throw new TypeError('Argument must be a Buffer')\n  return Buffer.compare(this, b)\n}\n\n// `get` will be removed in Node 0.13+\nBuffer.prototype.get = function (offset) {\n  console.log('.get() is deprecated. Access using array indexes instead.')\n  return this.readUInt8(offset)\n}\n\n// `set` will be removed in Node 0.13+\nBuffer.prototype.set = function (v, offset) {\n  console.log('.set() is deprecated. Access using array indexes instead.')\n  return this.writeUInt8(v, offset)\n}\n\nfunction hexWrite (buf, string, offset, length) {\n  offset = Number(offset) || 0\n  var remaining = buf.length - offset\n  if (!length) {\n    length = remaining\n  } else {\n    length = Number(length)\n    if (length > remaining) {\n      length = remaining\n    }\n  }\n\n  // must be an even number of digits\n  var strLen = string.length\n  if (strLen % 2 !== 0) throw new Error('Invalid hex string')\n\n  if (length > strLen / 2) {\n    length = strLen / 2\n  }\n  for (var i = 0; i < length; i++) {\n    var byte = parseInt(string.substr(i * 2, 2), 16)\n    if (isNaN(byte)) throw new Error('Invalid hex string')\n    buf[offset + i] = byte\n  }\n  return i\n}\n\nfunction utf8Write (buf, string, offset, length) {\n  var charsWritten = blitBuffer(utf8ToBytes(string), buf, offset, length)\n  return charsWritten\n}\n\nfunction asciiWrite (buf, string, offset, length) {\n  var charsWritten = blitBuffer(asciiToBytes(string), buf, offset, length)\n  return charsWritten\n}\n\nfunction binaryWrite (buf, string, offset, length) {\n  return asciiWrite(buf, string, offset, length)\n}\n\nfunction base64Write (buf, string, offset, length) {\n  var charsWritten = blitBuffer(base64ToBytes(string), buf, offset, length)\n  return charsWritten\n}\n\nfunction utf16leWrite (buf, string, offset, length) {\n  var charsWritten = blitBuffer(utf16leToBytes(string), buf, offset, length)\n  return charsWritten\n}\n\nBuffer.prototype.write = function (string, offset, length, encoding) {\n  // Support both (string, offset, length, encoding)\n  // and the legacy (string, encoding, offset, length)\n  if (isFinite(offset)) {\n    if (!isFinite(length)) {\n      encoding = length\n      length = undefined\n    }\n  } else {  // legacy\n    var swap = encoding\n    encoding = offset\n    offset = length\n    length = swap\n  }\n\n  offset = Number(offset) || 0\n  var remaining = this.length - offset\n  if (!length) {\n    length = remaining\n  } else {\n    length = Number(length)\n    if (length > remaining) {\n      length = remaining\n    }\n  }\n  encoding = String(encoding || 'utf8').toLowerCase()\n\n  var ret\n  switch (encoding) {\n    case 'hex':\n      ret = hexWrite(this, string, offset, length)\n      break\n    case 'utf8':\n    case 'utf-8':\n      ret = utf8Write(this, string, offset, length)\n      break\n    case 'ascii':\n      ret = asciiWrite(this, string, offset, length)\n      break\n    case 'binary':\n      ret = binaryWrite(this, string, offset, length)\n      break\n    case 'base64':\n      ret = base64Write(this, string, offset, length)\n      break\n    case 'ucs2':\n    case 'ucs-2':\n    case 'utf16le':\n    case 'utf-16le':\n      ret = utf16leWrite(this, string, offset, length)\n      break\n    default:\n      throw new TypeError('Unknown encoding: ' + encoding)\n  }\n  return ret\n}\n\nBuffer.prototype.toJSON = function () {\n  return {\n    type: 'Buffer',\n    data: Array.prototype.slice.call(this._arr || this, 0)\n  }\n}\n\nfunction base64Slice (buf, start, end) {\n  if (start === 0 && end === buf.length) {\n    return base64.fromByteArray(buf)\n  } else {\n    return base64.fromByteArray(buf.slice(start, end))\n  }\n}\n\nfunction utf8Slice (buf, start, end) {\n  var res = ''\n  var tmp = ''\n  end = Math.min(buf.length, end)\n\n  for (var i = start; i < end; i++) {\n    if (buf[i] <= 0x7F) {\n      res += decodeUtf8Char(tmp) + String.fromCharCode(buf[i])\n      tmp = ''\n    } else {\n      tmp += '%' + buf[i].toString(16)\n    }\n  }\n\n  return res + decodeUtf8Char(tmp)\n}\n\nfunction asciiSlice (buf, start, end) {\n  var ret = ''\n  end = Math.min(buf.length, end)\n\n  for (var i = start; i < end; i++) {\n    ret += String.fromCharCode(buf[i])\n  }\n  return ret\n}\n\nfunction binarySlice (buf, start, end) {\n  return asciiSlice(buf, start, end)\n}\n\nfunction hexSlice (buf, start, end) {\n  var len = buf.length\n\n  if (!start || start < 0) start = 0\n  if (!end || end < 0 || end > len) end = len\n\n  var out = ''\n  for (var i = start; i < end; i++) {\n    out += toHex(buf[i])\n  }\n  return out\n}\n\nfunction utf16leSlice (buf, start, end) {\n  var bytes = buf.slice(start, end)\n  var res = ''\n  for (var i = 0; i < bytes.length; i += 2) {\n    res += String.fromCharCode(bytes[i] + bytes[i + 1] * 256)\n  }\n  return res\n}\n\nBuffer.prototype.slice = function (start, end) {\n  var len = this.length\n  start = ~~start\n  end = end === undefined ? len : ~~end\n\n  if (start < 0) {\n    start += len;\n    if (start < 0)\n      start = 0\n  } else if (start > len) {\n    start = len\n  }\n\n  if (end < 0) {\n    end += len\n    if (end < 0)\n      end = 0\n  } else if (end > len) {\n    end = len\n  }\n\n  if (end < start)\n    end = start\n\n  if (Buffer.TYPED_ARRAY_SUPPORT) {\n    return Buffer._augment(this.subarray(start, end))\n  } else {\n    var sliceLen = end - start\n    var newBuf = new Buffer(sliceLen, undefined, true)\n    for (var i = 0; i < sliceLen; i++) {\n      newBuf[i] = this[i + start]\n    }\n    return newBuf\n  }\n}\n\n/*\n * Need to make sure that buffer isn't trying to write out of bounds.\n */\nfunction checkOffset (offset, ext, length) {\n  if ((offset % 1) !== 0 || offset < 0)\n    throw new RangeError('offset is not uint')\n  if (offset + ext > length)\n    throw new RangeError('Trying to access beyond buffer length')\n}\n\nBuffer.prototype.readUInt8 = function (offset, noAssert) {\n  if (!noAssert)\n    checkOffset(offset, 1, this.length)\n  return this[offset]\n}\n\nBuffer.prototype.readUInt16LE = function (offset, noAssert) {\n  if (!noAssert)\n    checkOffset(offset, 2, this.length)\n  return this[offset] | (this[offset + 1] << 8)\n}\n\nBuffer.prototype.readUInt16BE = function (offset, noAssert) {\n  if (!noAssert)\n    checkOffset(offset, 2, this.length)\n  return (this[offset] << 8) | this[offset + 1]\n}\n\nBuffer.prototype.readUInt32LE = function (offset, noAssert) {\n  if (!noAssert)\n    checkOffset(offset, 4, this.length)\n\n  return ((this[offset]) |\n      (this[offset + 1] << 8) |\n      (this[offset + 2] << 16)) +\n      (this[offset + 3] * 0x1000000)\n}\n\nBuffer.prototype.readUInt32BE = function (offset, noAssert) {\n  if (!noAssert)\n    checkOffset(offset, 4, this.length)\n\n  return (this[offset] * 0x1000000) +\n      ((this[offset + 1] << 16) |\n      (this[offset + 2] << 8) |\n      this[offset + 3])\n}\n\nBuffer.prototype.readInt8 = function (offset, noAssert) {\n  if (!noAssert)\n    checkOffset(offset, 1, this.length)\n  if (!(this[offset] & 0x80))\n    return (this[offset])\n  return ((0xff - this[offset] + 1) * -1)\n}\n\nBuffer.prototype.readInt16LE = function (offset, noAssert) {\n  if (!noAssert)\n    checkOffset(offset, 2, this.length)\n  var val = this[offset] | (this[offset + 1] << 8)\n  return (val & 0x8000) ? val | 0xFFFF0000 : val\n}\n\nBuffer.prototype.readInt16BE = function (offset, noAssert) {\n  if (!noAssert)\n    checkOffset(offset, 2, this.length)\n  var val = this[offset + 1] | (this[offset] << 8)\n  return (val & 0x8000) ? val | 0xFFFF0000 : val\n}\n\nBuffer.prototype.readInt32LE = function (offset, noAssert) {\n  if (!noAssert)\n    checkOffset(offset, 4, this.length)\n\n  return (this[offset]) |\n      (this[offset + 1] << 8) |\n      (this[offset + 2] << 16) |\n      (this[offset + 3] << 24)\n}\n\nBuffer.prototype.readInt32BE = function (offset, noAssert) {\n  if (!noAssert)\n    checkOffset(offset, 4, this.length)\n\n  return (this[offset] << 24) |\n      (this[offset + 1] << 16) |\n      (this[offset + 2] << 8) |\n      (this[offset + 3])\n}\n\nBuffer.prototype.readFloatLE = function (offset, noAssert) {\n  if (!noAssert)\n    checkOffset(offset, 4, this.length)\n  return ieee754.read(this, offset, true, 23, 4)\n}\n\nBuffer.prototype.readFloatBE = function (offset, noAssert) {\n  if (!noAssert)\n    checkOffset(offset, 4, this.length)\n  return ieee754.read(this, offset, false, 23, 4)\n}\n\nBuffer.prototype.readDoubleLE = function (offset, noAssert) {\n  if (!noAssert)\n    checkOffset(offset, 8, this.length)\n  return ieee754.read(this, offset, true, 52, 8)\n}\n\nBuffer.prototype.readDoubleBE = function (offset, noAssert) {\n  if (!noAssert)\n    checkOffset(offset, 8, this.length)\n  return ieee754.read(this, offset, false, 52, 8)\n}\n\nfunction checkInt (buf, value, offset, ext, max, min) {\n  if (!Buffer.isBuffer(buf)) throw new TypeError('buffer must be a Buffer instance')\n  if (value > max || value < min) throw new TypeError('value is out of bounds')\n  if (offset + ext > buf.length) throw new TypeError('index out of range')\n}\n\nBuffer.prototype.writeUInt8 = function (value, offset, noAssert) {\n  value = +value\n  offset = offset >>> 0\n  if (!noAssert)\n    checkInt(this, value, offset, 1, 0xff, 0)\n  if (!Buffer.TYPED_ARRAY_SUPPORT) value = Math.floor(value)\n  this[offset] = value\n  return offset + 1\n}\n\nfunction objectWriteUInt16 (buf, value, offset, littleEndian) {\n  if (value < 0) value = 0xffff + value + 1\n  for (var i = 0, j = Math.min(buf.length - offset, 2); i < j; i++) {\n    buf[offset + i] = (value & (0xff << (8 * (littleEndian ? i : 1 - i)))) >>>\n      (littleEndian ? i : 1 - i) * 8\n  }\n}\n\nBuffer.prototype.writeUInt16LE = function (value, offset, noAssert) {\n  value = +value\n  offset = offset >>> 0\n  if (!noAssert)\n    checkInt(this, value, offset, 2, 0xffff, 0)\n  if (Buffer.TYPED_ARRAY_SUPPORT) {\n    this[offset] = value\n    this[offset + 1] = (value >>> 8)\n  } else objectWriteUInt16(this, value, offset, true)\n  return offset + 2\n}\n\nBuffer.prototype.writeUInt16BE = function (value, offset, noAssert) {\n  value = +value\n  offset = offset >>> 0\n  if (!noAssert)\n    checkInt(this, value, offset, 2, 0xffff, 0)\n  if (Buffer.TYPED_ARRAY_SUPPORT) {\n    this[offset] = (value >>> 8)\n    this[offset + 1] = value\n  } else objectWriteUInt16(this, value, offset, false)\n  return offset + 2\n}\n\nfunction objectWriteUInt32 (buf, value, offset, littleEndian) {\n  if (value < 0) value = 0xffffffff + value + 1\n  for (var i = 0, j = Math.min(buf.length - offset, 4); i < j; i++) {\n    buf[offset + i] = (value >>> (littleEndian ? i : 3 - i) * 8) & 0xff\n  }\n}\n\nBuffer.prototype.writeUInt32LE = function (value, offset, noAssert) {\n  value = +value\n  offset = offset >>> 0\n  if (!noAssert)\n    checkInt(this, value, offset, 4, 0xffffffff, 0)\n  if (Buffer.TYPED_ARRAY_SUPPORT) {\n    this[offset + 3] = (value >>> 24)\n    this[offset + 2] = (value >>> 16)\n    this[offset + 1] = (value >>> 8)\n    this[offset] = value\n  } else objectWriteUInt32(this, value, offset, true)\n  return offset + 4\n}\n\nBuffer.prototype.writeUInt32BE = function (value, offset, noAssert) {\n  value = +value\n  offset = offset >>> 0\n  if (!noAssert)\n    checkInt(this, value, offset, 4, 0xffffffff, 0)\n  if (Buffer.TYPED_ARRAY_SUPPORT) {\n    this[offset] = (value >>> 24)\n    this[offset + 1] = (value >>> 16)\n    this[offset + 2] = (value >>> 8)\n    this[offset + 3] = value\n  } else objectWriteUInt32(this, value, offset, false)\n  return offset + 4\n}\n\nBuffer.prototype.writeInt8 = function (value, offset, noAssert) {\n  value = +value\n  offset = offset >>> 0\n  if (!noAssert)\n    checkInt(this, value, offset, 1, 0x7f, -0x80)\n  if (!Buffer.TYPED_ARRAY_SUPPORT) value = Math.floor(value)\n  if (value < 0) value = 0xff + value + 1\n  this[offset] = value\n  return offset + 1\n}\n\nBuffer.prototype.writeInt16LE = function (value, offset, noAssert) {\n  value = +value\n  offset = offset >>> 0\n  if (!noAssert)\n    checkInt(this, value, offset, 2, 0x7fff, -0x8000)\n  if (Buffer.TYPED_ARRAY_SUPPORT) {\n    this[offset] = value\n    this[offset + 1] = (value >>> 8)\n  } else objectWriteUInt16(this, value, offset, true)\n  return offset + 2\n}\n\nBuffer.prototype.writeInt16BE = function (value, offset, noAssert) {\n  value = +value\n  offset = offset >>> 0\n  if (!noAssert)\n    checkInt(this, value, offset, 2, 0x7fff, -0x8000)\n  if (Buffer.TYPED_ARRAY_SUPPORT) {\n    this[offset] = (value >>> 8)\n    this[offset + 1] = value\n  } else objectWriteUInt16(this, value, offset, false)\n  return offset + 2\n}\n\nBuffer.prototype.writeInt32LE = function (value, offset, noAssert) {\n  value = +value\n  offset = offset >>> 0\n  if (!noAssert)\n    checkInt(this, value, offset, 4, 0x7fffffff, -0x80000000)\n  if (Buffer.TYPED_ARRAY_SUPPORT) {\n    this[offset] = value\n    this[offset + 1] = (value >>> 8)\n    this[offset + 2] = (value >>> 16)\n    this[offset + 3] = (value >>> 24)\n  } else objectWriteUInt32(this, value, offset, true)\n  return offset + 4\n}\n\nBuffer.prototype.writeInt32BE = function (value, offset, noAssert) {\n  value = +value\n  offset = offset >>> 0\n  if (!noAssert)\n    checkInt(this, value, offset, 4, 0x7fffffff, -0x80000000)\n  if (value < 0) value = 0xffffffff + value + 1\n  if (Buffer.TYPED_ARRAY_SUPPORT) {\n    this[offset] = (value >>> 24)\n    this[offset + 1] = (value >>> 16)\n    this[offset + 2] = (value >>> 8)\n    this[offset + 3] = value\n  } else objectWriteUInt32(this, value, offset, false)\n  return offset + 4\n}\n\nfunction checkIEEE754 (buf, value, offset, ext, max, min) {\n  if (value > max || value < min) throw new TypeError('value is out of bounds')\n  if (offset + ext > buf.length) throw new TypeError('index out of range')\n}\n\nfunction writeFloat (buf, value, offset, littleEndian, noAssert) {\n  if (!noAssert)\n    checkIEEE754(buf, value, offset, 4, 3.4028234663852886e+38, -3.4028234663852886e+38)\n  ieee754.write(buf, value, offset, littleEndian, 23, 4)\n  return offset + 4\n}\n\nBuffer.prototype.writeFloatLE = function (value, offset, noAssert) {\n  return writeFloat(this, value, offset, true, noAssert)\n}\n\nBuffer.prototype.writeFloatBE = function (value, offset, noAssert) {\n  return writeFloat(this, value, offset, false, noAssert)\n}\n\nfunction writeDouble (buf, value, offset, littleEndian, noAssert) {\n  if (!noAssert)\n    checkIEEE754(buf, value, offset, 8, 1.7976931348623157E+308, -1.7976931348623157E+308)\n  ieee754.write(buf, value, offset, littleEndian, 52, 8)\n  return offset + 8\n}\n\nBuffer.prototype.writeDoubleLE = function (value, offset, noAssert) {\n  return writeDouble(this, value, offset, true, noAssert)\n}\n\nBuffer.prototype.writeDoubleBE = function (value, offset, noAssert) {\n  return writeDouble(this, value, offset, false, noAssert)\n}\n\n// copy(targetBuffer, targetStart=0, sourceStart=0, sourceEnd=buffer.length)\nBuffer.prototype.copy = function (target, target_start, start, end) {\n  var source = this\n\n  if (!start) start = 0\n  if (!end && end !== 0) end = this.length\n  if (!target_start) target_start = 0\n\n  // Copy 0 bytes; we're done\n  if (end === start) return\n  if (target.length === 0 || source.length === 0) return\n\n  // Fatal error conditions\n  if (end < start) throw new TypeError('sourceEnd < sourceStart')\n  if (target_start < 0 || target_start >= target.length)\n    throw new TypeError('targetStart out of bounds')\n  if (start < 0 || start >= source.length) throw new TypeError('sourceStart out of bounds')\n  if (end < 0 || end > source.length) throw new TypeError('sourceEnd out of bounds')\n\n  // Are we oob?\n  if (end > this.length)\n    end = this.length\n  if (target.length - target_start < end - start)\n    end = target.length - target_start + start\n\n  var len = end - start\n\n  if (len < 100 || !Buffer.TYPED_ARRAY_SUPPORT) {\n    for (var i = 0; i < len; i++) {\n      target[i + target_start] = this[i + start]\n    }\n  } else {\n    target._set(this.subarray(start, start + len), target_start)\n  }\n}\n\n// fill(value, start=0, end=buffer.length)\nBuffer.prototype.fill = function (value, start, end) {\n  if (!value) value = 0\n  if (!start) start = 0\n  if (!end) end = this.length\n\n  if (end < start) throw new TypeError('end < start')\n\n  // Fill 0 bytes; we're done\n  if (end === start) return\n  if (this.length === 0) return\n\n  if (start < 0 || start >= this.length) throw new TypeError('start out of bounds')\n  if (end < 0 || end > this.length) throw new TypeError('end out of bounds')\n\n  var i\n  if (typeof value === 'number') {\n    for (i = start; i < end; i++) {\n      this[i] = value\n    }\n  } else {\n    var bytes = utf8ToBytes(value.toString())\n    var len = bytes.length\n    for (i = start; i < end; i++) {\n      this[i] = bytes[i % len]\n    }\n  }\n\n  return this\n}\n\n/**\n * Creates a new `ArrayBuffer` with the *copied* memory of the buffer instance.\n * Added in Node 0.12. Only available in browsers that support ArrayBuffer.\n */\nBuffer.prototype.toArrayBuffer = function () {\n  if (typeof Uint8Array !== 'undefined') {\n    if (Buffer.TYPED_ARRAY_SUPPORT) {\n      return (new Buffer(this)).buffer\n    } else {\n      var buf = new Uint8Array(this.length)\n      for (var i = 0, len = buf.length; i < len; i += 1) {\n        buf[i] = this[i]\n      }\n      return buf.buffer\n    }\n  } else {\n    throw new TypeError('Buffer.toArrayBuffer not supported in this browser')\n  }\n}\n\n// HELPER FUNCTIONS\n// ================\n\nvar BP = Buffer.prototype\n\n/**\n * Augment a Uint8Array *instance* (not the Uint8Array class!) with Buffer methods\n */\nBuffer._augment = function (arr) {\n  arr._isBuffer = true\n\n  // save reference to original Uint8Array get/set methods before overwriting\n  arr._get = arr.get\n  arr._set = arr.set\n\n  // deprecated, will be removed in node 0.13+\n  arr.get = BP.get\n  arr.set = BP.set\n\n  arr.write = BP.write\n  arr.toString = BP.toString\n  arr.toLocaleString = BP.toString\n  arr.toJSON = BP.toJSON\n  arr.equals = BP.equals\n  arr.compare = BP.compare\n  arr.copy = BP.copy\n  arr.slice = BP.slice\n  arr.readUInt8 = BP.readUInt8\n  arr.readUInt16LE = BP.readUInt16LE\n  arr.readUInt16BE = BP.readUInt16BE\n  arr.readUInt32LE = BP.readUInt32LE\n  arr.readUInt32BE = BP.readUInt32BE\n  arr.readInt8 = BP.readInt8\n  arr.readInt16LE = BP.readInt16LE\n  arr.readInt16BE = BP.readInt16BE\n  arr.readInt32LE = BP.readInt32LE\n  arr.readInt32BE = BP.readInt32BE\n  arr.readFloatLE = BP.readFloatLE\n  arr.readFloatBE = BP.readFloatBE\n  arr.readDoubleLE = BP.readDoubleLE\n  arr.readDoubleBE = BP.readDoubleBE\n  arr.writeUInt8 = BP.writeUInt8\n  arr.writeUInt16LE = BP.writeUInt16LE\n  arr.writeUInt16BE = BP.writeUInt16BE\n  arr.writeUInt32LE = BP.writeUInt32LE\n  arr.writeUInt32BE = BP.writeUInt32BE\n  arr.writeInt8 = BP.writeInt8\n  arr.writeInt16LE = BP.writeInt16LE\n  arr.writeInt16BE = BP.writeInt16BE\n  arr.writeInt32LE = BP.writeInt32LE\n  arr.writeInt32BE = BP.writeInt32BE\n  arr.writeFloatLE = BP.writeFloatLE\n  arr.writeFloatBE = BP.writeFloatBE\n  arr.writeDoubleLE = BP.writeDoubleLE\n  arr.writeDoubleBE = BP.writeDoubleBE\n  arr.fill = BP.fill\n  arr.inspect = BP.inspect\n  arr.toArrayBuffer = BP.toArrayBuffer\n\n  return arr\n}\n\nvar INVALID_BASE64_RE = /[^+\\/0-9A-z]/g\n\nfunction base64clean (str) {\n  // Node strips out invalid characters like \\n and \\t from the string, base64-js does not\n  str = stringtrim(str).replace(INVALID_BASE64_RE, '')\n  // Node allows for non-padded base64 strings (missing trailing ===), base64-js does not\n  while (str.length % 4 !== 0) {\n    str = str + '='\n  }\n  return str\n}\n\nfunction stringtrim (str) {\n  if (str.trim) return str.trim()\n  return str.replace(/^\\s+|\\s+$/g, '')\n}\n\nfunction isArrayish (subject) {\n  return isArray(subject) || Buffer.isBuffer(subject) ||\n      subject && typeof subject === 'object' &&\n      typeof subject.length === 'number'\n}\n\nfunction toHex (n) {\n  if (n < 16) return '0' + n.toString(16)\n  return n.toString(16)\n}\n\nfunction utf8ToBytes (str) {\n  var byteArray = []\n  for (var i = 0; i < str.length; i++) {\n    var b = str.charCodeAt(i)\n    if (b <= 0x7F) {\n      byteArray.push(b)\n    } else {\n      var start = i\n      if (b >= 0xD800 && b <= 0xDFFF) i++\n      var h = encodeURIComponent(str.slice(start, i+1)).substr(1).split('%')\n      for (var j = 0; j < h.length; j++) {\n        byteArray.push(parseInt(h[j], 16))\n      }\n    }\n  }\n  return byteArray\n}\n\nfunction asciiToBytes (str) {\n  var byteArray = []\n  for (var i = 0; i < str.length; i++) {\n    // Node's code seems to be doing this and not & 0x7F..\n    byteArray.push(str.charCodeAt(i) & 0xFF)\n  }\n  return byteArray\n}\n\nfunction utf16leToBytes (str) {\n  var c, hi, lo\n  var byteArray = []\n  for (var i = 0; i < str.length; i++) {\n    c = str.charCodeAt(i)\n    hi = c >> 8\n    lo = c % 256\n    byteArray.push(lo)\n    byteArray.push(hi)\n  }\n\n  return byteArray\n}\n\nfunction base64ToBytes (str) {\n  return base64.toByteArray(str)\n}\n\nfunction blitBuffer (src, dst, offset, length) {\n  for (var i = 0; i < length; i++) {\n    if ((i + offset >= dst.length) || (i >= src.length))\n      break\n    dst[i + offset] = src[i]\n  }\n  return i\n}\n\nfunction decodeUtf8Char (str) {\n  try {\n    return decodeURIComponent(str)\n  } catch (err) {\n    return String.fromCharCode(0xFFFD) // UTF 8 invalid char\n  }\n}\n","// Copyright Joyent, Inc. and other Node contributors.\n//\n// Permission is hereby granted, free of charge, to any person obtaining a\n// copy of this software and associated documentation files (the\n// \"Software\"), to deal in the Software without restriction, including\n// without limitation the rights to use, copy, modify, merge, publish,\n// distribute, sublicense, and/or sell copies of the Software, and to permit\n// persons to whom the Software is furnished to do so, subject to the\n// following conditions:\n//\n// The above copyright notice and this permission notice shall be included\n// in all copies or substantial portions of the Software.\n//\n// THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS\n// OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF\n// MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN\n// NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM,\n// DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR\n// OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE\n// USE OR OTHER DEALINGS IN THE SOFTWARE.\n\nvar Buffer = require('buffer').Buffer;\n\nvar isBufferEncoding = Buffer.isEncoding\n  || function(encoding) {\n       switch (encoding && encoding.toLowerCase()) {\n         case 'hex': case 'utf8': case 'utf-8': case 'ascii': case 'binary': case 'base64': case 'ucs2': case 'ucs-2': case 'utf16le': case 'utf-16le': case 'raw': return true;\n         default: return false;\n       }\n     }\n\n\nfunction assertEncoding(encoding) {\n  if (encoding && !isBufferEncoding(encoding)) {\n    throw new Error('Unknown encoding: ' + encoding);\n  }\n}\n\n// StringDecoder provides an interface for efficiently splitting a series of\n// buffers into a series of JS strings without breaking apart multi-byte\n// characters. CESU-8 is handled as part of the UTF-8 encoding.\n//\n// @TODO Handling all encodings inside a single object makes it very difficult\n// to reason about this code, so it should be split up in the future.\n// @TODO There should be a utf8-strict encoding that rejects invalid UTF-8 code\n// points as used by CESU-8.\nvar StringDecoder = exports.StringDecoder = function(encoding) {\n  this.encoding = (encoding || 'utf8').toLowerCase().replace(/[-_]/, '');\n  assertEncoding(encoding);\n  switch (this.encoding) {\n    case 'utf8':\n      // CESU-8 represents each of Surrogate Pair by 3-bytes\n      this.surrogateSize = 3;\n      break;\n    case 'ucs2':\n    case 'utf16le':\n      // UTF-16 represents each of Surrogate Pair by 2-bytes\n      this.surrogateSize = 2;\n      this.detectIncompleteChar = utf16DetectIncompleteChar;\n      break;\n    case 'base64':\n      // Base-64 stores 3 bytes in 4 chars, and pads the remainder.\n      this.surrogateSize = 3;\n      this.detectIncompleteChar = base64DetectIncompleteChar;\n      break;\n    default:\n      this.write = passThroughWrite;\n      return;\n  }\n\n  // Enough space to store all bytes of a single character. UTF-8 needs 4\n  // bytes, but CESU-8 may require up to 6 (3 bytes per surrogate).\n  this.charBuffer = new Buffer(6);\n  // Number of bytes received for the current incomplete multi-byte character.\n  this.charReceived = 0;\n  // Number of bytes expected for the current incomplete multi-byte character.\n  this.charLength = 0;\n};\n\n\n// write decodes the given buffer and returns it as JS string that is\n// guaranteed to not contain any partial multi-byte characters. Any partial\n// character found at the end of the buffer is buffered up, and will be\n// returned when calling write again with the remaining bytes.\n//\n// Note: Converting a Buffer containing an orphan surrogate to a String\n// currently works, but converting a String to a Buffer (via `new Buffer`, or\n// Buffer#write) will replace incomplete surrogates with the unicode\n// replacement character. See https://codereview.chromium.org/121173009/ .\nStringDecoder.prototype.write = function(buffer) {\n  var charStr = '';\n  // if our last write ended with an incomplete multibyte character\n  while (this.charLength) {\n    // determine how many remaining bytes this buffer has to offer for this char\n    var available = (buffer.length >= this.charLength - this.charReceived) ?\n        this.charLength - this.charReceived :\n        buffer.length;\n\n    // add the new bytes to the char buffer\n    buffer.copy(this.charBuffer, this.charReceived, 0, available);\n    this.charReceived += available;\n\n    if (this.charReceived < this.charLength) {\n      // still not enough chars in this buffer? wait for more ...\n      return '';\n    }\n\n    // remove bytes belonging to the current character from the buffer\n    buffer = buffer.slice(available, buffer.length);\n\n    // get the character that was split\n    charStr = this.charBuffer.slice(0, this.charLength).toString(this.encoding);\n\n    // CESU-8: lead surrogate (D800-DBFF) is also the incomplete character\n    var charCode = charStr.charCodeAt(charStr.length - 1);\n    if (charCode >= 0xD800 && charCode <= 0xDBFF) {\n      this.charLength += this.surrogateSize;\n      charStr = '';\n      continue;\n    }\n    this.charReceived = this.charLength = 0;\n\n    // if there are no more bytes in this buffer, just emit our char\n    if (buffer.length === 0) {\n      return charStr;\n    }\n    break;\n  }\n\n  // determine and set charLength / charReceived\n  this.detectIncompleteChar(buffer);\n\n  var end = buffer.length;\n  if (this.charLength) {\n    // buffer the incomplete character bytes we got\n    buffer.copy(this.charBuffer, 0, buffer.length - this.charReceived, end);\n    end -= this.charReceived;\n  }\n\n  charStr += buffer.toString(this.encoding, 0, end);\n\n  var end = charStr.length - 1;\n  var charCode = charStr.charCodeAt(end);\n  // CESU-8: lead surrogate (D800-DBFF) is also the incomplete character\n  if (charCode >= 0xD800 && charCode <= 0xDBFF) {\n    var size = this.surrogateSize;\n    this.charLength += size;\n    this.charReceived += size;\n    this.charBuffer.copy(this.charBuffer, size, 0, size);\n    buffer.copy(this.charBuffer, 0, 0, size);\n    return charStr.substring(0, end);\n  }\n\n  // or just emit the charStr\n  return charStr;\n};\n\n// detectIncompleteChar determines if there is an incomplete UTF-8 character at\n// the end of the given buffer. If so, it sets this.charLength to the byte\n// length that character, and sets this.charReceived to the number of bytes\n// that are available for this character.\nStringDecoder.prototype.detectIncompleteChar = function(buffer) {\n  // determine how many bytes we have to check at the end of this buffer\n  var i = (buffer.length >= 3) ? 3 : buffer.length;\n\n  // Figure out if one of the last i bytes of our buffer announces an\n  // incomplete char.\n  for (; i > 0; i--) {\n    var c = buffer[buffer.length - i];\n\n    // See http://en.wikipedia.org/wiki/UTF-8#Description\n\n    // 110XXXXX\n    if (i == 1 && c >> 5 == 0x06) {\n      this.charLength = 2;\n      break;\n    }\n\n    // 1110XXXX\n    if (i <= 2 && c >> 4 == 0x0E) {\n      this.charLength = 3;\n      break;\n    }\n\n    // 11110XXX\n    if (i <= 3 && c >> 3 == 0x1E) {\n      this.charLength = 4;\n      break;\n    }\n  }\n  this.charReceived = i;\n};\n\nStringDecoder.prototype.end = function(buffer) {\n  var res = '';\n  if (buffer && buffer.length)\n    res = this.write(buffer);\n\n  if (this.charReceived) {\n    var cr = this.charReceived;\n    var buf = this.charBuffer;\n    var enc = this.encoding;\n    res += buf.slice(0, cr).toString(enc);\n  }\n\n  return res;\n};\n\nfunction passThroughWrite(buffer) {\n  return buffer.toString(this.encoding);\n}\n\nfunction utf16DetectIncompleteChar(buffer) {\n  this.charReceived = buffer.length % 2;\n  this.charLength = this.charReceived ? 2 : 0;\n}\n\nfunction base64DetectIncompleteChar(buffer) {\n  this.charReceived = buffer.length % 3;\n  this.charLength = this.charReceived ? 3 : 0;\n}\n","module.exports = Array.isArray || function (arr) {\n  return Object.prototype.toString.call(arr) == '[object Array]';\n};\n","\n/**\n * isArray\n */\n\nvar isArray = Array.isArray;\n\n/**\n * toString\n */\n\nvar str = Object.prototype.toString;\n\n/**\n * Whether or not the given `val`\n * is an array.\n *\n * example:\n *\n *        isArray([]);\n *        // > true\n *        isArray(arguments);\n *        // > false\n *        isArray('');\n *        // > false\n *\n * @param {mixed} val\n * @return {bool}\n */\n\nmodule.exports = isArray || function (val) {\n  return !! val && '[object Array]' == str.call(val);\n};\n","// Copyright Joyent, Inc. and other Node contributors.\n//\n// Permission is hereby granted, free of charge, to any person obtaining a\n// copy of this software and associated documentation files (the\n// \"Software\"), to deal in the Software without restriction, including\n// without limitation the rights to use, copy, modify, merge, publish,\n// distribute, sublicense, and/or sell copies of the Software, and to permit\n// persons to whom the Software is furnished to do so, subject to the\n// following conditions:\n//\n// The above copyright notice and this permission notice shall be included\n// in all copies or substantial portions of the Software.\n//\n// THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS\n// OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF\n// MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN\n// NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM,\n// DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR\n// OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE\n// USE OR OTHER DEALINGS IN THE SOFTWARE.\n\n// NOTE: These type checking functions intentionally don't use `instanceof`\n// because it is fragile and can be easily faked with `Object.create()`.\nfunction isArray(ar) {\n  return Array.isArray(ar);\n}\nexports.isArray = isArray;\n\nfunction isBoolean(arg) {\n  return typeof arg === 'boolean';\n}\nexports.isBoolean = isBoolean;\n\nfunction isNull(arg) {\n  return arg === null;\n}\nexports.isNull = isNull;\n\nfunction isNullOrUndefined(arg) {\n  return arg == null;\n}\nexports.isNullOrUndefined = isNullOrUndefined;\n\nfunction isNumber(arg) {\n  return typeof arg === 'number';\n}\nexports.isNumber = isNumber;\n\nfunction isString(arg) {\n  return typeof arg === 'string';\n}\nexports.isString = isString;\n\nfunction isSymbol(arg) {\n  return typeof arg === 'symbol';\n}\nexports.isSymbol = isSymbol;\n\nfunction isUndefined(arg) {\n  return arg === void 0;\n}\nexports.isUndefined = isUndefined;\n\nfunction isRegExp(re) {\n  return isObject(re) && objectToString(re) === '[object RegExp]';\n}\nexports.isRegExp = isRegExp;\n\nfunction isObject(arg) {\n  return typeof arg === 'object' && arg !== null;\n}\nexports.isObject = isObject;\n\nfunction isDate(d) {\n  return isObject(d) && objectToString(d) === '[object Date]';\n}\nexports.isDate = isDate;\n\nfunction isError(e) {\n  return isObject(e) &&\n      (objectToString(e) === '[object Error]' || e instanceof Error);\n}\nexports.isError = isError;\n\nfunction isFunction(arg) {\n  return typeof arg === 'function';\n}\nexports.isFunction = isFunction;\n\nfunction isPrimitive(arg) {\n  return arg === null ||\n         typeof arg === 'boolean' ||\n         typeof arg === 'number' ||\n         typeof arg === 'string' ||\n         typeof arg === 'symbol' ||  // ES6 symbol\n         typeof arg === 'undefined';\n}\nexports.isPrimitive = isPrimitive;\n\nfunction isBuffer(arg) {\n  return Buffer.isBuffer(arg);\n}\nexports.isBuffer = isBuffer;\n\nfunction objectToString(o) {\n  return Object.prototype.toString.call(o);\n}","exports.read = function(buffer, offset, isLE, mLen, nBytes) {\n  var e, m,\n      eLen = nBytes * 8 - mLen - 1,\n      eMax = (1 << eLen) - 1,\n      eBias = eMax >> 1,\n      nBits = -7,\n      i = isLE ? (nBytes - 1) : 0,\n      d = isLE ? -1 : 1,\n      s = buffer[offset + i];\n\n  i += d;\n\n  e = s & ((1 << (-nBits)) - 1);\n  s >>= (-nBits);\n  nBits += eLen;\n  for (; nBits > 0; e = e * 256 + buffer[offset + i], i += d, nBits -= 8);\n\n  m = e & ((1 << (-nBits)) - 1);\n  e >>= (-nBits);\n  nBits += mLen;\n  for (; nBits > 0; m = m * 256 + buffer[offset + i], i += d, nBits -= 8);\n\n  if (e === 0) {\n    e = 1 - eBias;\n  } else if (e === eMax) {\n    return m ? NaN : ((s ? -1 : 1) * Infinity);\n  } else {\n    m = m + Math.pow(2, mLen);\n    e = e - eBias;\n  }\n  return (s ? -1 : 1) * m * Math.pow(2, e - mLen);\n};\n\nexports.write = function(buffer, value, offset, isLE, mLen, nBytes) {\n  var e, m, c,\n      eLen = nBytes * 8 - mLen - 1,\n      eMax = (1 << eLen) - 1,\n      eBias = eMax >> 1,\n      rt = (mLen === 23 ? Math.pow(2, -24) - Math.pow(2, -77) : 0),\n      i = isLE ? 0 : (nBytes - 1),\n      d = isLE ? 1 : -1,\n      s = value < 0 || (value === 0 && 1 / value < 0) ? 1 : 0;\n\n  value = Math.abs(value);\n\n  if (isNaN(value) || value === Infinity) {\n    m = isNaN(value) ? 1 : 0;\n    e = eMax;\n  } else {\n    e = Math.floor(Math.log(value) / Math.LN2);\n    if (value * (c = Math.pow(2, -e)) < 1) {\n      e--;\n      c *= 2;\n    }\n    if (e + eBias >= 1) {\n      value += rt / c;\n    } else {\n      value += rt * Math.pow(2, 1 - eBias);\n    }\n    if (value * c >= 2) {\n      e++;\n      c /= 2;\n    }\n\n    if (e + eBias >= eMax) {\n      m = 0;\n      e = eMax;\n    } else if (e + eBias >= 1) {\n      m = (value * c - 1) * Math.pow(2, mLen);\n      e = e + eBias;\n    } else {\n      m = value * Math.pow(2, eBias - 1) * Math.pow(2, mLen);\n      e = 0;\n    }\n  }\n\n  for (; mLen >= 8; buffer[offset + i] = m & 0xff, i += d, m /= 256, mLen -= 8);\n\n  e = (e << mLen) | m;\n  eLen += mLen;\n  for (; eLen > 0; buffer[offset + i] = e & 0xff, i += d, e /= 256, eLen -= 8);\n\n  buffer[offset + i - d] |= s * 128;\n};\n","var lookup = 'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/';\n\n;(function (exports) {\n\t'use strict';\n\n  var Arr = (typeof Uint8Array !== 'undefined')\n    ? Uint8Array\n    : Array\n\n\tvar PLUS   = '+'.charCodeAt(0)\n\tvar SLASH  = '/'.charCodeAt(0)\n\tvar NUMBER = '0'.charCodeAt(0)\n\tvar LOWER  = 'a'.charCodeAt(0)\n\tvar UPPER  = 'A'.charCodeAt(0)\n\n\tfunction decode (elt) {\n\t\tvar code = elt.charCodeAt(0)\n\t\tif (code === PLUS)\n\t\t\treturn 62 // '+'\n\t\tif (code === SLASH)\n\t\t\treturn 63 // '/'\n\t\tif (code < NUMBER)\n\t\t\treturn -1 //no match\n\t\tif (code < NUMBER + 10)\n\t\t\treturn code - NUMBER + 26 + 26\n\t\tif (code < UPPER + 26)\n\t\t\treturn code - UPPER\n\t\tif (code < LOWER + 26)\n\t\t\treturn code - LOWER + 26\n\t}\n\n\tfunction b64ToByteArray (b64) {\n\t\tvar i, j, l, tmp, placeHolders, arr\n\n\t\tif (b64.length % 4 > 0) {\n\t\t\tthrow new Error('Invalid string. Length must be a multiple of 4')\n\t\t}\n\n\t\t// the number of equal signs (place holders)\n\t\t// if there are two placeholders, than the two characters before it\n\t\t// represent one byte\n\t\t// if there is only one, then the three characters before it represent 2 bytes\n\t\t// this is just a cheap hack to not do indexOf twice\n\t\tvar len = b64.length\n\t\tplaceHolders = '=' === b64.charAt(len - 2) ? 2 : '=' === b64.charAt(len - 1) ? 1 : 0\n\n\t\t// base64 is 4/3 + up to two characters of the original data\n\t\tarr = new Arr(b64.length * 3 / 4 - placeHolders)\n\n\t\t// if there are placeholders, only get up to the last complete 4 chars\n\t\tl = placeHolders > 0 ? b64.length - 4 : b64.length\n\n\t\tvar L = 0\n\n\t\tfunction push (v) {\n\t\t\tarr[L++] = v\n\t\t}\n\n\t\tfor (i = 0, j = 0; i < l; i += 4, j += 3) {\n\t\t\ttmp = (decode(b64.charAt(i)) << 18) | (decode(b64.charAt(i + 1)) << 12) | (decode(b64.charAt(i + 2)) << 6) | decode(b64.charAt(i + 3))\n\t\t\tpush((tmp & 0xFF0000) >> 16)\n\t\t\tpush((tmp & 0xFF00) >> 8)\n\t\t\tpush(tmp & 0xFF)\n\t\t}\n\n\t\tif (placeHolders === 2) {\n\t\t\ttmp = (decode(b64.charAt(i)) << 2) | (decode(b64.charAt(i + 1)) >> 4)\n\t\t\tpush(tmp & 0xFF)\n\t\t} else if (placeHolders === 1) {\n\t\t\ttmp = (decode(b64.charAt(i)) << 10) | (decode(b64.charAt(i + 1)) << 4) | (decode(b64.charAt(i + 2)) >> 2)\n\t\t\tpush((tmp >> 8) & 0xFF)\n\t\t\tpush(tmp & 0xFF)\n\t\t}\n\n\t\treturn arr\n\t}\n\n\tfunction uint8ToBase64 (uint8) {\n\t\tvar i,\n\t\t\textraBytes = uint8.length % 3, // if we have 1 byte left, pad 2 bytes\n\t\t\toutput = \"\",\n\t\t\ttemp, length\n\n\t\tfunction encode (num) {\n\t\t\treturn lookup.charAt(num)\n\t\t}\n\n\t\tfunction tripletToBase64 (num) {\n\t\t\treturn encode(num >> 18 & 0x3F) + encode(num >> 12 & 0x3F) + encode(num >> 6 & 0x3F) + encode(num & 0x3F)\n\t\t}\n\n\t\t// go through the array every three bytes, we'll deal with trailing stuff later\n\t\tfor (i = 0, length = uint8.length - extraBytes; i < length; i += 3) {\n\t\t\ttemp = (uint8[i] << 16) + (uint8[i + 1] << 8) + (uint8[i + 2])\n\t\t\toutput += tripletToBase64(temp)\n\t\t}\n\n\t\t// pad the end with zeros, but make sure to not forget the extra bytes\n\t\tswitch (extraBytes) {\n\t\t\tcase 1:\n\t\t\t\ttemp = uint8[uint8.length - 1]\n\t\t\t\toutput += encode(temp >> 2)\n\t\t\t\toutput += encode((temp << 4) & 0x3F)\n\t\t\t\toutput += '=='\n\t\t\t\tbreak\n\t\t\tcase 2:\n\t\t\t\ttemp = (uint8[uint8.length - 2] << 8) + (uint8[uint8.length - 1])\n\t\t\t\toutput += encode(temp >> 10)\n\t\t\t\toutput += encode((temp >> 4) & 0x3F)\n\t\t\t\toutput += encode((temp << 2) & 0x3F)\n\t\t\t\toutput += '='\n\t\t\t\tbreak\n\t\t}\n\n\t\treturn output\n\t}\n\n\texports.toByteArray = b64ToByteArray\n\texports.fromByteArray = uint8ToBase64\n}(typeof exports === 'undefined' ? (this.base64js = {}) : exports))\n"]}